[0m16:25:58.085133 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1023cdb80>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1043e1280>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1043e1970>]}


============================== 16:25:58.087082 | 720a4444-688a-4ecf-a4cd-c1db1d185809 ==============================
[0m16:25:58.087082 [info ] [MainThread]: Running with dbt=1.8.1
[0m16:25:58.087463 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/Users/shrikanth/.dbt', 'fail_fast': 'False', 'warn_error': 'None', 'log_path': '/Users/shrikanth/Shrikanth/dbt-helloworld/pgmigrate/logs', 'debug': 'False', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'invocation_command': 'dbt ls', 'static_parser': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m16:25:58.089081 [error] [MainThread]: Encountered an error:
Runtime Error
  Could not find profile named 'pgmigrate'
[0m16:25:58.089867 [debug] [MainThread]: Resource report: {"command_name": "list", "command_wall_clock_time": 0.03750879, "process_user_time": 0.546413, "process_kernel_time": 0.051485, "process_mem_max_rss": "85114880", "command_success": false, "process_in_blocks": "0", "process_out_blocks": "0"}
[0m16:25:58.090272 [debug] [MainThread]: Command `dbt ls` failed at 16:25:58.090212 after 0.04 seconds
[0m16:25:58.090517 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1023cdb80>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10441f1f0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10441f250>]}
[0m16:25:58.090750 [debug] [MainThread]: Flushing usage events
[0m16:26:45.024386 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10667dbb0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108693eb0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108693730>]}


============================== 16:26:45.026952 | bc591e0d-afc5-4f31-9061-b5d92784cddb ==============================
[0m16:26:45.026952 [info ] [MainThread]: Running with dbt=1.8.1
[0m16:26:45.027343 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'version_check': 'True', 'log_path': '/Users/shrikanth/Shrikanth/dbt-helloworld/pgmigrate/logs', 'profiles_dir': '/Users/shrikanth/.dbt', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'invocation_command': 'dbt run', 'introspect': 'True', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m16:26:45.029030 [error] [MainThread]: Encountered an error:
Runtime Error
  Could not find profile named 'pgmigrate'
[0m16:26:45.030442 [debug] [MainThread]: Resource report: {"command_name": "run", "command_wall_clock_time": 0.041365918, "process_user_time": 0.557151, "process_kernel_time": 0.077928, "process_mem_max_rss": "85245952", "command_success": false, "process_in_blocks": "0", "process_out_blocks": "0"}
[0m16:26:45.030842 [debug] [MainThread]: Command `dbt run` failed at 16:26:45.030786 after 0.04 seconds
[0m16:26:45.031099 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10667dbb0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10806ab20>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1083652b0>]}
[0m16:26:45.031340 [debug] [MainThread]: Flushing usage events
[0m11:50:10.361611 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1029e3760>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106ee3550>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106ee3e80>]}


============================== 11:50:10.365258 | a7811440-e2e3-452f-9c64-2cfd8478aa9f ==============================
[0m11:50:10.365258 [info ] [MainThread]: Running with dbt=1.8.1
[0m11:50:10.365703 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/Users/shrikanth/.dbt', 'fail_fast': 'False', 'version_check': 'True', 'log_path': '/Users/shrikanth/Shrikanth/dbt-helloworld/logs', 'debug': 'False', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'invocation_command': 'dbt deps', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m11:50:10.492037 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'a7811440-e2e3-452f-9c64-2cfd8478aa9f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106ea4220>]}
[0m11:50:10.503217 [debug] [MainThread]: Set downloads directory='/var/folders/ll/3nys2tln7dv4vrs7t9wxvd5w0000gn/T/dbt-downloads-5xhkt4io'
[0m11:50:10.503632 [debug] [MainThread]: Executing "git clone --depth 1 https://github.com/dbt-labs/dbt-utils.git b03949bb53de3439f6a8057088ba4032"
[0m11:50:12.118312 [debug] [MainThread]: STDOUT: "b''"
[0m11:50:12.118926 [debug] [MainThread]: STDERR: "b"Cloning into 'b03949bb53de3439f6a8057088ba4032'...\n""
[0m11:50:12.119289 [debug] [MainThread]: Pulling new dependency b03949bb53de3439f6a8057088ba4032.
[0m11:50:12.119508 [debug] [MainThread]: Executing "git rev-parse HEAD"
[0m11:50:12.125157 [debug] [MainThread]: STDOUT: "b'fc98e4e30cd299ddd67c43902f2a5efa9511edfb\n'"
[0m11:50:12.125674 [debug] [MainThread]: STDERR: "b''"
[0m11:50:12.125911 [debug] [MainThread]: Checking out revision 1.1.1.
[0m11:50:12.126115 [debug] [MainThread]: Executing "git remote set-branches origin 1.1.1"
[0m11:50:12.133184 [debug] [MainThread]: STDOUT: "b''"
[0m11:50:12.133683 [debug] [MainThread]: STDERR: "b''"
[0m11:50:12.133952 [debug] [MainThread]: Executing "git fetch origin --depth 1 --tags 1.1.1"
[0m11:50:14.142571 [debug] [MainThread]: STDOUT: "b''"
[0m11:50:14.143240 [debug] [MainThread]: STDERR: "b'From https://github.com/dbt-labs/dbt-utils\n * tag               1.1.1      -> FETCH_HEAD\n * [new tag]         0.0.1      -> 0.0.1\n * [new tag]         0.1.0      -> 0.1.0\n * [new tag]         0.1.1      -> 0.1.1\n * [new tag]         0.1.10     -> 0.1.10\n * [new tag]         0.1.11     -> 0.1.11\n * [new tag]         0.1.12     -> 0.1.12\n * [new tag]         0.1.13     -> 0.1.13\n * [new tag]         0.1.14     -> 0.1.14\n * [new tag]         0.1.15     -> 0.1.15\n * [new tag]         0.1.16     -> 0.1.16\n * [new tag]         0.1.17     -> 0.1.17\n * [new tag]         0.1.18     -> 0.1.18\n * [new tag]         0.1.19     -> 0.1.19\n * [new tag]         0.1.2      -> 0.1.2\n * [new tag]         0.1.20     -> 0.1.20\n * [new tag]         0.1.21     -> 0.1.21\n * [new tag]         0.1.22     -> 0.1.22\n * [new tag]         0.1.23     -> 0.1.23\n * [new tag]         0.1.24     -> 0.1.24\n * [new tag]         0.1.25     -> 0.1.25\n * [new tag]         0.1.3      -> 0.1.3\n * [new tag]         0.1.4      -> 0.1.4\n * [new tag]         0.1.5      -> 0.1.5\n * [new tag]         0.1.6      -> 0.1.6\n * [new tag]         0.1.7      -> 0.1.7\n * [new tag]         0.1.8      -> 0.1.8\n * [new tag]         0.1.9      -> 0.1.9\n * [new tag]         0.2.0      -> 0.2.0\n * [new tag]         0.2.1      -> 0.2.1\n * [new tag]         0.2.2      -> 0.2.2\n * [new tag]         0.2.3      -> 0.2.3\n * [new tag]         0.2.4      -> 0.2.4\n * [new tag]         0.2.5      -> 0.2.5\n * [new tag]         0.3.0      -> 0.3.0\n * [new tag]         0.4.0      -> 0.4.0\n * [new tag]         0.4.1      -> 0.4.1\n * [new tag]         0.5.0      -> 0.5.0\n * [new tag]         0.5.1      -> 0.5.1\n * [new tag]         0.6.0      -> 0.6.0\n * [new tag]         0.6.1      -> 0.6.1\n * [new tag]         0.6.2      -> 0.6.2\n * [new tag]         0.6.3      -> 0.6.3\n * [new tag]         0.6.4      -> 0.6.4\n * [new tag]         0.6.5      -> 0.6.5\n * [new tag]         0.6.6      -> 0.6.6\n * [new tag]         0.7.0      -> 0.7.0\n * [new tag]         0.7.1      -> 0.7.1\n * [new tag]         0.7.2      -> 0.7.2\n * [new tag]         0.7.3      -> 0.7.3\n * [new tag]         0.7.4      -> 0.7.4\n * [new tag]         0.7.4-b1   -> 0.7.4-b1\n * [new tag]         0.7.4b1    -> 0.7.4b1\n * [new tag]         0.7.5      -> 0.7.5\n * [new tag]         0.7.6      -> 0.7.6\n * [new tag]         0.8.0      -> 0.8.0\n * [new tag]         0.8.1      -> 0.8.1\n * [new tag]         0.8.2      -> 0.8.2\n * [new tag]         0.8.3      -> 0.8.3\n * [new tag]         0.8.4      -> 0.8.4\n * [new tag]         0.8.5      -> 0.8.5\n * [new tag]         0.8.6      -> 0.8.6\n * [new tag]         0.9.0      -> 0.9.0\n * [new tag]         0.9.1      -> 0.9.1\n * [new tag]         0.9.2      -> 0.9.2\n * [new tag]         0.9.5      -> 0.9.5\n * [new tag]         0.9.6      -> 0.9.6\n * [new tag]         1.0.0      -> 1.0.0\n * [new tag]         1.0.0-b1   -> 1.0.0-b1\n * [new tag]         1.0.0-b2   -> 1.0.0-b2\n * [new tag]         1.0.0-rc1  -> 1.0.0-rc1\n * [new tag]         1.1.0      -> 1.1.0\n * [new tag]         1.1.1      -> 1.1.1\n * [new tag]         1.2.0-rc1  -> 1.2.0-rc1\n'"
[0m11:50:14.143592 [debug] [MainThread]: Executing "git tag --list"
[0m11:50:14.149657 [debug] [MainThread]: STDOUT: "b'0.0.1\n0.1.0\n0.1.1\n0.1.10\n0.1.11\n0.1.12\n0.1.13\n0.1.14\n0.1.15\n0.1.16\n0.1.17\n0.1.18\n0.1.19\n0.1.2\n0.1.20\n0.1.21\n0.1.22\n0.1.23\n0.1.24\n0.1.25\n0.1.3\n0.1.4\n0.1.5\n0.1.6\n0.1.7\n0.1.8\n0.1.9\n0.2.0\n0.2.1\n0.2.2\n0.2.3\n0.2.4\n0.2.5\n0.3.0\n0.4.0\n0.4.1\n0.5.0\n0.5.1\n0.6.0\n0.6.1\n0.6.2\n0.6.3\n0.6.4\n0.6.5\n0.6.6\n0.7.0\n0.7.1\n0.7.2\n0.7.3\n0.7.4\n0.7.4-b1\n0.7.4b1\n0.7.5\n0.7.6\n0.8.0\n0.8.1\n0.8.2\n0.8.3\n0.8.4\n0.8.5\n0.8.6\n0.9.0\n0.9.1\n0.9.2\n0.9.5\n0.9.6\n1.0.0\n1.0.0-b1\n1.0.0-b2\n1.0.0-rc1\n1.1.0\n1.1.1\n1.2.0-rc1\n'"
[0m11:50:14.150097 [debug] [MainThread]: STDERR: "b''"
[0m11:50:14.150305 [debug] [MainThread]: Executing "git reset --hard tags/1.1.1"
[0m11:50:14.167096 [debug] [MainThread]: STDOUT: "b'HEAD is now at 74a661c Update CHANGELOG for v1.1.1 (#803)\n'"
[0m11:50:14.167560 [debug] [MainThread]: STDERR: "b''"
[0m11:50:14.167779 [debug] [MainThread]: Executing "git rev-parse HEAD"
[0m11:50:14.172086 [debug] [MainThread]: STDOUT: "b'74a661ca00452da7d2b2811ff1e5a37f152c3ee2\n'"
[0m11:50:14.172490 [debug] [MainThread]: STDERR: "b''"
[0m11:50:14.172709 [debug] [MainThread]: Checked out at 74a661c.
[0m11:50:14.172913 [debug] [MainThread]: Executing "git rev-parse HEAD"
[0m11:50:14.176898 [debug] [MainThread]: STDOUT: "b'74a661ca00452da7d2b2811ff1e5a37f152c3ee2\n'"
[0m11:50:14.177310 [debug] [MainThread]: STDERR: "b''"
[0m11:50:14.178104 [debug] [MainThread]: Executing "git clone --depth 1 https://github.com/dbt-labs/dbt-utils.git b03949bb53de3439f6a8057088ba4032"
[0m11:50:14.182251 [debug] [MainThread]: STDOUT: "b''"
[0m11:50:14.182650 [debug] [MainThread]: STDERR: "b"fatal: destination path 'b03949bb53de3439f6a8057088ba4032' already exists and is not an empty directory.\n""
[0m11:50:14.182837 [debug] [MainThread]: command return code=128
[0m11:50:14.183560 [debug] [MainThread]: Updating existing dependency b03949bb53de3439f6a8057088ba4032.
[0m11:50:14.183749 [debug] [MainThread]: Executing "git rev-parse HEAD"
[0m11:50:14.187814 [debug] [MainThread]: STDOUT: "b'74a661ca00452da7d2b2811ff1e5a37f152c3ee2\n'"
[0m11:50:14.188205 [debug] [MainThread]: STDERR: "b''"
[0m11:50:14.188401 [debug] [MainThread]: Checking out revision 1.1.1.
[0m11:50:14.188593 [debug] [MainThread]: Executing "git remote set-branches origin 1.1.1"
[0m11:50:14.193101 [debug] [MainThread]: STDOUT: "b''"
[0m11:50:14.193488 [debug] [MainThread]: STDERR: "b''"
[0m11:50:14.193672 [debug] [MainThread]: Executing "git fetch origin --depth 1 --tags 1.1.1"
[0m11:50:15.170563 [debug] [MainThread]: STDOUT: "b''"
[0m11:50:15.171098 [debug] [MainThread]: STDERR: "b'From https://github.com/dbt-labs/dbt-utils\n * tag               1.1.1      -> FETCH_HEAD\n'"
[0m11:50:15.171332 [debug] [MainThread]: Executing "git tag --list"
[0m11:50:15.176955 [debug] [MainThread]: STDOUT: "b'0.0.1\n0.1.0\n0.1.1\n0.1.10\n0.1.11\n0.1.12\n0.1.13\n0.1.14\n0.1.15\n0.1.16\n0.1.17\n0.1.18\n0.1.19\n0.1.2\n0.1.20\n0.1.21\n0.1.22\n0.1.23\n0.1.24\n0.1.25\n0.1.3\n0.1.4\n0.1.5\n0.1.6\n0.1.7\n0.1.8\n0.1.9\n0.2.0\n0.2.1\n0.2.2\n0.2.3\n0.2.4\n0.2.5\n0.3.0\n0.4.0\n0.4.1\n0.5.0\n0.5.1\n0.6.0\n0.6.1\n0.6.2\n0.6.3\n0.6.4\n0.6.5\n0.6.6\n0.7.0\n0.7.1\n0.7.2\n0.7.3\n0.7.4\n0.7.4-b1\n0.7.4b1\n0.7.5\n0.7.6\n0.8.0\n0.8.1\n0.8.2\n0.8.3\n0.8.4\n0.8.5\n0.8.6\n0.9.0\n0.9.1\n0.9.2\n0.9.5\n0.9.6\n1.0.0\n1.0.0-b1\n1.0.0-b2\n1.0.0-rc1\n1.1.0\n1.1.1\n1.2.0-rc1\n'"
[0m11:50:15.177407 [debug] [MainThread]: STDERR: "b''"
[0m11:50:15.177633 [debug] [MainThread]: Executing "git reset --hard tags/1.1.1"
[0m11:50:15.185661 [debug] [MainThread]: STDOUT: "b'HEAD is now at 74a661c Update CHANGELOG for v1.1.1 (#803)\n'"
[0m11:50:15.186061 [debug] [MainThread]: STDERR: "b''"
[0m11:50:15.186257 [debug] [MainThread]: Executing "git rev-parse HEAD"
[0m11:50:15.190298 [debug] [MainThread]: STDOUT: "b'74a661ca00452da7d2b2811ff1e5a37f152c3ee2\n'"
[0m11:50:15.190693 [debug] [MainThread]: STDERR: "b''"
[0m11:50:15.190913 [debug] [MainThread]: Already at 74a661c, nothing to do.
[0m11:50:15.191111 [debug] [MainThread]: Executing "git rev-parse HEAD"
[0m11:50:15.195033 [debug] [MainThread]: STDOUT: "b'74a661ca00452da7d2b2811ff1e5a37f152c3ee2\n'"
[0m11:50:15.195388 [debug] [MainThread]: STDERR: "b''"
[0m11:50:15.215018 [info ] [MainThread]: Updating lock file in file path: /Users/shrikanth/Shrikanth/dbt-helloworld/package-lock.yml
[0m11:50:15.216566 [debug] [MainThread]: Set downloads directory='/var/folders/ll/3nys2tln7dv4vrs7t9wxvd5w0000gn/T/dbt-downloads-s61z7p58'
[0m11:50:15.216853 [info ] [MainThread]: Installing https://github.com/dbt-labs/dbt-utils.git
[0m11:50:15.217074 [debug] [MainThread]: Executing "git clone --depth 1 https://github.com/dbt-labs/dbt-utils.git b03949bb53de3439f6a8057088ba4032"
[0m11:50:16.381733 [debug] [MainThread]: STDOUT: "b''"
[0m11:50:16.382324 [debug] [MainThread]: STDERR: "b"Cloning into 'b03949bb53de3439f6a8057088ba4032'...\n""
[0m11:50:16.382609 [debug] [MainThread]: Pulling new dependency b03949bb53de3439f6a8057088ba4032.
[0m11:50:16.382847 [debug] [MainThread]: Executing "git rev-parse HEAD"
[0m11:50:16.387876 [debug] [MainThread]: STDOUT: "b'fc98e4e30cd299ddd67c43902f2a5efa9511edfb\n'"
[0m11:50:16.388314 [debug] [MainThread]: STDERR: "b''"
[0m11:50:16.388534 [debug] [MainThread]: Checking out revision 74a661ca00452da7d2b2811ff1e5a37f152c3ee2.
[0m11:50:16.388735 [debug] [MainThread]: Executing "git fetch origin --depth 1 74a661ca00452da7d2b2811ff1e5a37f152c3ee2"
[0m11:50:17.746604 [debug] [MainThread]: STDOUT: "b''"
[0m11:50:17.747182 [debug] [MainThread]: STDERR: "b'From https://github.com/dbt-labs/dbt-utils\n * branch            74a661ca00452da7d2b2811ff1e5a37f152c3ee2 -> FETCH_HEAD\n'"
[0m11:50:17.747443 [debug] [MainThread]: Executing "git reset --hard 74a661ca00452da7d2b2811ff1e5a37f152c3ee2"
[0m11:50:17.765404 [debug] [MainThread]: STDOUT: "b'HEAD is now at 74a661c Update CHANGELOG for v1.1.1 (#803)\n'"
[0m11:50:17.765888 [debug] [MainThread]: STDERR: "b''"
[0m11:50:17.766113 [debug] [MainThread]: Executing "git rev-parse HEAD"
[0m11:50:17.770679 [debug] [MainThread]: STDOUT: "b'74a661ca00452da7d2b2811ff1e5a37f152c3ee2\n'"
[0m11:50:17.771112 [debug] [MainThread]: STDERR: "b''"
[0m11:50:17.771320 [debug] [MainThread]: Checked out at 74a661c.
[0m11:50:17.771528 [debug] [MainThread]: Executing "git rev-parse HEAD"
[0m11:50:17.775815 [debug] [MainThread]: STDOUT: "b'74a661ca00452da7d2b2811ff1e5a37f152c3ee2\n'"
[0m11:50:17.776234 [debug] [MainThread]: STDERR: "b''"
[0m11:50:17.777042 [debug] [MainThread]: Executing "git clone --depth 1 https://github.com/dbt-labs/dbt-utils.git b03949bb53de3439f6a8057088ba4032"
[0m11:50:17.781307 [debug] [MainThread]: STDOUT: "b''"
[0m11:50:17.781694 [debug] [MainThread]: STDERR: "b"fatal: destination path 'b03949bb53de3439f6a8057088ba4032' already exists and is not an empty directory.\n""
[0m11:50:17.781876 [debug] [MainThread]: command return code=128
[0m11:50:17.782483 [debug] [MainThread]: Updating existing dependency b03949bb53de3439f6a8057088ba4032.
[0m11:50:17.782677 [debug] [MainThread]: Executing "git rev-parse HEAD"
[0m11:50:17.786635 [debug] [MainThread]: STDOUT: "b'74a661ca00452da7d2b2811ff1e5a37f152c3ee2\n'"
[0m11:50:17.787026 [debug] [MainThread]: STDERR: "b''"
[0m11:50:17.787229 [debug] [MainThread]: Checking out revision 74a661ca00452da7d2b2811ff1e5a37f152c3ee2.
[0m11:50:17.787425 [debug] [MainThread]: Executing "git fetch origin --depth 1 74a661ca00452da7d2b2811ff1e5a37f152c3ee2"
[0m11:50:18.960558 [debug] [MainThread]: STDOUT: "b''"
[0m11:50:18.961205 [debug] [MainThread]: STDERR: "b'From https://github.com/dbt-labs/dbt-utils\n * branch            74a661ca00452da7d2b2811ff1e5a37f152c3ee2 -> FETCH_HEAD\n'"
[0m11:50:18.961487 [debug] [MainThread]: Executing "git reset --hard 74a661ca00452da7d2b2811ff1e5a37f152c3ee2"
[0m11:50:18.972752 [debug] [MainThread]: STDOUT: "b'HEAD is now at 74a661c Update CHANGELOG for v1.1.1 (#803)\n'"
[0m11:50:18.973464 [debug] [MainThread]: STDERR: "b''"
[0m11:50:18.973733 [debug] [MainThread]: Executing "git rev-parse HEAD"
[0m11:50:18.979463 [debug] [MainThread]: STDOUT: "b'74a661ca00452da7d2b2811ff1e5a37f152c3ee2\n'"
[0m11:50:18.980004 [debug] [MainThread]: STDERR: "b''"
[0m11:50:18.980254 [debug] [MainThread]: Already at 74a661c, nothing to do.
[0m11:50:18.980632 [info ] [MainThread]: Installed from revision 74a661ca00452da7d2b2811ff1e5a37f152c3ee2
[0m11:50:18.981007 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'package', 'label': 'a7811440-e2e3-452f-9c64-2cfd8478aa9f', 'property_': 'install', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107169b50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107169be0>]}
[0m11:50:18.988607 [debug] [MainThread]: Resource report: {"command_name": "deps", "command_success": true, "command_wall_clock_time": 8.671388, "process_user_time": 0.752383, "process_kernel_time": 0.182012, "process_mem_max_rss": "91553792", "process_in_blocks": "0", "process_out_blocks": "0"}
[0m11:50:18.989121 [debug] [MainThread]: Command `dbt deps` succeeded at 11:50:18.989046 after 8.67 seconds
[0m11:50:18.989433 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1029e3760>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104563c70>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107169b50>]}
[0m11:50:18.989681 [debug] [MainThread]: Flushing usage events
[0m15:05:31.963445 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1024837c0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10448f4f0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10448ff40>]}


============================== 15:05:31.966671 | d807418c-d517-40f7-91bb-08e9be7ba074 ==============================
[0m15:05:31.966671 [info ] [MainThread]: Running with dbt=1.8.1
[0m15:05:31.967076 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/Users/shrikanth/.dbt', 'version_check': 'True', 'warn_error': 'None', 'log_path': '/Users/shrikanth/Shrikanth/dbt-helloworld/logs', 'debug': 'False', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'introspect': 'True', 'invocation_command': 'dbt deps', 'static_parser': 'True', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m15:05:32.095828 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'd807418c-d517-40f7-91bb-08e9be7ba074', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1044509d0>]}
[0m15:05:32.108884 [debug] [MainThread]: Set downloads directory='/var/folders/ll/3nys2tln7dv4vrs7t9wxvd5w0000gn/T/dbt-downloads-izj22hzr'
[0m15:05:32.109240 [info ] [MainThread]: Installing https://github.com/dbt-labs/dbt-utils.git
[0m15:05:32.109544 [debug] [MainThread]: Executing "git clone --depth 1 https://github.com/dbt-labs/dbt-utils.git b03949bb53de3439f6a8057088ba4032"
[0m15:05:33.127770 [debug] [MainThread]: STDOUT: "b''"
[0m15:05:33.128483 [debug] [MainThread]: STDERR: "b"Cloning into 'b03949bb53de3439f6a8057088ba4032'...\n""
[0m15:05:33.128945 [debug] [MainThread]: Pulling new dependency b03949bb53de3439f6a8057088ba4032.
[0m15:05:33.129166 [debug] [MainThread]: Executing "git rev-parse HEAD"
[0m15:05:33.134860 [debug] [MainThread]: STDOUT: "b'fc98e4e30cd299ddd67c43902f2a5efa9511edfb\n'"
[0m15:05:33.135378 [debug] [MainThread]: STDERR: "b''"
[0m15:05:33.135684 [debug] [MainThread]: Checking out revision 74a661ca00452da7d2b2811ff1e5a37f152c3ee2.
[0m15:05:33.135908 [debug] [MainThread]: Executing "git fetch origin --depth 1 74a661ca00452da7d2b2811ff1e5a37f152c3ee2"
[0m15:05:34.373415 [debug] [MainThread]: STDOUT: "b''"
[0m15:05:34.374067 [debug] [MainThread]: STDERR: "b'From https://github.com/dbt-labs/dbt-utils\n * branch            74a661ca00452da7d2b2811ff1e5a37f152c3ee2 -> FETCH_HEAD\n'"
[0m15:05:34.374421 [debug] [MainThread]: Executing "git reset --hard 74a661ca00452da7d2b2811ff1e5a37f152c3ee2"
[0m15:05:34.394423 [debug] [MainThread]: STDOUT: "b'HEAD is now at 74a661c Update CHANGELOG for v1.1.1 (#803)\n'"
[0m15:05:34.395027 [debug] [MainThread]: STDERR: "b''"
[0m15:05:34.395257 [debug] [MainThread]: Executing "git rev-parse HEAD"
[0m15:05:34.399989 [debug] [MainThread]: STDOUT: "b'74a661ca00452da7d2b2811ff1e5a37f152c3ee2\n'"
[0m15:05:34.400447 [debug] [MainThread]: STDERR: "b''"
[0m15:05:34.400687 [debug] [MainThread]: Checked out at 74a661c.
[0m15:05:34.400903 [debug] [MainThread]: Executing "git rev-parse HEAD"
[0m15:05:34.405357 [debug] [MainThread]: STDOUT: "b'74a661ca00452da7d2b2811ff1e5a37f152c3ee2\n'"
[0m15:05:34.406184 [debug] [MainThread]: STDERR: "b''"
[0m15:05:34.407118 [debug] [MainThread]: Executing "git clone --depth 1 https://github.com/dbt-labs/dbt-utils.git b03949bb53de3439f6a8057088ba4032"
[0m15:05:34.412119 [debug] [MainThread]: STDOUT: "b''"
[0m15:05:34.412550 [debug] [MainThread]: STDERR: "b"fatal: destination path 'b03949bb53de3439f6a8057088ba4032' already exists and is not an empty directory.\n""
[0m15:05:34.412748 [debug] [MainThread]: command return code=128
[0m15:05:34.413516 [debug] [MainThread]: Updating existing dependency b03949bb53de3439f6a8057088ba4032.
[0m15:05:34.413717 [debug] [MainThread]: Executing "git rev-parse HEAD"
[0m15:05:34.417957 [debug] [MainThread]: STDOUT: "b'74a661ca00452da7d2b2811ff1e5a37f152c3ee2\n'"
[0m15:05:34.418387 [debug] [MainThread]: STDERR: "b''"
[0m15:05:34.418598 [debug] [MainThread]: Checking out revision 74a661ca00452da7d2b2811ff1e5a37f152c3ee2.
[0m15:05:34.418795 [debug] [MainThread]: Executing "git fetch origin --depth 1 74a661ca00452da7d2b2811ff1e5a37f152c3ee2"
[0m15:05:35.440572 [debug] [MainThread]: STDOUT: "b''"
[0m15:05:35.441182 [debug] [MainThread]: STDERR: "b'From https://github.com/dbt-labs/dbt-utils\n * branch            74a661ca00452da7d2b2811ff1e5a37f152c3ee2 -> FETCH_HEAD\n'"
[0m15:05:35.441442 [debug] [MainThread]: Executing "git reset --hard 74a661ca00452da7d2b2811ff1e5a37f152c3ee2"
[0m15:05:35.453189 [debug] [MainThread]: STDOUT: "b'HEAD is now at 74a661c Update CHANGELOG for v1.1.1 (#803)\n'"
[0m15:05:35.453924 [debug] [MainThread]: STDERR: "b''"
[0m15:05:35.454191 [debug] [MainThread]: Executing "git rev-parse HEAD"
[0m15:05:35.462922 [debug] [MainThread]: STDOUT: "b'74a661ca00452da7d2b2811ff1e5a37f152c3ee2\n'"
[0m15:05:35.463524 [debug] [MainThread]: STDERR: "b''"
[0m15:05:35.463811 [debug] [MainThread]: Already at 74a661c, nothing to do.
[0m15:05:35.464441 [info ] [MainThread]: Installed from revision 74a661ca00452da7d2b2811ff1e5a37f152c3ee2
[0m15:05:35.465628 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'package', 'label': 'd807418c-d517-40f7-91bb-08e9be7ba074', 'property_': 'install', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1045da7f0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104707f40>]}
[0m15:05:35.468650 [debug] [MainThread]: Resource report: {"command_name": "deps", "command_success": true, "command_wall_clock_time": 3.5467806, "process_user_time": 0.699875, "process_kernel_time": 0.119638, "process_mem_max_rss": "90374144", "process_in_blocks": "0", "process_out_blocks": "0"}
[0m15:05:35.469164 [debug] [MainThread]: Command `dbt deps` succeeded at 15:05:35.469095 after 3.55 seconds
[0m15:05:35.469456 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1024837c0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104707f70>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104707f40>]}
[0m15:05:35.469710 [debug] [MainThread]: Flushing usage events
[0m15:07:36.035773 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106fb37c0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108fc2280>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108fc2a00>]}


============================== 15:07:36.038408 | 7faec542-27ae-45eb-a33f-6461d96ab185 ==============================
[0m15:07:36.038408 [info ] [MainThread]: Running with dbt=1.8.1
[0m15:07:36.038765 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'debug': 'False', 'log_path': '/Users/shrikanth/Shrikanth/dbt-helloworld/logs', 'version_check': 'True', 'profiles_dir': '/Users/shrikanth/.dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'invocation_command': 'dbt build', 'static_parser': 'True', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m15:07:36.040507 [error] [MainThread]: Encountered an error:
Runtime Error
  Could not find profile named 'pgmigrate'
[0m15:07:36.041955 [debug] [MainThread]: Resource report: {"command_name": "build", "command_wall_clock_time": 0.04494429, "process_user_time": 0.596495, "process_kernel_time": 0.087833, "process_mem_max_rss": "86310912", "command_success": false, "process_in_blocks": "0", "process_out_blocks": "0"}
[0m15:07:36.042371 [debug] [MainThread]: Command `dbt build` failed at 15:07:36.042314 after 0.05 seconds
[0m15:07:36.042594 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106fb37c0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108e2bd90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1089bae20>]}
[0m15:07:36.042817 [debug] [MainThread]: Flushing usage events
[0m15:08:47.038988 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107027730>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x111bcbac0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x111bdeac0>]}


============================== 15:08:47.041608 | 17735fa6-c640-4cae-ac73-0cef49007472 ==============================
[0m15:08:47.041608 [info ] [MainThread]: Running with dbt=1.8.1
[0m15:08:47.041949 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'profiles_dir': '/Users/shrikanth/Shrikanth/dbt-helloworld', 'log_path': '/Users/shrikanth/Shrikanth/dbt-helloworld/logs', 'fail_fast': 'False', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'invocation_command': 'dbt build', 'log_format': 'default', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m15:08:47.043710 [error] [MainThread]: Encountered an error:
Runtime Error
  
  dbt encountered an error while trying to read your profiles.yml file.
  
  Runtime Error
    Syntax error near line 2
    ------------------------------
    1  | pgmigrate
    2  |   target: dev
    3  |   outputs:
    4  |     dev:
    5  |       type: postgres
    
    Raw Error:
    ------------------------------
    mapping values are not allowed in this context
      in "<unicode string>", line 2, column 9
  
[0m15:08:47.045155 [debug] [MainThread]: Resource report: {"command_name": "build", "command_wall_clock_time": 0.019141708, "process_user_time": 0.54774, "process_kernel_time": 0.081646, "process_mem_max_rss": "84279296", "command_success": false, "process_in_blocks": "0", "process_out_blocks": "0"}
[0m15:08:47.045543 [debug] [MainThread]: Command `dbt build` failed at 15:08:47.045485 after 0.02 seconds
[0m15:08:47.045809 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107027730>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x111bcb730>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x111bcb760>]}
[0m15:08:47.046029 [debug] [MainThread]: Flushing usage events
[0m15:08:54.271160 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1042b7790>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1062c63a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1062c6b20>]}


============================== 15:08:54.273746 | c92b89b8-3697-401d-af25-8bb0bacc125d ==============================
[0m15:08:54.273746 [info ] [MainThread]: Running with dbt=1.8.1
[0m15:08:54.274111 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/Users/shrikanth/Shrikanth/dbt-helloworld', 'version_check': 'True', 'debug': 'False', 'log_path': '/Users/shrikanth/Shrikanth/dbt-helloworld/logs', 'warn_error': 'None', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'static_parser': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt build', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m15:08:54.276969 [info ] [MainThread]: Error importing adapter: No module named 'dbt.adapters.postgres'
[0m15:08:54.277358 [error] [MainThread]: Encountered an error:
Runtime Error
  Credentials in profile "pgmigrate", target "dev" invalid: Runtime Error
    Could not find adapter type postgres!
[0m15:08:54.279104 [debug] [MainThread]: Resource report: {"command_name": "build", "command_wall_clock_time": 0.045161374, "process_user_time": 0.561688, "process_kernel_time": 0.064374, "process_mem_max_rss": "84541440", "command_success": false, "process_in_blocks": "0", "process_out_blocks": "0"}
[0m15:08:54.279485 [debug] [MainThread]: Command `dbt build` failed at 15:08:54.279428 after 0.05 seconds
[0m15:08:54.279733 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1042b7790>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105f9dc70>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106253340>]}
[0m15:08:54.279969 [debug] [MainThread]: Flushing usage events
[0m15:09:45.640238 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1025e7760>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1045f6250>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1045f69d0>]}


============================== 15:09:45.643545 | 4e41c5de-15ea-4cb2-becb-7625c054b647 ==============================
[0m15:09:45.643545 [info ] [MainThread]: Running with dbt=1.8.1
[0m15:09:45.643917 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/Users/shrikanth/Shrikanth/dbt-helloworld', 'version_check': 'True', 'fail_fast': 'False', 'log_path': '/Users/shrikanth/Shrikanth/dbt-helloworld/logs', 'debug': 'False', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'invocation_command': 'dbt build', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m15:09:46.352676 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '4e41c5de-15ea-4cb2-becb-7625c054b647', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10281bdc0>]}
[0m15:09:46.383309 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '4e41c5de-15ea-4cb2-becb-7625c054b647', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104aa82e0>]}
[0m15:09:46.383994 [info ] [MainThread]: Registered adapter: postgres=1.8.1
[0m15:09:46.690455 [debug] [MainThread]: checksum: ebc509fb14e151ea268e89b60fd5abf912ed99129f87516462718fa2f14f4838, vars: {}, profile: , target: , version: 1.8.1
[0m15:09:46.691376 [info ] [MainThread]: Unable to do partial parsing because saved manifest not found. Starting full parse.
[0m15:09:46.691734 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': '4e41c5de-15ea-4cb2-becb-7625c054b647', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104af71f0>]}
[0m15:09:47.556729 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '4e41c5de-15ea-4cb2-becb-7625c054b647', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105299130>]}
[0m15:09:47.641206 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '4e41c5de-15ea-4cb2-becb-7625c054b647', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1053c0d30>]}
[0m15:09:47.641573 [info ] [MainThread]: Found 3 models, 4 data tests, 527 macros
[0m15:09:47.642558 [info ] [MainThread]: 
[0m15:09:47.642899 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m15:09:47.645176 [debug] [ThreadPool]: Acquiring new postgres connection 'list_your-database-name'
[0m15:09:47.645543 [debug] [ThreadPool]: Acquiring new postgres connection 'list_your-database-name'
[0m15:09:47.689706 [debug] [ThreadPool]: Using postgres connection "list_your-database-name"
[0m15:09:47.689991 [debug] [ThreadPool]: Using postgres connection "list_your-database-name"
[0m15:09:47.690266 [debug] [ThreadPool]: On list_your-database-name: /* {"app": "dbt", "dbt_version": "1.8.1", "profile_name": "pgmigrate", "target_name": "dev", "connection_name": "list_your-database-name"} */

    select distinct nspname from pg_namespace
  
[0m15:09:47.690500 [debug] [ThreadPool]: On list_your-database-name: /* {"app": "dbt", "dbt_version": "1.8.1", "profile_name": "pgmigrate", "target_name": "dev", "connection_name": "list_your-database-name"} */

    select distinct nspname from pg_namespace
  
[0m15:09:47.690734 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m15:09:47.690940 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m15:09:48.077777 [debug] [ThreadPool]: Postgres adapter: Got a retryable error when attempting to open a postgres connection.
1 attempts remaining. Retrying in 0 seconds.
Error:
could not translate host name "your-database-host.com" to address: nodename nor servname provided, or not known

[0m15:09:48.078911 [debug] [ThreadPool]: Postgres adapter: Got a retryable error when attempting to open a postgres connection.
1 attempts remaining. Retrying in 0 seconds.
Error:
could not translate host name "your-database-host.com" to address: nodename nor servname provided, or not known

[0m15:09:48.080772 [debug] [ThreadPool]: Postgres adapter: Error running SQL: /* {"app": "dbt", "dbt_version": "1.8.1", "profile_name": "pgmigrate", "target_name": "dev", "connection_name": "list_your-database-name"} */

    select distinct nspname from pg_namespace
  
[0m15:09:48.081601 [debug] [ThreadPool]: Postgres adapter: Error running SQL: /* {"app": "dbt", "dbt_version": "1.8.1", "profile_name": "pgmigrate", "target_name": "dev", "connection_name": "list_your-database-name"} */

    select distinct nspname from pg_namespace
  
[0m15:09:48.082268 [debug] [ThreadPool]: Postgres adapter: Rolling back transaction.
[0m15:09:48.082874 [debug] [ThreadPool]: Postgres adapter: Rolling back transaction.
[0m15:09:48.083558 [debug] [ThreadPool]: Postgres adapter: Error running SQL: macro list_schemas
[0m15:09:48.084203 [debug] [ThreadPool]: Postgres adapter: Error running SQL: macro list_schemas
[0m15:09:48.084793 [debug] [ThreadPool]: Postgres adapter: Rolling back transaction.
[0m15:09:48.085372 [debug] [ThreadPool]: Postgres adapter: Rolling back transaction.
[0m15:09:48.085959 [debug] [ThreadPool]: On list_your-database-name: No close available on handle
[0m15:09:48.086381 [debug] [ThreadPool]: On list_your-database-name: No close available on handle
[0m15:09:48.087581 [debug] [MainThread]: Connection 'master' was properly closed.
[0m15:09:48.088083 [debug] [MainThread]: Connection 'list_your-database-name' was properly closed.
[0m15:09:48.088538 [debug] [MainThread]: Connection 'list_your-database-name' was properly closed.
[0m15:09:48.089022 [info ] [MainThread]: 
[0m15:09:48.089535 [info ] [MainThread]: Finished running  in 0 hours 0 minutes and 0.45 seconds (0.45s).
[0m15:09:48.090224 [error] [MainThread]: Encountered an error:
Database Error
  could not translate host name "your-database-host.com" to address: nodename nor servname provided, or not known
  
[0m15:09:48.093689 [debug] [MainThread]: Resource report: {"command_name": "build", "command_wall_clock_time": 2.496186, "process_user_time": 1.683311, "process_kernel_time": 0.141941, "process_mem_max_rss": "108937216", "command_success": false, "process_in_blocks": "0", "process_out_blocks": "0"}
[0m15:09:48.094100 [debug] [MainThread]: Command `dbt build` failed at 15:09:48.094039 after 2.50 seconds
[0m15:09:48.094347 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1025e7760>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105588790>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1055889d0>]}
[0m15:09:48.094584 [debug] [MainThread]: Flushing usage events
[0m15:10:38.428906 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104663790>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1079a63a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1079a6b20>]}


============================== 15:10:38.431562 | d01f9e33-f306-41af-9b6c-b608a0a1e3ed ==============================
[0m15:10:38.431562 [info ] [MainThread]: Running with dbt=1.8.1
[0m15:10:38.431964 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/Users/shrikanth/Shrikanth/dbt-helloworld', 'debug': 'False', 'warn_error': 'None', 'log_path': '/Users/shrikanth/Shrikanth/dbt-helloworld/logs', 'version_check': 'True', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'invocation_command': 'dbt build', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m15:10:38.590270 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'd01f9e33-f306-41af-9b6c-b608a0a1e3ed', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107d9aa60>]}
[0m15:10:38.618268 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'd01f9e33-f306-41af-9b6c-b608a0a1e3ed', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1064cd4c0>]}
[0m15:10:38.618845 [info ] [MainThread]: Registered adapter: postgres=1.8.1
[0m15:10:38.632201 [debug] [MainThread]: checksum: ebc509fb14e151ea268e89b60fd5abf912ed99129f87516462718fa2f14f4838, vars: {}, profile: , target: , version: 1.8.1
[0m15:10:38.690565 [info ] [MainThread]: Unable to do partial parsing because profile has changed
[0m15:10:38.690915 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': 'd01f9e33-f306-41af-9b6c-b608a0a1e3ed', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106472370>]}
[0m15:10:39.456088 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'd01f9e33-f306-41af-9b6c-b608a0a1e3ed', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108885e20>]}
[0m15:10:39.522025 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'd01f9e33-f306-41af-9b6c-b608a0a1e3ed', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107e72640>]}
[0m15:10:39.522340 [info ] [MainThread]: Found 3 models, 4 data tests, 527 macros
[0m15:10:39.523267 [info ] [MainThread]: 
[0m15:10:39.523582 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m15:10:39.525743 [debug] [ThreadPool]: Acquiring new postgres connection 'list_postgres'
[0m15:10:39.526041 [debug] [ThreadPool]: Acquiring new postgres connection 'list_postgres'
[0m15:10:39.554808 [debug] [ThreadPool]: Using postgres connection "list_postgres"
[0m15:10:39.555052 [debug] [ThreadPool]: Using postgres connection "list_postgres"
[0m15:10:39.555279 [debug] [ThreadPool]: On list_postgres: /* {"app": "dbt", "dbt_version": "1.8.1", "profile_name": "pgmigrate", "target_name": "dev", "connection_name": "list_postgres"} */

    select distinct nspname from pg_namespace
  
[0m15:10:39.555484 [debug] [ThreadPool]: On list_postgres: /* {"app": "dbt", "dbt_version": "1.8.1", "profile_name": "pgmigrate", "target_name": "dev", "connection_name": "list_postgres"} */

    select distinct nspname from pg_namespace
  
[0m15:10:39.555673 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m15:10:39.555851 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m15:10:39.595916 [debug] [ThreadPool]: SQL status: SELECT 18 in 0.0 seconds
[0m15:10:39.596813 [debug] [ThreadPool]: On list_postgres: Close
[0m15:10:39.597038 [debug] [ThreadPool]: SQL status: SELECT 18 in 0.0 seconds
[0m15:10:39.597710 [debug] [ThreadPool]: On list_postgres: Close
[0m15:10:39.598500 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_postgres, now list_postgres_public__airbyte_quarantine)
[0m15:10:39.602186 [debug] [ThreadPool]: Using postgres connection "list_postgres_public__airbyte_quarantine"
[0m15:10:39.602514 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_postgres, now list_postgres_public)
[0m15:10:39.602703 [debug] [ThreadPool]: On list_postgres_public__airbyte_quarantine: BEGIN
[0m15:10:39.604031 [debug] [ThreadPool]: Using postgres connection "list_postgres_public"
[0m15:10:39.604240 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m15:10:39.604420 [debug] [ThreadPool]: On list_postgres_public: BEGIN
[0m15:10:39.604672 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m15:10:39.608631 [debug] [ThreadPool]: SQL status: BEGIN in 0.0 seconds
[0m15:10:39.608818 [debug] [ThreadPool]: SQL status: BEGIN in 0.0 seconds
[0m15:10:39.609010 [debug] [ThreadPool]: Using postgres connection "list_postgres_public__airbyte_quarantine"
[0m15:10:39.609190 [debug] [ThreadPool]: Using postgres connection "list_postgres_public"
[0m15:10:39.609386 [debug] [ThreadPool]: On list_postgres_public__airbyte_quarantine: /* {"app": "dbt", "dbt_version": "1.8.1", "profile_name": "pgmigrate", "target_name": "dev", "connection_name": "list_postgres_public__airbyte_quarantine"} */
select
      'postgres' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public__airbyte_quarantine'
    union all
    select
      'postgres' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public__airbyte_quarantine'
    union all
    select
      'postgres' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public__airbyte_quarantine'
  
[0m15:10:39.609598 [debug] [ThreadPool]: On list_postgres_public: /* {"app": "dbt", "dbt_version": "1.8.1", "profile_name": "pgmigrate", "target_name": "dev", "connection_name": "list_postgres_public"} */
select
      'postgres' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'postgres' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
    union all
    select
      'postgres' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public'
  
[0m15:10:39.614279 [debug] [ThreadPool]: SQL status: SELECT 5 in 0.0 seconds
[0m15:10:39.614464 [debug] [ThreadPool]: SQL status: SELECT 0 in 0.0 seconds
[0m15:10:39.615155 [debug] [ThreadPool]: On list_postgres_public: ROLLBACK
[0m15:10:39.615723 [debug] [ThreadPool]: On list_postgres_public__airbyte_quarantine: ROLLBACK
[0m15:10:39.616059 [debug] [ThreadPool]: On list_postgres_public: Close
[0m15:10:39.616236 [debug] [ThreadPool]: On list_postgres_public__airbyte_quarantine: Close
[0m15:10:39.619330 [debug] [MainThread]: Using postgres connection "master"
[0m15:10:39.619545 [debug] [MainThread]: On master: BEGIN
[0m15:10:39.619722 [debug] [MainThread]: Opening a new connection, currently in state init
[0m15:10:39.624006 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m15:10:39.624221 [debug] [MainThread]: Using postgres connection "master"
[0m15:10:39.624455 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.8.1", "profile_name": "pgmigrate", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m15:10:39.642206 [debug] [MainThread]: SQL status: SELECT 1 in 0.0 seconds
[0m15:10:39.643009 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'd01f9e33-f306-41af-9b6c-b608a0a1e3ed', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108869730>]}
[0m15:10:39.643292 [debug] [MainThread]: On master: ROLLBACK
[0m15:10:39.643647 [debug] [MainThread]: Using postgres connection "master"
[0m15:10:39.643841 [debug] [MainThread]: On master: BEGIN
[0m15:10:39.644226 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m15:10:39.644431 [debug] [MainThread]: On master: COMMIT
[0m15:10:39.644616 [debug] [MainThread]: Using postgres connection "master"
[0m15:10:39.644795 [debug] [MainThread]: On master: COMMIT
[0m15:10:39.645091 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m15:10:39.645284 [debug] [MainThread]: On master: Close
[0m15:10:39.645543 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m15:10:39.645756 [info ] [MainThread]: 
[0m15:10:39.647825 [debug] [Thread-1  ]: Began running node model.pgmigrate.my_first_dbt_model
[0m15:10:39.648158 [debug] [Thread-2  ]: Began running node model.pgmigrate.users_dbt_model
[0m15:10:39.648466 [info ] [Thread-1  ]: 1 of 7 START sql table model public.my_first_dbt_model ......................... [RUN]
[0m15:10:39.648782 [info ] [Thread-2  ]: 2 of 7 START sql view model public__airbyte_quarantine.users_scalar ............ [RUN]
[0m15:10:39.649059 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly list_postgres_public__airbyte_quarantine, now model.pgmigrate.my_first_dbt_model)
[0m15:10:39.649304 [debug] [Thread-2  ]: Re-using an available connection from the pool (formerly list_postgres_public, now model.pgmigrate.users_dbt_model)
[0m15:10:39.649530 [debug] [Thread-1  ]: Began compiling node model.pgmigrate.my_first_dbt_model
[0m15:10:39.649750 [debug] [Thread-2  ]: Began compiling node model.pgmigrate.users_dbt_model
[0m15:10:39.654683 [debug] [Thread-1  ]: Writing injected SQL for node "model.pgmigrate.my_first_dbt_model"
[0m15:10:39.658762 [debug] [Thread-1  ]: Began executing node model.pgmigrate.my_first_dbt_model
[0m15:10:39.681712 [debug] [Thread-1  ]: Writing runtime sql for node "model.pgmigrate.my_first_dbt_model"
[0m15:10:39.682351 [debug] [Thread-1  ]: Using postgres connection "model.pgmigrate.my_first_dbt_model"
[0m15:10:39.682614 [debug] [Thread-1  ]: On model.pgmigrate.my_first_dbt_model: BEGIN
[0m15:10:39.682826 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m15:10:39.685347 [debug] [Thread-2  ]: Compilation Error in model users_dbt_model (models/example/users_dbt_model.sql)
  'json_extract_scalar' is undefined. This can happen when calling a macro that does not exist. Check for typos and/or install package dependencies with "dbt deps".
[0m15:10:39.686155 [debug] [Thread-2  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'd01f9e33-f306-41af-9b6c-b608a0a1e3ed', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1064b97c0>]}
[0m15:10:39.686506 [error] [Thread-2  ]: 2 of 7 ERROR creating sql view model public__airbyte_quarantine.users_scalar ... [[31mERROR[0m in 0.04s]
[0m15:10:39.686830 [debug] [Thread-2  ]: Finished running node model.pgmigrate.users_dbt_model
[0m15:10:39.687409 [debug] [Thread-1  ]: SQL status: BEGIN in 0.0 seconds
[0m15:10:39.687645 [debug] [Thread-1  ]: Using postgres connection "model.pgmigrate.my_first_dbt_model"
[0m15:10:39.687865 [debug] [Thread-1  ]: On model.pgmigrate.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.8.1", "profile_name": "pgmigrate", "target_name": "dev", "node_id": "model.pgmigrate.my_first_dbt_model"} */

  
    

  create  table "postgres"."public"."my_first_dbt_model__dbt_tmp"
  
  
    as
  
  (
    /*
    Welcome to your first dbt model!
    Did you know that you can also configure models directly within SQL files?
    This will override configurations stated in dbt_project.yml

    Try changing "table" to "view" below
*/



with source_data as (

    select 1 as id
    union all
    select null as id

)

select *
from source_data

/*
    Uncomment the line below to remove records with null `id` values
*/

-- where id is not null
  );
  
[0m15:10:39.692034 [debug] [Thread-1  ]: SQL status: SELECT 2 in 0.0 seconds
[0m15:10:39.695887 [debug] [Thread-1  ]: Using postgres connection "model.pgmigrate.my_first_dbt_model"
[0m15:10:39.696137 [debug] [Thread-1  ]: On model.pgmigrate.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.8.1", "profile_name": "pgmigrate", "target_name": "dev", "node_id": "model.pgmigrate.my_first_dbt_model"} */
alter table "postgres"."public"."my_first_dbt_model" rename to "my_first_dbt_model__dbt_backup"
[0m15:10:39.697187 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.0 seconds
[0m15:10:39.699211 [debug] [Thread-1  ]: Using postgres connection "model.pgmigrate.my_first_dbt_model"
[0m15:10:39.699449 [debug] [Thread-1  ]: On model.pgmigrate.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.8.1", "profile_name": "pgmigrate", "target_name": "dev", "node_id": "model.pgmigrate.my_first_dbt_model"} */
alter table "postgres"."public"."my_first_dbt_model__dbt_tmp" rename to "my_first_dbt_model"
[0m15:10:39.700484 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.0 seconds
[0m15:10:39.711217 [debug] [Thread-1  ]: On model.pgmigrate.my_first_dbt_model: COMMIT
[0m15:10:39.711472 [debug] [Thread-1  ]: Using postgres connection "model.pgmigrate.my_first_dbt_model"
[0m15:10:39.711700 [debug] [Thread-1  ]: On model.pgmigrate.my_first_dbt_model: COMMIT
[0m15:10:39.712614 [debug] [Thread-1  ]: SQL status: COMMIT in 0.0 seconds
[0m15:10:39.716115 [debug] [Thread-1  ]: Applying DROP to: "postgres"."public"."my_first_dbt_model__dbt_backup"
[0m15:10:39.718422 [debug] [Thread-1  ]: Using postgres connection "model.pgmigrate.my_first_dbt_model"
[0m15:10:39.718643 [debug] [Thread-1  ]: On model.pgmigrate.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.8.1", "profile_name": "pgmigrate", "target_name": "dev", "node_id": "model.pgmigrate.my_first_dbt_model"} */
drop table if exists "postgres"."public"."my_first_dbt_model__dbt_backup" cascade
[0m15:10:39.723744 [debug] [Thread-1  ]: SQL status: DROP TABLE in 0.0 seconds
[0m15:10:39.724988 [debug] [Thread-1  ]: On model.pgmigrate.my_first_dbt_model: Close
[0m15:10:39.725286 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'd01f9e33-f306-41af-9b6c-b608a0a1e3ed', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108d80f40>]}
[0m15:10:39.725622 [info ] [Thread-1  ]: 1 of 7 OK created sql table model public.my_first_dbt_model .................... [[32mSELECT 2[0m in 0.08s]
[0m15:10:39.725971 [debug] [Thread-1  ]: Finished running node model.pgmigrate.my_first_dbt_model
[0m15:10:39.726446 [debug] [Thread-4  ]: Began running node test.pgmigrate.not_null_my_first_dbt_model_id.5fb22c2710
[0m15:10:39.726918 [debug] [Thread-3  ]: Began running node test.pgmigrate.unique_my_first_dbt_model_id.16e066b321
[0m15:10:39.726696 [info ] [Thread-4  ]: 3 of 7 START test not_null_my_first_dbt_model_id ............................... [RUN]
[0m15:10:39.727348 [info ] [Thread-3  ]: 4 of 7 START test unique_my_first_dbt_model_id ................................. [RUN]
[0m15:10:39.727741 [debug] [Thread-4  ]: Acquiring new postgres connection 'test.pgmigrate.not_null_my_first_dbt_model_id.5fb22c2710'
[0m15:10:39.728030 [debug] [Thread-3  ]: Acquiring new postgres connection 'test.pgmigrate.unique_my_first_dbt_model_id.16e066b321'
[0m15:10:39.728266 [debug] [Thread-4  ]: Began compiling node test.pgmigrate.not_null_my_first_dbt_model_id.5fb22c2710
[0m15:10:39.728488 [debug] [Thread-3  ]: Began compiling node test.pgmigrate.unique_my_first_dbt_model_id.16e066b321
[0m15:10:39.735660 [debug] [Thread-4  ]: Writing injected SQL for node "test.pgmigrate.not_null_my_first_dbt_model_id.5fb22c2710"
[0m15:10:39.739146 [debug] [Thread-3  ]: Writing injected SQL for node "test.pgmigrate.unique_my_first_dbt_model_id.16e066b321"
[0m15:10:39.739652 [debug] [Thread-3  ]: Began executing node test.pgmigrate.unique_my_first_dbt_model_id.16e066b321
[0m15:10:39.739872 [debug] [Thread-4  ]: Began executing node test.pgmigrate.not_null_my_first_dbt_model_id.5fb22c2710
[0m15:10:39.748322 [debug] [Thread-3  ]: Writing runtime sql for node "test.pgmigrate.unique_my_first_dbt_model_id.16e066b321"
[0m15:10:39.749970 [debug] [Thread-4  ]: Writing runtime sql for node "test.pgmigrate.not_null_my_first_dbt_model_id.5fb22c2710"
[0m15:10:39.750475 [debug] [Thread-3  ]: Using postgres connection "test.pgmigrate.unique_my_first_dbt_model_id.16e066b321"
[0m15:10:39.750718 [debug] [Thread-4  ]: Using postgres connection "test.pgmigrate.not_null_my_first_dbt_model_id.5fb22c2710"
[0m15:10:39.750953 [debug] [Thread-3  ]: On test.pgmigrate.unique_my_first_dbt_model_id.16e066b321: BEGIN
[0m15:10:39.751185 [debug] [Thread-4  ]: On test.pgmigrate.not_null_my_first_dbt_model_id.5fb22c2710: BEGIN
[0m15:10:39.751405 [debug] [Thread-3  ]: Opening a new connection, currently in state init
[0m15:10:39.751621 [debug] [Thread-4  ]: Opening a new connection, currently in state init
[0m15:10:39.756751 [debug] [Thread-3  ]: SQL status: BEGIN in 0.0 seconds
[0m15:10:39.756965 [debug] [Thread-3  ]: Using postgres connection "test.pgmigrate.unique_my_first_dbt_model_id.16e066b321"
[0m15:10:39.757197 [debug] [Thread-3  ]: On test.pgmigrate.unique_my_first_dbt_model_id.16e066b321: /* {"app": "dbt", "dbt_version": "1.8.1", "profile_name": "pgmigrate", "target_name": "dev", "node_id": "test.pgmigrate.unique_my_first_dbt_model_id.16e066b321"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

select
    id as unique_field,
    count(*) as n_records

from "postgres"."public"."my_first_dbt_model"
where id is not null
group by id
having count(*) > 1



      
    ) dbt_internal_test
[0m15:10:39.757508 [debug] [Thread-4  ]: SQL status: BEGIN in 0.0 seconds
[0m15:10:39.757703 [debug] [Thread-4  ]: Using postgres connection "test.pgmigrate.not_null_my_first_dbt_model_id.5fb22c2710"
[0m15:10:39.757901 [debug] [Thread-4  ]: On test.pgmigrate.not_null_my_first_dbt_model_id.5fb22c2710: /* {"app": "dbt", "dbt_version": "1.8.1", "profile_name": "pgmigrate", "target_name": "dev", "node_id": "test.pgmigrate.not_null_my_first_dbt_model_id.5fb22c2710"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select id
from "postgres"."public"."my_first_dbt_model"
where id is null



      
    ) dbt_internal_test
[0m15:10:39.760172 [debug] [Thread-4  ]: SQL status: SELECT 1 in 0.0 seconds
[0m15:10:39.762111 [debug] [Thread-4  ]: On test.pgmigrate.not_null_my_first_dbt_model_id.5fb22c2710: ROLLBACK
[0m15:10:39.762365 [debug] [Thread-3  ]: SQL status: SELECT 1 in 0.0 seconds
[0m15:10:39.763214 [debug] [Thread-3  ]: On test.pgmigrate.unique_my_first_dbt_model_id.16e066b321: ROLLBACK
[0m15:10:39.763428 [debug] [Thread-4  ]: On test.pgmigrate.not_null_my_first_dbt_model_id.5fb22c2710: Close
[0m15:10:39.763824 [error] [Thread-4  ]: 3 of 7 FAIL 1 not_null_my_first_dbt_model_id ................................... [[31mFAIL 1[0m in 0.04s]
[0m15:10:39.764091 [debug] [Thread-3  ]: On test.pgmigrate.unique_my_first_dbt_model_id.16e066b321: Close
[0m15:10:39.764441 [debug] [Thread-4  ]: Finished running node test.pgmigrate.not_null_my_first_dbt_model_id.5fb22c2710
[0m15:10:39.764772 [info ] [Thread-3  ]: 4 of 7 PASS unique_my_first_dbt_model_id ....................................... [[32mPASS[0m in 0.04s]
[0m15:10:39.765205 [debug] [Thread-3  ]: Finished running node test.pgmigrate.unique_my_first_dbt_model_id.16e066b321
[0m15:10:39.765625 [debug] [Thread-1  ]: Began running node model.pgmigrate.my_second_dbt_model
[0m15:10:39.765905 [info ] [Thread-1  ]: 5 of 7 SKIP relation public.my_second_dbt_model ................................ [[33mSKIP[0m]
[0m15:10:39.766172 [debug] [Thread-1  ]: Finished running node model.pgmigrate.my_second_dbt_model
[0m15:10:39.766552 [debug] [Thread-4  ]: Began running node test.pgmigrate.not_null_my_second_dbt_model_id.151b76d778
[0m15:10:39.766773 [debug] [Thread-3  ]: Began running node test.pgmigrate.unique_my_second_dbt_model_id.57a0f8c493
[0m15:10:39.767030 [info ] [Thread-4  ]: 6 of 7 SKIP test not_null_my_second_dbt_model_id ............................... [[33mSKIP[0m]
[0m15:10:39.767299 [info ] [Thread-3  ]: 7 of 7 SKIP test unique_my_second_dbt_model_id ................................. [[33mSKIP[0m]
[0m15:10:39.767562 [debug] [Thread-4  ]: Finished running node test.pgmigrate.not_null_my_second_dbt_model_id.151b76d778
[0m15:10:39.767799 [debug] [Thread-3  ]: Finished running node test.pgmigrate.unique_my_second_dbt_model_id.57a0f8c493
[0m15:10:39.768453 [debug] [MainThread]: Using postgres connection "master"
[0m15:10:39.768628 [debug] [MainThread]: On master: BEGIN
[0m15:10:39.768788 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m15:10:39.772894 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m15:10:39.773082 [debug] [MainThread]: On master: COMMIT
[0m15:10:39.773253 [debug] [MainThread]: Using postgres connection "master"
[0m15:10:39.773415 [debug] [MainThread]: On master: COMMIT
[0m15:10:39.773718 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m15:10:39.773891 [debug] [MainThread]: On master: Close
[0m15:10:39.774109 [debug] [MainThread]: Connection 'master' was properly closed.
[0m15:10:39.774267 [debug] [MainThread]: Connection 'model.pgmigrate.my_first_dbt_model' was properly closed.
[0m15:10:39.774419 [debug] [MainThread]: Connection 'model.pgmigrate.users_dbt_model' was properly closed.
[0m15:10:39.774575 [debug] [MainThread]: Connection 'test.pgmigrate.not_null_my_first_dbt_model_id.5fb22c2710' was properly closed.
[0m15:10:39.774724 [debug] [MainThread]: Connection 'test.pgmigrate.unique_my_first_dbt_model_id.16e066b321' was properly closed.
[0m15:10:39.774927 [info ] [MainThread]: 
[0m15:10:39.775135 [info ] [MainThread]: Finished running 2 view models, 1 table model, 4 data tests in 0 hours 0 minutes and 0.25 seconds (0.25s).
[0m15:10:39.775708 [debug] [MainThread]: Command end result
[0m15:10:39.822252 [info ] [MainThread]: 
[0m15:10:39.822622 [info ] [MainThread]: [31mCompleted with 2 errors and 0 warnings:[0m
[0m15:10:39.822846 [info ] [MainThread]: 
[0m15:10:39.823099 [error] [MainThread]:   Compilation Error in model users_dbt_model (models/example/users_dbt_model.sql)
  'json_extract_scalar' is undefined. This can happen when calling a macro that does not exist. Check for typos and/or install package dependencies with "dbt deps".
[0m15:10:39.823304 [info ] [MainThread]: 
[0m15:10:39.823541 [error] [MainThread]: [31mFailure in test not_null_my_first_dbt_model_id (models/example/schema.yml)[0m
[0m15:10:39.823760 [error] [MainThread]:   Got 1 result, configured to fail if != 0
[0m15:10:39.823936 [info ] [MainThread]: 
[0m15:10:39.824150 [info ] [MainThread]:   compiled code at target/compiled/pgmigrate/models/example/schema.yml/not_null_my_first_dbt_model_id.sql
[0m15:10:39.824346 [info ] [MainThread]: 
[0m15:10:39.824545 [info ] [MainThread]: Done. PASS=2 WARN=0 ERROR=2 SKIP=3 TOTAL=7
[0m15:10:39.826016 [debug] [MainThread]: Resource report: {"command_name": "build", "command_wall_clock_time": 1.438559, "process_user_time": 1.747164, "process_kernel_time": 0.144556, "process_mem_max_rss": "122306560", "command_success": false, "process_in_blocks": "0", "process_out_blocks": "0"}
[0m15:10:39.826354 [debug] [MainThread]: Command `dbt build` failed at 15:10:39.826306 after 1.44 seconds
[0m15:10:39.826588 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104663790>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1084b3430>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10924b760>]}
[0m15:10:39.826807 [debug] [MainThread]: Flushing usage events
[0m15:24:58.856299 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x102aef730>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105624250>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1056249d0>]}


============================== 15:24:58.858877 | df9cd6df-e71f-4ca1-bb22-8dd5a315cbb3 ==============================
[0m15:24:58.858877 [info ] [MainThread]: Running with dbt=1.8.1
[0m15:24:58.859271 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'profiles_dir': '/Users/shrikanth/Shrikanth/dbt-helloworld', 'log_path': '/Users/shrikanth/Shrikanth/dbt-helloworld/logs', 'fail_fast': 'False', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'introspect': 'True', 'static_parser': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'target_path': 'None', 'invocation_command': 'dbt clean', 'send_anonymous_usage_stats': 'True'}
[0m15:24:58.978677 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'df9cd6df-e71f-4ca1-bb22-8dd5a315cbb3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1052b4d30>]}
[0m15:24:59.012229 [debug] [MainThread]: Resource report: {"command_name": "clean", "command_success": true, "command_wall_clock_time": 0.19351129, "process_user_time": 0.646787, "process_kernel_time": 0.112362, "process_mem_max_rss": "89817088", "process_in_blocks": "0", "process_out_blocks": "0"}
[0m15:24:59.012569 [debug] [MainThread]: Command `dbt clean` succeeded at 15:24:59.012521 after 0.19 seconds
[0m15:24:59.012803 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x102aef730>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10575efd0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1057150a0>]}
[0m15:24:59.013025 [debug] [MainThread]: Flushing usage events
[0m15:27:13.887772 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x102d4f700>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104d5e370>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104d5eaf0>]}


============================== 15:27:13.890673 | 0a2ea882-7660-4743-ba48-e2d4420a983a ==============================
[0m15:27:13.890673 [info ] [MainThread]: Running with dbt=1.8.1
[0m15:27:13.891113 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'profiles_dir': '/Users/shrikanth/Shrikanth/dbt-helloworld', 'log_path': '/Users/shrikanth/Shrikanth/dbt-helloworld/logs', 'version_check': 'True', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'static_parser': 'True', 'invocation_command': 'dbt build', 'introspect': 'True', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m15:27:14.090944 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '0a2ea882-7660-4743-ba48-e2d4420a983a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x102f81dc0>]}
[0m15:27:14.122395 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '0a2ea882-7660-4743-ba48-e2d4420a983a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x103ba2c70>]}
[0m15:27:14.123147 [info ] [MainThread]: Registered adapter: postgres=1.8.1
[0m15:27:14.138185 [debug] [MainThread]: checksum: ebc509fb14e151ea268e89b60fd5abf912ed99129f87516462718fa2f14f4838, vars: {}, profile: , target: , version: 1.8.1
[0m15:27:14.138806 [info ] [MainThread]: Unable to do partial parsing because saved manifest not found. Starting full parse.
[0m15:27:14.139084 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': '0a2ea882-7660-4743-ba48-e2d4420a983a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1052520a0>]}
[0m15:27:14.935434 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '0a2ea882-7660-4743-ba48-e2d4420a983a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1059ff130>]}
[0m15:27:15.006400 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '0a2ea882-7660-4743-ba48-e2d4420a983a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10579b910>]}
[0m15:27:15.006733 [info ] [MainThread]: Found 3 models, 4 data tests, 527 macros
[0m15:27:15.007691 [info ] [MainThread]: 
[0m15:27:15.008027 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m15:27:15.010195 [debug] [ThreadPool]: Acquiring new postgres connection 'list_postgres'
[0m15:27:15.010561 [debug] [ThreadPool]: Acquiring new postgres connection 'list_postgres'
[0m15:27:15.039315 [debug] [ThreadPool]: Using postgres connection "list_postgres"
[0m15:27:15.039559 [debug] [ThreadPool]: Using postgres connection "list_postgres"
[0m15:27:15.039809 [debug] [ThreadPool]: On list_postgres: /* {"app": "dbt", "dbt_version": "1.8.1", "profile_name": "pgmigrate", "target_name": "dev", "connection_name": "list_postgres"} */

    select distinct nspname from pg_namespace
  
[0m15:27:15.040015 [debug] [ThreadPool]: On list_postgres: /* {"app": "dbt", "dbt_version": "1.8.1", "profile_name": "pgmigrate", "target_name": "dev", "connection_name": "list_postgres"} */

    select distinct nspname from pg_namespace
  
[0m15:27:15.040208 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m15:27:15.040391 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m15:27:15.179382 [debug] [ThreadPool]: SQL status: SELECT 18 in 0.0 seconds
[0m15:27:15.180392 [debug] [ThreadPool]: On list_postgres: Close
[0m15:27:15.181513 [debug] [ThreadPool]: SQL status: SELECT 18 in 0.0 seconds
[0m15:27:15.182206 [debug] [ThreadPool]: On list_postgres: Close
[0m15:27:15.182957 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_postgres, now list_postgres_public__airbyte_quarantine)
[0m15:27:15.183253 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_postgres, now list_postgres_public)
[0m15:27:15.187253 [debug] [ThreadPool]: Using postgres connection "list_postgres_public__airbyte_quarantine"
[0m15:27:15.188984 [debug] [ThreadPool]: Using postgres connection "list_postgres_public"
[0m15:27:15.189202 [debug] [ThreadPool]: On list_postgres_public__airbyte_quarantine: BEGIN
[0m15:27:15.189395 [debug] [ThreadPool]: On list_postgres_public: BEGIN
[0m15:27:15.189581 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m15:27:15.189766 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m15:27:15.194927 [debug] [ThreadPool]: SQL status: BEGIN in 0.0 seconds
[0m15:27:15.195129 [debug] [ThreadPool]: SQL status: BEGIN in 0.0 seconds
[0m15:27:15.195358 [debug] [ThreadPool]: Using postgres connection "list_postgres_public__airbyte_quarantine"
[0m15:27:15.195564 [debug] [ThreadPool]: Using postgres connection "list_postgres_public"
[0m15:27:15.195777 [debug] [ThreadPool]: On list_postgres_public__airbyte_quarantine: /* {"app": "dbt", "dbt_version": "1.8.1", "profile_name": "pgmigrate", "target_name": "dev", "connection_name": "list_postgres_public__airbyte_quarantine"} */
select
      'postgres' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public__airbyte_quarantine'
    union all
    select
      'postgres' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public__airbyte_quarantine'
    union all
    select
      'postgres' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public__airbyte_quarantine'
  
[0m15:27:15.196014 [debug] [ThreadPool]: On list_postgres_public: /* {"app": "dbt", "dbt_version": "1.8.1", "profile_name": "pgmigrate", "target_name": "dev", "connection_name": "list_postgres_public"} */
select
      'postgres' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'postgres' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
    union all
    select
      'postgres' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public'
  
[0m15:27:15.203823 [debug] [ThreadPool]: SQL status: SELECT 4 in 0.0 seconds
[0m15:27:15.204018 [debug] [ThreadPool]: SQL status: SELECT 0 in 0.0 seconds
[0m15:27:15.204823 [debug] [ThreadPool]: On list_postgres_public: ROLLBACK
[0m15:27:15.205498 [debug] [ThreadPool]: On list_postgres_public__airbyte_quarantine: ROLLBACK
[0m15:27:15.205926 [debug] [ThreadPool]: On list_postgres_public__airbyte_quarantine: Close
[0m15:27:15.206110 [debug] [ThreadPool]: On list_postgres_public: Close
[0m15:27:15.209424 [debug] [MainThread]: Using postgres connection "master"
[0m15:27:15.209670 [debug] [MainThread]: On master: BEGIN
[0m15:27:15.209870 [debug] [MainThread]: Opening a new connection, currently in state init
[0m15:27:15.215433 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m15:27:15.215650 [debug] [MainThread]: Using postgres connection "master"
[0m15:27:15.215933 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.8.1", "profile_name": "pgmigrate", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m15:27:15.287362 [debug] [MainThread]: SQL status: SELECT 0 in 0.0 seconds
[0m15:27:15.288479 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '0a2ea882-7660-4743-ba48-e2d4420a983a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105cf0cd0>]}
[0m15:27:15.288828 [debug] [MainThread]: On master: ROLLBACK
[0m15:27:15.289218 [debug] [MainThread]: Using postgres connection "master"
[0m15:27:15.289471 [debug] [MainThread]: On master: BEGIN
[0m15:27:15.289890 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m15:27:15.290108 [debug] [MainThread]: On master: COMMIT
[0m15:27:15.290310 [debug] [MainThread]: Using postgres connection "master"
[0m15:27:15.290505 [debug] [MainThread]: On master: COMMIT
[0m15:27:15.290783 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m15:27:15.291015 [debug] [MainThread]: On master: Close
[0m15:27:15.291340 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m15:27:15.291577 [info ] [MainThread]: 
[0m15:27:15.292903 [debug] [Thread-1  ]: Began running node model.pgmigrate.my_first_dbt_model
[0m15:27:15.293463 [debug] [Thread-2  ]: Began running node model.pgmigrate.users_dbt_model
[0m15:27:15.294074 [info ] [Thread-1  ]: 1 of 7 START sql table model public.my_first_dbt_model ......................... [RUN]
[0m15:27:15.294523 [info ] [Thread-2  ]: 2 of 7 START sql view model public__airbyte_quarantine.users_scalar ............ [RUN]
[0m15:27:15.294864 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly list_postgres_public__airbyte_quarantine, now model.pgmigrate.my_first_dbt_model)
[0m15:27:15.295147 [debug] [Thread-2  ]: Re-using an available connection from the pool (formerly list_postgres_public, now model.pgmigrate.users_dbt_model)
[0m15:27:15.295409 [debug] [Thread-1  ]: Began compiling node model.pgmigrate.my_first_dbt_model
[0m15:27:15.295648 [debug] [Thread-2  ]: Began compiling node model.pgmigrate.users_dbt_model
[0m15:27:15.301595 [debug] [Thread-1  ]: Writing injected SQL for node "model.pgmigrate.my_first_dbt_model"
[0m15:27:15.306061 [debug] [Thread-1  ]: Began executing node model.pgmigrate.my_first_dbt_model
[0m15:27:15.329630 [debug] [Thread-1  ]: Writing runtime sql for node "model.pgmigrate.my_first_dbt_model"
[0m15:27:15.330308 [debug] [Thread-1  ]: Using postgres connection "model.pgmigrate.my_first_dbt_model"
[0m15:27:15.330584 [debug] [Thread-1  ]: On model.pgmigrate.my_first_dbt_model: BEGIN
[0m15:27:15.330891 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m15:27:15.333496 [debug] [Thread-2  ]: Compilation Error in model users_dbt_model (models/example/users_dbt_model.sql)
  'json_extract_scalar' is undefined. This can happen when calling a macro that does not exist. Check for typos and/or install package dependencies with "dbt deps".
[0m15:27:15.334385 [debug] [Thread-2  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '0a2ea882-7660-4743-ba48-e2d4420a983a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1041853d0>]}
[0m15:27:15.334778 [error] [Thread-2  ]: 2 of 7 ERROR creating sql view model public__airbyte_quarantine.users_scalar ... [[31mERROR[0m in 0.04s]
[0m15:27:15.335113 [debug] [Thread-2  ]: Finished running node model.pgmigrate.users_dbt_model
[0m15:27:15.351478 [debug] [Thread-1  ]: SQL status: BEGIN in 0.0 seconds
[0m15:27:15.351792 [debug] [Thread-1  ]: Using postgres connection "model.pgmigrate.my_first_dbt_model"
[0m15:27:15.352067 [debug] [Thread-1  ]: On model.pgmigrate.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.8.1", "profile_name": "pgmigrate", "target_name": "dev", "node_id": "model.pgmigrate.my_first_dbt_model"} */

  
    

  create  table "postgres"."public"."my_first_dbt_model__dbt_tmp"
  
  
    as
  
  (
    /*
    Welcome to your first dbt model!
    Did you know that you can also configure models directly within SQL files?
    This will override configurations stated in dbt_project.yml

    Try changing "table" to "view" below
*/



with source_data as (

    select 1 as id
    union all
    select null as id

)

select *
from source_data

/*
    Uncomment the line below to remove records with null `id` values
*/

-- where id is not null
  );
  
[0m15:27:15.361674 [debug] [Thread-1  ]: SQL status: SELECT 2 in 0.0 seconds
[0m15:27:15.365878 [debug] [Thread-1  ]: Using postgres connection "model.pgmigrate.my_first_dbt_model"
[0m15:27:15.366138 [debug] [Thread-1  ]: On model.pgmigrate.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.8.1", "profile_name": "pgmigrate", "target_name": "dev", "node_id": "model.pgmigrate.my_first_dbt_model"} */
alter table "postgres"."public"."my_first_dbt_model" rename to "my_first_dbt_model__dbt_backup"
[0m15:27:15.372922 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.0 seconds
[0m15:27:15.374875 [debug] [Thread-1  ]: Using postgres connection "model.pgmigrate.my_first_dbt_model"
[0m15:27:15.375109 [debug] [Thread-1  ]: On model.pgmigrate.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.8.1", "profile_name": "pgmigrate", "target_name": "dev", "node_id": "model.pgmigrate.my_first_dbt_model"} */
alter table "postgres"."public"."my_first_dbt_model__dbt_tmp" rename to "my_first_dbt_model"
[0m15:27:15.377861 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.0 seconds
[0m15:27:15.389573 [debug] [Thread-1  ]: On model.pgmigrate.my_first_dbt_model: COMMIT
[0m15:27:15.389831 [debug] [Thread-1  ]: Using postgres connection "model.pgmigrate.my_first_dbt_model"
[0m15:27:15.390058 [debug] [Thread-1  ]: On model.pgmigrate.my_first_dbt_model: COMMIT
[0m15:27:15.391011 [debug] [Thread-1  ]: SQL status: COMMIT in 0.0 seconds
[0m15:27:15.394840 [debug] [Thread-1  ]: Applying DROP to: "postgres"."public"."my_first_dbt_model__dbt_backup"
[0m15:27:15.397362 [debug] [Thread-1  ]: Using postgres connection "model.pgmigrate.my_first_dbt_model"
[0m15:27:15.397602 [debug] [Thread-1  ]: On model.pgmigrate.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.8.1", "profile_name": "pgmigrate", "target_name": "dev", "node_id": "model.pgmigrate.my_first_dbt_model"} */
drop table if exists "postgres"."public"."my_first_dbt_model__dbt_backup" cascade
[0m15:27:15.399873 [debug] [Thread-1  ]: SQL status: DROP TABLE in 0.0 seconds
[0m15:27:15.401205 [debug] [Thread-1  ]: On model.pgmigrate.my_first_dbt_model: Close
[0m15:27:15.401539 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '0a2ea882-7660-4743-ba48-e2d4420a983a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105ceaa00>]}
[0m15:27:15.401919 [info ] [Thread-1  ]: 1 of 7 OK created sql table model public.my_first_dbt_model .................... [[32mSELECT 2[0m in 0.11s]
[0m15:27:15.402270 [debug] [Thread-1  ]: Finished running node model.pgmigrate.my_first_dbt_model
[0m15:27:15.402758 [debug] [Thread-4  ]: Began running node test.pgmigrate.not_null_my_first_dbt_model_id.5fb22c2710
[0m15:27:15.403058 [debug] [Thread-3  ]: Began running node test.pgmigrate.unique_my_first_dbt_model_id.16e066b321
[0m15:27:15.403324 [info ] [Thread-4  ]: 3 of 7 START test not_null_my_first_dbt_model_id ............................... [RUN]
[0m15:27:15.403625 [info ] [Thread-3  ]: 4 of 7 START test unique_my_first_dbt_model_id ................................. [RUN]
[0m15:27:15.403979 [debug] [Thread-4  ]: Acquiring new postgres connection 'test.pgmigrate.not_null_my_first_dbt_model_id.5fb22c2710'
[0m15:27:15.404255 [debug] [Thread-3  ]: Acquiring new postgres connection 'test.pgmigrate.unique_my_first_dbt_model_id.16e066b321'
[0m15:27:15.404475 [debug] [Thread-4  ]: Began compiling node test.pgmigrate.not_null_my_first_dbt_model_id.5fb22c2710
[0m15:27:15.404687 [debug] [Thread-3  ]: Began compiling node test.pgmigrate.unique_my_first_dbt_model_id.16e066b321
[0m15:27:15.411673 [debug] [Thread-4  ]: Writing injected SQL for node "test.pgmigrate.not_null_my_first_dbt_model_id.5fb22c2710"
[0m15:27:15.416036 [debug] [Thread-3  ]: Writing injected SQL for node "test.pgmigrate.unique_my_first_dbt_model_id.16e066b321"
[0m15:27:15.416595 [debug] [Thread-3  ]: Began executing node test.pgmigrate.unique_my_first_dbt_model_id.16e066b321
[0m15:27:15.416843 [debug] [Thread-4  ]: Began executing node test.pgmigrate.not_null_my_first_dbt_model_id.5fb22c2710
[0m15:27:15.425209 [debug] [Thread-3  ]: Writing runtime sql for node "test.pgmigrate.unique_my_first_dbt_model_id.16e066b321"
[0m15:27:15.426705 [debug] [Thread-4  ]: Writing runtime sql for node "test.pgmigrate.not_null_my_first_dbt_model_id.5fb22c2710"
[0m15:27:15.427184 [debug] [Thread-4  ]: Using postgres connection "test.pgmigrate.not_null_my_first_dbt_model_id.5fb22c2710"
[0m15:27:15.427428 [debug] [Thread-3  ]: Using postgres connection "test.pgmigrate.unique_my_first_dbt_model_id.16e066b321"
[0m15:27:15.427633 [debug] [Thread-4  ]: On test.pgmigrate.not_null_my_first_dbt_model_id.5fb22c2710: BEGIN
[0m15:27:15.427850 [debug] [Thread-3  ]: On test.pgmigrate.unique_my_first_dbt_model_id.16e066b321: BEGIN
[0m15:27:15.428065 [debug] [Thread-4  ]: Opening a new connection, currently in state init
[0m15:27:15.428264 [debug] [Thread-3  ]: Opening a new connection, currently in state init
[0m15:27:15.433335 [debug] [Thread-3  ]: SQL status: BEGIN in 0.0 seconds
[0m15:27:15.433551 [debug] [Thread-3  ]: Using postgres connection "test.pgmigrate.unique_my_first_dbt_model_id.16e066b321"
[0m15:27:15.433760 [debug] [Thread-3  ]: On test.pgmigrate.unique_my_first_dbt_model_id.16e066b321: /* {"app": "dbt", "dbt_version": "1.8.1", "profile_name": "pgmigrate", "target_name": "dev", "node_id": "test.pgmigrate.unique_my_first_dbt_model_id.16e066b321"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

select
    id as unique_field,
    count(*) as n_records

from "postgres"."public"."my_first_dbt_model"
where id is not null
group by id
having count(*) > 1



      
    ) dbt_internal_test
[0m15:27:15.434200 [debug] [Thread-4  ]: SQL status: BEGIN in 0.0 seconds
[0m15:27:15.434393 [debug] [Thread-4  ]: Using postgres connection "test.pgmigrate.not_null_my_first_dbt_model_id.5fb22c2710"
[0m15:27:15.434602 [debug] [Thread-4  ]: On test.pgmigrate.not_null_my_first_dbt_model_id.5fb22c2710: /* {"app": "dbt", "dbt_version": "1.8.1", "profile_name": "pgmigrate", "target_name": "dev", "node_id": "test.pgmigrate.not_null_my_first_dbt_model_id.5fb22c2710"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select id
from "postgres"."public"."my_first_dbt_model"
where id is null



      
    ) dbt_internal_test
[0m15:27:15.435941 [debug] [Thread-4  ]: SQL status: SELECT 1 in 0.0 seconds
[0m15:27:15.436155 [debug] [Thread-3  ]: SQL status: SELECT 1 in 0.0 seconds
[0m15:27:15.437964 [debug] [Thread-4  ]: On test.pgmigrate.not_null_my_first_dbt_model_id.5fb22c2710: ROLLBACK
[0m15:27:15.438767 [debug] [Thread-3  ]: On test.pgmigrate.unique_my_first_dbt_model_id.16e066b321: ROLLBACK
[0m15:27:15.439163 [debug] [Thread-3  ]: On test.pgmigrate.unique_my_first_dbt_model_id.16e066b321: Close
[0m15:27:15.439366 [debug] [Thread-4  ]: On test.pgmigrate.not_null_my_first_dbt_model_id.5fb22c2710: Close
[0m15:27:15.439713 [info ] [Thread-3  ]: 4 of 7 PASS unique_my_first_dbt_model_id ....................................... [[32mPASS[0m in 0.04s]
[0m15:27:15.440099 [error] [Thread-4  ]: 3 of 7 FAIL 1 not_null_my_first_dbt_model_id ................................... [[31mFAIL 1[0m in 0.04s]
[0m15:27:15.440444 [debug] [Thread-3  ]: Finished running node test.pgmigrate.unique_my_first_dbt_model_id.16e066b321
[0m15:27:15.440757 [debug] [Thread-4  ]: Finished running node test.pgmigrate.not_null_my_first_dbt_model_id.5fb22c2710
[0m15:27:15.441284 [debug] [Thread-1  ]: Began running node model.pgmigrate.my_second_dbt_model
[0m15:27:15.441541 [info ] [Thread-1  ]: 5 of 7 SKIP relation public.my_second_dbt_model ................................ [[33mSKIP[0m]
[0m15:27:15.441833 [debug] [Thread-1  ]: Finished running node model.pgmigrate.my_second_dbt_model
[0m15:27:15.442241 [debug] [Thread-3  ]: Began running node test.pgmigrate.not_null_my_second_dbt_model_id.151b76d778
[0m15:27:15.442460 [debug] [Thread-4  ]: Began running node test.pgmigrate.unique_my_second_dbt_model_id.57a0f8c493
[0m15:27:15.442731 [info ] [Thread-3  ]: 6 of 7 SKIP test not_null_my_second_dbt_model_id ............................... [[33mSKIP[0m]
[0m15:27:15.442998 [info ] [Thread-4  ]: 7 of 7 SKIP test unique_my_second_dbt_model_id ................................. [[33mSKIP[0m]
[0m15:27:15.443254 [debug] [Thread-3  ]: Finished running node test.pgmigrate.not_null_my_second_dbt_model_id.151b76d778
[0m15:27:15.443475 [debug] [Thread-4  ]: Finished running node test.pgmigrate.unique_my_second_dbt_model_id.57a0f8c493
[0m15:27:15.444113 [debug] [MainThread]: Using postgres connection "master"
[0m15:27:15.444296 [debug] [MainThread]: On master: BEGIN
[0m15:27:15.444460 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m15:27:15.452194 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m15:27:15.452404 [debug] [MainThread]: On master: COMMIT
[0m15:27:15.452587 [debug] [MainThread]: Using postgres connection "master"
[0m15:27:15.452763 [debug] [MainThread]: On master: COMMIT
[0m15:27:15.453052 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m15:27:15.453240 [debug] [MainThread]: On master: Close
[0m15:27:15.453468 [debug] [MainThread]: Connection 'master' was properly closed.
[0m15:27:15.453639 [debug] [MainThread]: Connection 'model.pgmigrate.my_first_dbt_model' was properly closed.
[0m15:27:15.453799 [debug] [MainThread]: Connection 'model.pgmigrate.users_dbt_model' was properly closed.
[0m15:27:15.453966 [debug] [MainThread]: Connection 'test.pgmigrate.not_null_my_first_dbt_model_id.5fb22c2710' was properly closed.
[0m15:27:15.454121 [debug] [MainThread]: Connection 'test.pgmigrate.unique_my_first_dbt_model_id.16e066b321' was properly closed.
[0m15:27:15.454334 [info ] [MainThread]: 
[0m15:27:15.454536 [info ] [MainThread]: Finished running 2 view models, 1 table model, 4 data tests in 0 hours 0 minutes and 0.45 seconds (0.45s).
[0m15:27:15.455159 [debug] [MainThread]: Command end result
[0m15:27:15.474878 [info ] [MainThread]: 
[0m15:27:15.475178 [info ] [MainThread]: [31mCompleted with 2 errors and 0 warnings:[0m
[0m15:27:15.475377 [info ] [MainThread]: 
[0m15:27:15.475617 [error] [MainThread]:   Compilation Error in model users_dbt_model (models/example/users_dbt_model.sql)
  'json_extract_scalar' is undefined. This can happen when calling a macro that does not exist. Check for typos and/or install package dependencies with "dbt deps".
[0m15:27:15.475810 [info ] [MainThread]: 
[0m15:27:15.476034 [error] [MainThread]: [31mFailure in test not_null_my_first_dbt_model_id (models/example/schema.yml)[0m
[0m15:27:15.476250 [error] [MainThread]:   Got 1 result, configured to fail if != 0
[0m15:27:15.476430 [info ] [MainThread]: 
[0m15:27:15.476635 [info ] [MainThread]:   compiled code at target/compiled/pgmigrate/models/example/schema.yml/not_null_my_first_dbt_model_id.sql
[0m15:27:15.476823 [info ] [MainThread]: 
[0m15:27:15.477021 [info ] [MainThread]: Done. PASS=2 WARN=0 ERROR=2 SKIP=3 TOTAL=7
[0m15:27:15.478645 [debug] [MainThread]: Resource report: {"command_name": "build", "command_wall_clock_time": 1.6335838, "process_user_time": 1.768993, "process_kernel_time": 0.151236, "process_mem_max_rss": "123748352", "command_success": false, "process_in_blocks": "0", "process_out_blocks": "0"}
[0m15:27:15.478980 [debug] [MainThread]: Command `dbt build` failed at 15:27:15.478931 after 1.63 seconds
[0m15:27:15.479217 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x102d4f700>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x102f81dc0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x103ba2c70>]}
[0m15:27:15.479440 [debug] [MainThread]: Flushing usage events
[0m15:27:27.260726 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104e23790>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107a284f0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107a28f10>]}


============================== 15:27:27.263301 | ccde45ae-e463-46df-919e-4ae693feace8 ==============================
[0m15:27:27.263301 [info ] [MainThread]: Running with dbt=1.8.1
[0m15:27:27.263675 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/Users/shrikanth/Shrikanth/dbt-helloworld', 'version_check': 'True', 'debug': 'False', 'log_path': '/Users/shrikanth/Shrikanth/dbt-helloworld/logs', 'warn_error': 'None', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'introspect': 'True', 'log_format': 'default', 'target_path': 'None', 'invocation_command': 'dbt deps', 'send_anonymous_usage_stats': 'True'}
[0m15:27:27.343909 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'ccde45ae-e463-46df-919e-4ae693feace8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10406e4c0>]}
[0m15:27:27.382744 [debug] [MainThread]: Set downloads directory='/var/folders/ll/3nys2tln7dv4vrs7t9wxvd5w0000gn/T/dbt-downloads-_n1nd1x3'
[0m15:27:27.383047 [info ] [MainThread]: Installing https://github.com/dbt-labs/dbt-utils.git
[0m15:27:27.383339 [debug] [MainThread]: Executing "git clone --depth 1 https://github.com/dbt-labs/dbt-utils.git b03949bb53de3439f6a8057088ba4032"
[0m15:27:28.519557 [debug] [MainThread]: STDOUT: "b''"
[0m15:27:28.520306 [debug] [MainThread]: STDERR: "b"Cloning into 'b03949bb53de3439f6a8057088ba4032'...\n""
[0m15:27:28.520808 [debug] [MainThread]: Pulling new dependency b03949bb53de3439f6a8057088ba4032.
[0m15:27:28.521092 [debug] [MainThread]: Executing "git rev-parse HEAD"
[0m15:27:28.526990 [debug] [MainThread]: STDOUT: "b'fc98e4e30cd299ddd67c43902f2a5efa9511edfb\n'"
[0m15:27:28.527508 [debug] [MainThread]: STDERR: "b''"
[0m15:27:28.527780 [debug] [MainThread]: Checking out revision 74a661ca00452da7d2b2811ff1e5a37f152c3ee2.
[0m15:27:28.528037 [debug] [MainThread]: Executing "git fetch origin --depth 1 74a661ca00452da7d2b2811ff1e5a37f152c3ee2"
[0m15:27:29.994357 [debug] [MainThread]: STDOUT: "b''"
[0m15:27:29.995005 [debug] [MainThread]: STDERR: "b'From https://github.com/dbt-labs/dbt-utils\n * branch            74a661ca00452da7d2b2811ff1e5a37f152c3ee2 -> FETCH_HEAD\n'"
[0m15:27:29.995312 [debug] [MainThread]: Executing "git reset --hard 74a661ca00452da7d2b2811ff1e5a37f152c3ee2"
[0m15:27:30.016044 [debug] [MainThread]: STDOUT: "b'HEAD is now at 74a661c Update CHANGELOG for v1.1.1 (#803)\n'"
[0m15:27:30.016541 [debug] [MainThread]: STDERR: "b''"
[0m15:27:30.016770 [debug] [MainThread]: Executing "git rev-parse HEAD"
[0m15:27:30.021339 [debug] [MainThread]: STDOUT: "b'74a661ca00452da7d2b2811ff1e5a37f152c3ee2\n'"
[0m15:27:30.021720 [debug] [MainThread]: STDERR: "b''"
[0m15:27:30.021948 [debug] [MainThread]: Checked out at 74a661c.
[0m15:27:30.022151 [debug] [MainThread]: Executing "git rev-parse HEAD"
[0m15:27:30.026274 [debug] [MainThread]: STDOUT: "b'74a661ca00452da7d2b2811ff1e5a37f152c3ee2\n'"
[0m15:27:30.026636 [debug] [MainThread]: STDERR: "b''"
[0m15:27:30.027345 [debug] [MainThread]: Executing "git clone --depth 1 https://github.com/dbt-labs/dbt-utils.git b03949bb53de3439f6a8057088ba4032"
[0m15:27:30.031401 [debug] [MainThread]: STDOUT: "b''"
[0m15:27:30.031744 [debug] [MainThread]: STDERR: "b"fatal: destination path 'b03949bb53de3439f6a8057088ba4032' already exists and is not an empty directory.\n""
[0m15:27:30.031928 [debug] [MainThread]: command return code=128
[0m15:27:30.032685 [debug] [MainThread]: Updating existing dependency b03949bb53de3439f6a8057088ba4032.
[0m15:27:30.032880 [debug] [MainThread]: Executing "git rev-parse HEAD"
[0m15:27:30.036755 [debug] [MainThread]: STDOUT: "b'74a661ca00452da7d2b2811ff1e5a37f152c3ee2\n'"
[0m15:27:30.037227 [debug] [MainThread]: STDERR: "b''"
[0m15:27:30.037431 [debug] [MainThread]: Checking out revision 74a661ca00452da7d2b2811ff1e5a37f152c3ee2.
[0m15:27:30.037629 [debug] [MainThread]: Executing "git fetch origin --depth 1 74a661ca00452da7d2b2811ff1e5a37f152c3ee2"
[0m15:27:31.111766 [debug] [MainThread]: STDOUT: "b''"
[0m15:27:31.112670 [debug] [MainThread]: STDERR: "b'From https://github.com/dbt-labs/dbt-utils\n * branch            74a661ca00452da7d2b2811ff1e5a37f152c3ee2 -> FETCH_HEAD\n'"
[0m15:27:31.113097 [debug] [MainThread]: Executing "git reset --hard 74a661ca00452da7d2b2811ff1e5a37f152c3ee2"
[0m15:27:31.127379 [debug] [MainThread]: STDOUT: "b'HEAD is now at 74a661c Update CHANGELOG for v1.1.1 (#803)\n'"
[0m15:27:31.127942 [debug] [MainThread]: STDERR: "b''"
[0m15:27:31.128234 [debug] [MainThread]: Executing "git rev-parse HEAD"
[0m15:27:31.133351 [debug] [MainThread]: STDOUT: "b'74a661ca00452da7d2b2811ff1e5a37f152c3ee2\n'"
[0m15:27:31.133846 [debug] [MainThread]: STDERR: "b''"
[0m15:27:31.134120 [debug] [MainThread]: Already at 74a661c, nothing to do.
[0m15:27:31.134502 [info ] [MainThread]: Installed from revision 74a661ca00452da7d2b2811ff1e5a37f152c3ee2
[0m15:27:31.134891 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'package', 'label': 'ccde45ae-e463-46df-919e-4ae693feace8', 'property_': 'install', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107a757c0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107b88f10>]}
[0m15:27:31.136464 [debug] [MainThread]: Resource report: {"command_name": "deps", "command_success": true, "command_wall_clock_time": 3.913329, "process_user_time": 0.66319, "process_kernel_time": 0.116319, "process_mem_max_rss": "90456064", "process_in_blocks": "0", "process_out_blocks": "0"}
[0m15:27:31.136924 [debug] [MainThread]: Command `dbt deps` succeeded at 15:27:31.136859 after 3.91 seconds
[0m15:27:31.137221 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104e23790>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107b68ca0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107b88fd0>]}
[0m15:27:31.137479 [debug] [MainThread]: Flushing usage events
[0m15:27:42.345552 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10283b730>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104848580>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104848e20>]}


============================== 15:27:42.348460 | 692d979e-d2b7-4472-90c3-ce4a1c9902d9 ==============================
[0m15:27:42.348460 [info ] [MainThread]: Running with dbt=1.8.1
[0m15:27:42.348886 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'fail_fast': 'False', 'log_path': '/Users/shrikanth/Shrikanth/dbt-helloworld/logs', 'version_check': 'True', 'profiles_dir': '/Users/shrikanth/Shrikanth/dbt-helloworld', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'introspect': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'target_path': 'None', 'invocation_command': 'dbt deps', 'send_anonymous_usage_stats': 'True'}
[0m15:27:42.448651 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '692d979e-d2b7-4472-90c3-ce4a1c9902d9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1047e9340>]}
[0m15:27:42.460484 [debug] [MainThread]: Set downloads directory='/var/folders/ll/3nys2tln7dv4vrs7t9wxvd5w0000gn/T/dbt-downloads-f2ix9zd9'
[0m15:27:42.460793 [info ] [MainThread]: Installing https://github.com/dbt-labs/dbt-utils.git
[0m15:27:42.461085 [debug] [MainThread]: Executing "git clone --depth 1 https://github.com/dbt-labs/dbt-utils.git b03949bb53de3439f6a8057088ba4032"
[0m15:27:43.477063 [debug] [MainThread]: STDOUT: "b''"
[0m15:27:43.477782 [debug] [MainThread]: STDERR: "b"Cloning into 'b03949bb53de3439f6a8057088ba4032'...\n""
[0m15:27:43.478240 [debug] [MainThread]: Pulling new dependency b03949bb53de3439f6a8057088ba4032.
[0m15:27:43.478514 [debug] [MainThread]: Executing "git rev-parse HEAD"
[0m15:27:43.484352 [debug] [MainThread]: STDOUT: "b'fc98e4e30cd299ddd67c43902f2a5efa9511edfb\n'"
[0m15:27:43.484878 [debug] [MainThread]: STDERR: "b''"
[0m15:27:43.485163 [debug] [MainThread]: Checking out revision 74a661ca00452da7d2b2811ff1e5a37f152c3ee2.
[0m15:27:43.485419 [debug] [MainThread]: Executing "git fetch origin --depth 1 74a661ca00452da7d2b2811ff1e5a37f152c3ee2"
[0m15:27:44.787545 [debug] [MainThread]: STDOUT: "b''"
[0m15:27:44.788135 [debug] [MainThread]: STDERR: "b'From https://github.com/dbt-labs/dbt-utils\n * branch            74a661ca00452da7d2b2811ff1e5a37f152c3ee2 -> FETCH_HEAD\n'"
[0m15:27:44.788394 [debug] [MainThread]: Executing "git reset --hard 74a661ca00452da7d2b2811ff1e5a37f152c3ee2"
[0m15:27:44.808795 [debug] [MainThread]: STDOUT: "b'HEAD is now at 74a661c Update CHANGELOG for v1.1.1 (#803)\n'"
[0m15:27:44.809375 [debug] [MainThread]: STDERR: "b''"
[0m15:27:44.809630 [debug] [MainThread]: Executing "git rev-parse HEAD"
[0m15:27:44.815047 [debug] [MainThread]: STDOUT: "b'74a661ca00452da7d2b2811ff1e5a37f152c3ee2\n'"
[0m15:27:44.815541 [debug] [MainThread]: STDERR: "b''"
[0m15:27:44.815773 [debug] [MainThread]: Checked out at 74a661c.
[0m15:27:44.815988 [debug] [MainThread]: Executing "git rev-parse HEAD"
[0m15:27:44.820788 [debug] [MainThread]: STDOUT: "b'74a661ca00452da7d2b2811ff1e5a37f152c3ee2\n'"
[0m15:27:44.821771 [debug] [MainThread]: STDERR: "b''"
[0m15:27:44.822643 [debug] [MainThread]: Executing "git clone --depth 1 https://github.com/dbt-labs/dbt-utils.git b03949bb53de3439f6a8057088ba4032"
[0m15:27:44.827678 [debug] [MainThread]: STDOUT: "b''"
[0m15:27:44.828086 [debug] [MainThread]: STDERR: "b"fatal: destination path 'b03949bb53de3439f6a8057088ba4032' already exists and is not an empty directory.\n""
[0m15:27:44.828272 [debug] [MainThread]: command return code=128
[0m15:27:44.828994 [debug] [MainThread]: Updating existing dependency b03949bb53de3439f6a8057088ba4032.
[0m15:27:44.829186 [debug] [MainThread]: Executing "git rev-parse HEAD"
[0m15:27:44.833412 [debug] [MainThread]: STDOUT: "b'74a661ca00452da7d2b2811ff1e5a37f152c3ee2\n'"
[0m15:27:44.833811 [debug] [MainThread]: STDERR: "b''"
[0m15:27:44.834014 [debug] [MainThread]: Checking out revision 74a661ca00452da7d2b2811ff1e5a37f152c3ee2.
[0m15:27:44.834211 [debug] [MainThread]: Executing "git fetch origin --depth 1 74a661ca00452da7d2b2811ff1e5a37f152c3ee2"
[0m15:27:45.782376 [debug] [MainThread]: STDOUT: "b''"
[0m15:27:45.782960 [debug] [MainThread]: STDERR: "b'From https://github.com/dbt-labs/dbt-utils\n * branch            74a661ca00452da7d2b2811ff1e5a37f152c3ee2 -> FETCH_HEAD\n'"
[0m15:27:45.783223 [debug] [MainThread]: Executing "git reset --hard 74a661ca00452da7d2b2811ff1e5a37f152c3ee2"
[0m15:27:45.794889 [debug] [MainThread]: STDOUT: "b'HEAD is now at 74a661c Update CHANGELOG for v1.1.1 (#803)\n'"
[0m15:27:45.795494 [debug] [MainThread]: STDERR: "b''"
[0m15:27:45.795741 [debug] [MainThread]: Executing "git rev-parse HEAD"
[0m15:27:45.802304 [debug] [MainThread]: STDOUT: "b'74a661ca00452da7d2b2811ff1e5a37f152c3ee2\n'"
[0m15:27:45.803000 [debug] [MainThread]: STDERR: "b''"
[0m15:27:45.803318 [debug] [MainThread]: Already at 74a661c, nothing to do.
[0m15:27:45.803742 [info ] [MainThread]: Installed from revision 74a661ca00452da7d2b2811ff1e5a37f152c3ee2
[0m15:27:45.804491 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'package', 'label': '692d979e-d2b7-4472-90c3-ce4a1c9902d9', 'property_': 'install', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1048dfdc0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1049a6f70>]}
[0m15:27:45.806561 [debug] [MainThread]: Resource report: {"command_name": "deps", "command_success": true, "command_wall_clock_time": 3.4972136, "process_user_time": 0.675557, "process_kernel_time": 0.095836, "process_mem_max_rss": "92192768", "process_in_blocks": "0", "process_out_blocks": "0"}
[0m15:27:45.807068 [debug] [MainThread]: Command `dbt deps` succeeded at 15:27:45.806996 after 3.50 seconds
[0m15:27:45.807368 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10283b730>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10497d2b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104991790>]}
[0m15:27:45.807619 [debug] [MainThread]: Flushing usage events
[0m15:32:13.813602 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10643aa00>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108450e20>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1084506a0>]}


============================== 15:32:13.816211 | c1dadfc8-d03c-479a-a653-9b46a75920e9 ==============================
[0m15:32:13.816211 [info ] [MainThread]: Running with dbt=1.8.1
[0m15:32:13.816636 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'profiles_dir': '/Users/shrikanth/Shrikanth/dbt-helloworld', 'log_path': '/Users/shrikanth/Shrikanth/dbt-helloworld/logs', 'version_check': 'True', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'invocation_command': 'dbt build', 'introspect': 'True', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m15:32:13.973515 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'c1dadfc8-d03c-479a-a653-9b46a75920e9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108771670>]}
[0m15:32:14.001309 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'c1dadfc8-d03c-479a-a653-9b46a75920e9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108942580>]}
[0m15:32:14.001982 [info ] [MainThread]: Registered adapter: postgres=1.8.1
[0m15:32:14.015441 [debug] [MainThread]: checksum: ebc509fb14e151ea268e89b60fd5abf912ed99129f87516462718fa2f14f4838, vars: {}, profile: , target: , version: 1.8.1
[0m15:32:14.016035 [info ] [MainThread]: Unable to do partial parsing because saved manifest not found. Starting full parse.
[0m15:32:14.016318 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': 'c1dadfc8-d03c-479a-a653-9b46a75920e9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108959d00>]}
[0m15:32:14.809052 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'c1dadfc8-d03c-479a-a653-9b46a75920e9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1090eb130>]}
[0m15:32:14.878152 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'c1dadfc8-d03c-479a-a653-9b46a75920e9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1090f1430>]}
[0m15:32:14.878496 [info ] [MainThread]: Found 3 models, 4 data tests, 527 macros
[0m15:32:14.879456 [info ] [MainThread]: 
[0m15:32:14.879807 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m15:32:14.881939 [debug] [ThreadPool]: Acquiring new postgres connection 'list_postgres'
[0m15:32:14.882303 [debug] [ThreadPool]: Acquiring new postgres connection 'list_postgres'
[0m15:32:14.910968 [debug] [ThreadPool]: Using postgres connection "list_postgres"
[0m15:32:14.911268 [debug] [ThreadPool]: Using postgres connection "list_postgres"
[0m15:32:14.911538 [debug] [ThreadPool]: On list_postgres: /* {"app": "dbt", "dbt_version": "1.8.1", "profile_name": "pgmigrate", "target_name": "dev", "connection_name": "list_postgres"} */

    select distinct nspname from pg_namespace
  
[0m15:32:14.911777 [debug] [ThreadPool]: On list_postgres: /* {"app": "dbt", "dbt_version": "1.8.1", "profile_name": "pgmigrate", "target_name": "dev", "connection_name": "list_postgres"} */

    select distinct nspname from pg_namespace
  
[0m15:32:14.912001 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m15:32:14.912209 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m15:32:15.030052 [debug] [ThreadPool]: SQL status: SELECT 18 in 0.0 seconds
[0m15:32:15.030554 [debug] [ThreadPool]: SQL status: SELECT 18 in 0.0 seconds
[0m15:32:15.031815 [debug] [ThreadPool]: On list_postgres: Close
[0m15:32:15.032819 [debug] [ThreadPool]: On list_postgres: Close
[0m15:32:15.034092 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_postgres, now list_postgres_public)
[0m15:32:15.034642 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_postgres, now list_postgres_public__airbyte_quarantine)
[0m15:32:15.040298 [debug] [ThreadPool]: Using postgres connection "list_postgres_public"
[0m15:32:15.042798 [debug] [ThreadPool]: Using postgres connection "list_postgres_public__airbyte_quarantine"
[0m15:32:15.043143 [debug] [ThreadPool]: On list_postgres_public: BEGIN
[0m15:32:15.043459 [debug] [ThreadPool]: On list_postgres_public__airbyte_quarantine: BEGIN
[0m15:32:15.043763 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m15:32:15.044056 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m15:32:15.049680 [debug] [ThreadPool]: SQL status: BEGIN in 0.0 seconds
[0m15:32:15.050003 [debug] [ThreadPool]: SQL status: BEGIN in 0.0 seconds
[0m15:32:15.050339 [debug] [ThreadPool]: Using postgres connection "list_postgres_public__airbyte_quarantine"
[0m15:32:15.050680 [debug] [ThreadPool]: Using postgres connection "list_postgres_public"
[0m15:32:15.051028 [debug] [ThreadPool]: On list_postgres_public__airbyte_quarantine: /* {"app": "dbt", "dbt_version": "1.8.1", "profile_name": "pgmigrate", "target_name": "dev", "connection_name": "list_postgres_public__airbyte_quarantine"} */
select
      'postgres' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public__airbyte_quarantine'
    union all
    select
      'postgres' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public__airbyte_quarantine'
    union all
    select
      'postgres' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public__airbyte_quarantine'
  
[0m15:32:15.051400 [debug] [ThreadPool]: On list_postgres_public: /* {"app": "dbt", "dbt_version": "1.8.1", "profile_name": "pgmigrate", "target_name": "dev", "connection_name": "list_postgres_public"} */
select
      'postgres' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'postgres' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
    union all
    select
      'postgres' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public'
  
[0m15:32:15.058439 [debug] [ThreadPool]: SQL status: SELECT 0 in 0.0 seconds
[0m15:32:15.058779 [debug] [ThreadPool]: SQL status: SELECT 4 in 0.0 seconds
[0m15:32:15.059771 [debug] [ThreadPool]: On list_postgres_public__airbyte_quarantine: ROLLBACK
[0m15:32:15.060846 [debug] [ThreadPool]: On list_postgres_public: ROLLBACK
[0m15:32:15.061367 [debug] [ThreadPool]: On list_postgres_public__airbyte_quarantine: Close
[0m15:32:15.061670 [debug] [ThreadPool]: On list_postgres_public: Close
[0m15:32:15.066034 [debug] [MainThread]: Using postgres connection "master"
[0m15:32:15.066352 [debug] [MainThread]: On master: BEGIN
[0m15:32:15.066630 [debug] [MainThread]: Opening a new connection, currently in state init
[0m15:32:15.071574 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m15:32:15.071889 [debug] [MainThread]: Using postgres connection "master"
[0m15:32:15.072257 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.8.1", "profile_name": "pgmigrate", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m15:32:15.096099 [debug] [MainThread]: SQL status: SELECT 0 in 0.0 seconds
[0m15:32:15.097131 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'c1dadfc8-d03c-479a-a653-9b46a75920e9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x109251d90>]}
[0m15:32:15.097587 [debug] [MainThread]: On master: ROLLBACK
[0m15:32:15.098056 [debug] [MainThread]: Using postgres connection "master"
[0m15:32:15.098394 [debug] [MainThread]: On master: BEGIN
[0m15:32:15.098916 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m15:32:15.099248 [debug] [MainThread]: On master: COMMIT
[0m15:32:15.099573 [debug] [MainThread]: Using postgres connection "master"
[0m15:32:15.099892 [debug] [MainThread]: On master: COMMIT
[0m15:32:15.100296 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m15:32:15.100627 [debug] [MainThread]: On master: Close
[0m15:32:15.101007 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m15:32:15.101334 [info ] [MainThread]: 
[0m15:32:15.102936 [debug] [Thread-1  ]: Began running node model.pgmigrate.my_first_dbt_model
[0m15:32:15.103415 [debug] [Thread-2  ]: Began running node model.pgmigrate.users_dbt_model
[0m15:32:15.103886 [info ] [Thread-1  ]: 1 of 7 START sql table model public.my_first_dbt_model ......................... [RUN]
[0m15:32:15.104347 [info ] [Thread-2  ]: 2 of 7 START sql view model public__airbyte_quarantine.users_scalar ............ [RUN]
[0m15:32:15.104772 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly list_postgres_public, now model.pgmigrate.my_first_dbt_model)
[0m15:32:15.105168 [debug] [Thread-2  ]: Re-using an available connection from the pool (formerly list_postgres_public__airbyte_quarantine, now model.pgmigrate.users_dbt_model)
[0m15:32:15.105528 [debug] [Thread-1  ]: Began compiling node model.pgmigrate.my_first_dbt_model
[0m15:32:15.105875 [debug] [Thread-2  ]: Began compiling node model.pgmigrate.users_dbt_model
[0m15:32:15.112587 [debug] [Thread-1  ]: Writing injected SQL for node "model.pgmigrate.my_first_dbt_model"
[0m15:32:15.118085 [debug] [Thread-1  ]: Began executing node model.pgmigrate.my_first_dbt_model
[0m15:32:15.145495 [debug] [Thread-1  ]: Writing runtime sql for node "model.pgmigrate.my_first_dbt_model"
[0m15:32:15.146309 [debug] [Thread-1  ]: Using postgres connection "model.pgmigrate.my_first_dbt_model"
[0m15:32:15.146670 [debug] [Thread-1  ]: On model.pgmigrate.my_first_dbt_model: BEGIN
[0m15:32:15.146992 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m15:32:15.149344 [debug] [Thread-2  ]: Compilation Error in model users_dbt_model (models/example/users_dbt_model.sql)
  'json_extract_scalar' is undefined. This can happen when calling a macro that does not exist. Check for typos and/or install package dependencies with "dbt deps".
[0m15:32:15.150297 [debug] [Thread-2  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'c1dadfc8-d03c-479a-a653-9b46a75920e9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107880a90>]}
[0m15:32:15.150729 [error] [Thread-2  ]: 2 of 7 ERROR creating sql view model public__airbyte_quarantine.users_scalar ... [[31mERROR[0m in 0.04s]
[0m15:32:15.151133 [debug] [Thread-2  ]: Finished running node model.pgmigrate.users_dbt_model
[0m15:32:15.151387 [debug] [Thread-1  ]: SQL status: BEGIN in 0.0 seconds
[0m15:32:15.151767 [debug] [Thread-1  ]: Using postgres connection "model.pgmigrate.my_first_dbt_model"
[0m15:32:15.152040 [debug] [Thread-1  ]: On model.pgmigrate.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.8.1", "profile_name": "pgmigrate", "target_name": "dev", "node_id": "model.pgmigrate.my_first_dbt_model"} */

  
    

  create  table "postgres"."public"."my_first_dbt_model__dbt_tmp"
  
  
    as
  
  (
    /*
    Welcome to your first dbt model!
    Did you know that you can also configure models directly within SQL files?
    This will override configurations stated in dbt_project.yml

    Try changing "table" to "view" below
*/



with source_data as (

    select 1 as id
    union all
    select null as id

)

select *
from source_data

/*
    Uncomment the line below to remove records with null `id` values
*/

-- where id is not null
  );
  
[0m15:32:15.158442 [debug] [Thread-1  ]: SQL status: SELECT 2 in 0.0 seconds
[0m15:32:15.162877 [debug] [Thread-1  ]: Using postgres connection "model.pgmigrate.my_first_dbt_model"
[0m15:32:15.163174 [debug] [Thread-1  ]: On model.pgmigrate.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.8.1", "profile_name": "pgmigrate", "target_name": "dev", "node_id": "model.pgmigrate.my_first_dbt_model"} */
alter table "postgres"."public"."my_first_dbt_model" rename to "my_first_dbt_model__dbt_backup"
[0m15:32:15.163951 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.0 seconds
[0m15:32:15.165941 [debug] [Thread-1  ]: Using postgres connection "model.pgmigrate.my_first_dbt_model"
[0m15:32:15.166200 [debug] [Thread-1  ]: On model.pgmigrate.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.8.1", "profile_name": "pgmigrate", "target_name": "dev", "node_id": "model.pgmigrate.my_first_dbt_model"} */
alter table "postgres"."public"."my_first_dbt_model__dbt_tmp" rename to "my_first_dbt_model"
[0m15:32:15.166905 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.0 seconds
[0m15:32:15.180012 [debug] [Thread-1  ]: On model.pgmigrate.my_first_dbt_model: COMMIT
[0m15:32:15.180361 [debug] [Thread-1  ]: Using postgres connection "model.pgmigrate.my_first_dbt_model"
[0m15:32:15.180616 [debug] [Thread-1  ]: On model.pgmigrate.my_first_dbt_model: COMMIT
[0m15:32:15.181603 [debug] [Thread-1  ]: SQL status: COMMIT in 0.0 seconds
[0m15:32:15.185658 [debug] [Thread-1  ]: Applying DROP to: "postgres"."public"."my_first_dbt_model__dbt_backup"
[0m15:32:15.188301 [debug] [Thread-1  ]: Using postgres connection "model.pgmigrate.my_first_dbt_model"
[0m15:32:15.188581 [debug] [Thread-1  ]: On model.pgmigrate.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.8.1", "profile_name": "pgmigrate", "target_name": "dev", "node_id": "model.pgmigrate.my_first_dbt_model"} */
drop table if exists "postgres"."public"."my_first_dbt_model__dbt_backup" cascade
[0m15:32:15.199601 [debug] [Thread-1  ]: SQL status: DROP TABLE in 0.0 seconds
[0m15:32:15.201150 [debug] [Thread-1  ]: On model.pgmigrate.my_first_dbt_model: Close
[0m15:32:15.201536 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'c1dadfc8-d03c-479a-a653-9b46a75920e9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10964b8b0>]}
[0m15:32:15.201947 [info ] [Thread-1  ]: 1 of 7 OK created sql table model public.my_first_dbt_model .................... [[32mSELECT 2[0m in 0.10s]
[0m15:32:15.202329 [debug] [Thread-1  ]: Finished running node model.pgmigrate.my_first_dbt_model
[0m15:32:15.202800 [debug] [Thread-4  ]: Began running node test.pgmigrate.not_null_my_first_dbt_model_id.5fb22c2710
[0m15:32:15.203100 [debug] [Thread-3  ]: Began running node test.pgmigrate.unique_my_first_dbt_model_id.16e066b321
[0m15:32:15.203434 [info ] [Thread-4  ]: 3 of 7 START test not_null_my_first_dbt_model_id ............................... [RUN]
[0m15:32:15.203720 [info ] [Thread-3  ]: 4 of 7 START test unique_my_first_dbt_model_id ................................. [RUN]
[0m15:32:15.204073 [debug] [Thread-4  ]: Acquiring new postgres connection 'test.pgmigrate.not_null_my_first_dbt_model_id.5fb22c2710'
[0m15:32:15.204388 [debug] [Thread-3  ]: Acquiring new postgres connection 'test.pgmigrate.unique_my_first_dbt_model_id.16e066b321'
[0m15:32:15.204638 [debug] [Thread-4  ]: Began compiling node test.pgmigrate.not_null_my_first_dbt_model_id.5fb22c2710
[0m15:32:15.204907 [debug] [Thread-3  ]: Began compiling node test.pgmigrate.unique_my_first_dbt_model_id.16e066b321
[0m15:32:15.212550 [debug] [Thread-4  ]: Writing injected SQL for node "test.pgmigrate.not_null_my_first_dbt_model_id.5fb22c2710"
[0m15:32:15.217613 [debug] [Thread-3  ]: Writing injected SQL for node "test.pgmigrate.unique_my_first_dbt_model_id.16e066b321"
[0m15:32:15.218164 [debug] [Thread-4  ]: Began executing node test.pgmigrate.not_null_my_first_dbt_model_id.5fb22c2710
[0m15:32:15.218424 [debug] [Thread-3  ]: Began executing node test.pgmigrate.unique_my_first_dbt_model_id.16e066b321
[0m15:32:15.226871 [debug] [Thread-4  ]: Writing runtime sql for node "test.pgmigrate.not_null_my_first_dbt_model_id.5fb22c2710"
[0m15:32:15.228472 [debug] [Thread-3  ]: Writing runtime sql for node "test.pgmigrate.unique_my_first_dbt_model_id.16e066b321"
[0m15:32:15.228982 [debug] [Thread-3  ]: Using postgres connection "test.pgmigrate.unique_my_first_dbt_model_id.16e066b321"
[0m15:32:15.229255 [debug] [Thread-4  ]: Using postgres connection "test.pgmigrate.not_null_my_first_dbt_model_id.5fb22c2710"
[0m15:32:15.229485 [debug] [Thread-3  ]: On test.pgmigrate.unique_my_first_dbt_model_id.16e066b321: BEGIN
[0m15:32:15.229732 [debug] [Thread-4  ]: On test.pgmigrate.not_null_my_first_dbt_model_id.5fb22c2710: BEGIN
[0m15:32:15.229972 [debug] [Thread-3  ]: Opening a new connection, currently in state init
[0m15:32:15.230198 [debug] [Thread-4  ]: Opening a new connection, currently in state init
[0m15:32:15.235635 [debug] [Thread-3  ]: SQL status: BEGIN in 0.0 seconds
[0m15:32:15.235865 [debug] [Thread-4  ]: SQL status: BEGIN in 0.0 seconds
[0m15:32:15.236130 [debug] [Thread-3  ]: Using postgres connection "test.pgmigrate.unique_my_first_dbt_model_id.16e066b321"
[0m15:32:15.236371 [debug] [Thread-4  ]: Using postgres connection "test.pgmigrate.not_null_my_first_dbt_model_id.5fb22c2710"
[0m15:32:15.236620 [debug] [Thread-3  ]: On test.pgmigrate.unique_my_first_dbt_model_id.16e066b321: /* {"app": "dbt", "dbt_version": "1.8.1", "profile_name": "pgmigrate", "target_name": "dev", "node_id": "test.pgmigrate.unique_my_first_dbt_model_id.16e066b321"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

select
    id as unique_field,
    count(*) as n_records

from "postgres"."public"."my_first_dbt_model"
where id is not null
group by id
having count(*) > 1



      
    ) dbt_internal_test
[0m15:32:15.236879 [debug] [Thread-4  ]: On test.pgmigrate.not_null_my_first_dbt_model_id.5fb22c2710: /* {"app": "dbt", "dbt_version": "1.8.1", "profile_name": "pgmigrate", "target_name": "dev", "node_id": "test.pgmigrate.not_null_my_first_dbt_model_id.5fb22c2710"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select id
from "postgres"."public"."my_first_dbt_model"
where id is null



      
    ) dbt_internal_test
[0m15:32:15.240155 [debug] [Thread-4  ]: SQL status: SELECT 1 in 0.0 seconds
[0m15:32:15.240394 [debug] [Thread-3  ]: SQL status: SELECT 1 in 0.0 seconds
[0m15:32:15.242487 [debug] [Thread-4  ]: On test.pgmigrate.not_null_my_first_dbt_model_id.5fb22c2710: ROLLBACK
[0m15:32:15.243443 [debug] [Thread-3  ]: On test.pgmigrate.unique_my_first_dbt_model_id.16e066b321: ROLLBACK
[0m15:32:15.243899 [debug] [Thread-3  ]: On test.pgmigrate.unique_my_first_dbt_model_id.16e066b321: Close
[0m15:32:15.244158 [debug] [Thread-4  ]: On test.pgmigrate.not_null_my_first_dbt_model_id.5fb22c2710: Close
[0m15:32:15.244524 [info ] [Thread-3  ]: 4 of 7 PASS unique_my_first_dbt_model_id ....................................... [[32mPASS[0m in 0.04s]
[0m15:32:15.244946 [error] [Thread-4  ]: 3 of 7 FAIL 1 not_null_my_first_dbt_model_id ................................... [[31mFAIL 1[0m in 0.04s]
[0m15:32:15.245334 [debug] [Thread-3  ]: Finished running node test.pgmigrate.unique_my_first_dbt_model_id.16e066b321
[0m15:32:15.245668 [debug] [Thread-4  ]: Finished running node test.pgmigrate.not_null_my_first_dbt_model_id.5fb22c2710
[0m15:32:15.246170 [debug] [Thread-1  ]: Began running node model.pgmigrate.my_second_dbt_model
[0m15:32:15.246441 [info ] [Thread-1  ]: 5 of 7 SKIP relation public.my_second_dbt_model ................................ [[33mSKIP[0m]
[0m15:32:15.246735 [debug] [Thread-1  ]: Finished running node model.pgmigrate.my_second_dbt_model
[0m15:32:15.247241 [debug] [Thread-3  ]: Began running node test.pgmigrate.not_null_my_second_dbt_model_id.151b76d778
[0m15:32:15.247521 [debug] [Thread-4  ]: Began running node test.pgmigrate.unique_my_second_dbt_model_id.57a0f8c493
[0m15:32:15.247765 [info ] [Thread-3  ]: 6 of 7 SKIP test not_null_my_second_dbt_model_id ............................... [[33mSKIP[0m]
[0m15:32:15.248063 [info ] [Thread-4  ]: 7 of 7 SKIP test unique_my_second_dbt_model_id ................................. [[33mSKIP[0m]
[0m15:32:15.248352 [debug] [Thread-3  ]: Finished running node test.pgmigrate.not_null_my_second_dbt_model_id.151b76d778
[0m15:32:15.248596 [debug] [Thread-4  ]: Finished running node test.pgmigrate.unique_my_second_dbt_model_id.57a0f8c493
[0m15:32:15.249249 [debug] [MainThread]: Using postgres connection "master"
[0m15:32:15.249450 [debug] [MainThread]: On master: BEGIN
[0m15:32:15.249639 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m15:32:15.254307 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m15:32:15.254545 [debug] [MainThread]: On master: COMMIT
[0m15:32:15.254758 [debug] [MainThread]: Using postgres connection "master"
[0m15:32:15.254958 [debug] [MainThread]: On master: COMMIT
[0m15:32:15.255265 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m15:32:15.255500 [debug] [MainThread]: On master: Close
[0m15:32:15.255774 [debug] [MainThread]: Connection 'master' was properly closed.
[0m15:32:15.255985 [debug] [MainThread]: Connection 'model.pgmigrate.my_first_dbt_model' was properly closed.
[0m15:32:15.256175 [debug] [MainThread]: Connection 'model.pgmigrate.users_dbt_model' was properly closed.
[0m15:32:15.256367 [debug] [MainThread]: Connection 'test.pgmigrate.not_null_my_first_dbt_model_id.5fb22c2710' was properly closed.
[0m15:32:15.256573 [debug] [MainThread]: Connection 'test.pgmigrate.unique_my_first_dbt_model_id.16e066b321' was properly closed.
[0m15:32:15.256830 [info ] [MainThread]: 
[0m15:32:15.257082 [info ] [MainThread]: Finished running 2 view models, 1 table model, 4 data tests in 0 hours 0 minutes and 0.38 seconds (0.38s).
[0m15:32:15.257714 [debug] [MainThread]: Command end result
[0m15:32:15.278111 [info ] [MainThread]: 
[0m15:32:15.278483 [info ] [MainThread]: [31mCompleted with 2 errors and 0 warnings:[0m
[0m15:32:15.278715 [info ] [MainThread]: 
[0m15:32:15.278995 [error] [MainThread]:   Compilation Error in model users_dbt_model (models/example/users_dbt_model.sql)
  'json_extract_scalar' is undefined. This can happen when calling a macro that does not exist. Check for typos and/or install package dependencies with "dbt deps".
[0m15:32:15.279222 [info ] [MainThread]: 
[0m15:32:15.279489 [error] [MainThread]: [31mFailure in test not_null_my_first_dbt_model_id (models/example/schema.yml)[0m
[0m15:32:15.279732 [error] [MainThread]:   Got 1 result, configured to fail if != 0
[0m15:32:15.279940 [info ] [MainThread]: 
[0m15:32:15.280178 [info ] [MainThread]:   compiled code at target/compiled/pgmigrate/models/example/schema.yml/not_null_my_first_dbt_model_id.sql
[0m15:32:15.280393 [info ] [MainThread]: 
[0m15:32:15.280614 [info ] [MainThread]: Done. PASS=2 WARN=0 ERROR=2 SKIP=3 TOTAL=7
[0m15:32:15.282055 [debug] [MainThread]: Resource report: {"command_name": "build", "command_wall_clock_time": 1.5071626, "process_user_time": 1.718735, "process_kernel_time": 0.141077, "process_mem_max_rss": "121028608", "command_success": false, "process_in_blocks": "0", "process_out_blocks": "0"}
[0m15:32:15.282383 [debug] [MainThread]: Command `dbt build` failed at 15:32:15.282338 after 1.51 seconds
[0m15:32:15.282634 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10643aa00>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107e2b3d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10969af70>]}
[0m15:32:15.282870 [debug] [MainThread]: Flushing usage events
[0m15:42:24.927725 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106e87a90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1112e0d60>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1112e05e0>]}


============================== 15:42:24.930836 | bca7db00-b54f-4f80-b444-084c9198c76f ==============================
[0m15:42:24.930836 [info ] [MainThread]: Running with dbt=1.8.1
[0m15:42:24.931243 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'profiles_dir': '/Users/shrikanth/Shrikanth/dbt-helloworld', 'log_path': '/Users/shrikanth/Shrikanth/dbt-helloworld/logs', 'debug': 'False', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'introspect': 'True', 'log_format': 'default', 'target_path': 'None', 'invocation_command': 'dbt run', 'send_anonymous_usage_stats': 'True'}
[0m15:42:25.102773 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'bca7db00-b54f-4f80-b444-084c9198c76f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x110cfd370>]}
[0m15:42:25.132013 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'bca7db00-b54f-4f80-b444-084c9198c76f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1112555b0>]}
[0m15:42:25.132771 [info ] [MainThread]: Registered adapter: postgres=1.8.1
[0m15:42:25.145078 [debug] [MainThread]: checksum: ebc509fb14e151ea268e89b60fd5abf912ed99129f87516462718fa2f14f4838, vars: {}, profile: , target: , version: 1.8.1
[0m15:42:25.145730 [info ] [MainThread]: Unable to do partial parsing because saved manifest not found. Starting full parse.
[0m15:42:25.146727 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': 'bca7db00-b54f-4f80-b444-084c9198c76f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1117a5970>]}
[0m15:42:25.892980 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'bca7db00-b54f-4f80-b444-084c9198c76f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1118bea30>]}
[0m15:42:25.956044 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'bca7db00-b54f-4f80-b444-084c9198c76f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x111841be0>]}
[0m15:42:25.956456 [info ] [MainThread]: Found 3 models, 4 data tests, 413 macros
[0m15:42:25.956713 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'bca7db00-b54f-4f80-b444-084c9198c76f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1117d5fa0>]}
[0m15:42:25.957497 [info ] [MainThread]: 
[0m15:42:25.957852 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m15:42:25.960148 [debug] [ThreadPool]: Acquiring new postgres connection 'list_postgres'
[0m15:42:25.960546 [debug] [ThreadPool]: Acquiring new postgres connection 'list_postgres'
[0m15:42:25.994141 [debug] [ThreadPool]: Using postgres connection "list_postgres"
[0m15:42:25.994483 [debug] [ThreadPool]: Using postgres connection "list_postgres"
[0m15:42:25.994707 [debug] [ThreadPool]: On list_postgres: /* {"app": "dbt", "dbt_version": "1.8.1", "profile_name": "pgmigrate", "target_name": "dev", "connection_name": "list_postgres"} */

    select distinct nspname from pg_namespace
  
[0m15:42:25.994938 [debug] [ThreadPool]: On list_postgres: /* {"app": "dbt", "dbt_version": "1.8.1", "profile_name": "pgmigrate", "target_name": "dev", "connection_name": "list_postgres"} */

    select distinct nspname from pg_namespace
  
[0m15:42:25.995160 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m15:42:25.995378 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m15:42:26.083657 [debug] [ThreadPool]: SQL status: SELECT 18 in 0.0 seconds
[0m15:42:26.084013 [debug] [ThreadPool]: SQL status: SELECT 18 in 0.0 seconds
[0m15:42:26.084892 [debug] [ThreadPool]: On list_postgres: Close
[0m15:42:26.085640 [debug] [ThreadPool]: On list_postgres: Close
[0m15:42:26.086629 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_postgres, now list_postgres_public)
[0m15:42:26.086988 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_postgres, now list_postgres_public__airbyte_quarantine)
[0m15:42:26.090806 [debug] [ThreadPool]: Using postgres connection "list_postgres_public"
[0m15:42:26.092232 [debug] [ThreadPool]: Using postgres connection "list_postgres_public__airbyte_quarantine"
[0m15:42:26.092505 [debug] [ThreadPool]: On list_postgres_public: BEGIN
[0m15:42:26.092927 [debug] [ThreadPool]: On list_postgres_public__airbyte_quarantine: BEGIN
[0m15:42:26.093629 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m15:42:26.094217 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m15:42:26.100918 [debug] [ThreadPool]: SQL status: BEGIN in 0.0 seconds
[0m15:42:26.101230 [debug] [ThreadPool]: SQL status: BEGIN in 0.0 seconds
[0m15:42:26.101495 [debug] [ThreadPool]: Using postgres connection "list_postgres_public"
[0m15:42:26.101725 [debug] [ThreadPool]: Using postgres connection "list_postgres_public__airbyte_quarantine"
[0m15:42:26.101968 [debug] [ThreadPool]: On list_postgres_public: /* {"app": "dbt", "dbt_version": "1.8.1", "profile_name": "pgmigrate", "target_name": "dev", "connection_name": "list_postgres_public"} */
select
      'postgres' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'postgres' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
    union all
    select
      'postgres' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public'
  
[0m15:42:26.102229 [debug] [ThreadPool]: On list_postgres_public__airbyte_quarantine: /* {"app": "dbt", "dbt_version": "1.8.1", "profile_name": "pgmigrate", "target_name": "dev", "connection_name": "list_postgres_public__airbyte_quarantine"} */
select
      'postgres' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public__airbyte_quarantine'
    union all
    select
      'postgres' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public__airbyte_quarantine'
    union all
    select
      'postgres' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public__airbyte_quarantine'
  
[0m15:42:26.105852 [debug] [ThreadPool]: SQL status: SELECT 0 in 0.0 seconds
[0m15:42:26.106432 [debug] [ThreadPool]: SQL status: SELECT 5 in 0.0 seconds
[0m15:42:26.108250 [debug] [ThreadPool]: On list_postgres_public__airbyte_quarantine: ROLLBACK
[0m15:42:26.109883 [debug] [ThreadPool]: On list_postgres_public: ROLLBACK
[0m15:42:26.110504 [debug] [ThreadPool]: On list_postgres_public__airbyte_quarantine: Close
[0m15:42:26.110993 [debug] [ThreadPool]: On list_postgres_public: Close
[0m15:42:26.116238 [debug] [MainThread]: Using postgres connection "master"
[0m15:42:26.116572 [debug] [MainThread]: On master: BEGIN
[0m15:42:26.116794 [debug] [MainThread]: Opening a new connection, currently in state init
[0m15:42:26.121025 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m15:42:26.121287 [debug] [MainThread]: Using postgres connection "master"
[0m15:42:26.121584 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.8.1", "profile_name": "pgmigrate", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m15:42:26.151348 [debug] [MainThread]: SQL status: SELECT 1 in 0.0 seconds
[0m15:42:26.152423 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'bca7db00-b54f-4f80-b444-084c9198c76f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x111841970>]}
[0m15:42:26.152750 [debug] [MainThread]: On master: ROLLBACK
[0m15:42:26.153116 [debug] [MainThread]: Using postgres connection "master"
[0m15:42:26.153335 [debug] [MainThread]: On master: BEGIN
[0m15:42:26.153722 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m15:42:26.153935 [debug] [MainThread]: On master: COMMIT
[0m15:42:26.154139 [debug] [MainThread]: Using postgres connection "master"
[0m15:42:26.154340 [debug] [MainThread]: On master: COMMIT
[0m15:42:26.154625 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m15:42:26.154836 [debug] [MainThread]: On master: Close
[0m15:42:26.155137 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m15:42:26.155367 [info ] [MainThread]: 
[0m15:42:26.156827 [debug] [Thread-1  ]: Began running node model.pgmigrate.my_first_dbt_model
[0m15:42:26.157131 [debug] [Thread-2  ]: Began running node model.pgmigrate.users_dbt_model
[0m15:42:26.157464 [info ] [Thread-1  ]: 1 of 3 START sql table model public.my_first_dbt_model ......................... [RUN]
[0m15:42:26.157798 [info ] [Thread-2  ]: 2 of 3 START sql view model public__airbyte_quarantine.users_scalar ............ [RUN]
[0m15:42:26.158114 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly list_postgres_public, now model.pgmigrate.my_first_dbt_model)
[0m15:42:26.158374 [debug] [Thread-2  ]: Re-using an available connection from the pool (formerly list_postgres_public__airbyte_quarantine, now model.pgmigrate.users_dbt_model)
[0m15:42:26.158619 [debug] [Thread-1  ]: Began compiling node model.pgmigrate.my_first_dbt_model
[0m15:42:26.158853 [debug] [Thread-2  ]: Began compiling node model.pgmigrate.users_dbt_model
[0m15:42:26.163771 [debug] [Thread-1  ]: Writing injected SQL for node "model.pgmigrate.my_first_dbt_model"
[0m15:42:26.169889 [debug] [Thread-1  ]: Began executing node model.pgmigrate.my_first_dbt_model
[0m15:42:26.193883 [debug] [Thread-1  ]: Writing runtime sql for node "model.pgmigrate.my_first_dbt_model"
[0m15:42:26.194747 [debug] [Thread-1  ]: Using postgres connection "model.pgmigrate.my_first_dbt_model"
[0m15:42:26.195078 [debug] [Thread-1  ]: On model.pgmigrate.my_first_dbt_model: BEGIN
[0m15:42:26.195467 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m15:42:26.198246 [debug] [Thread-2  ]: Compilation Error in model users_dbt_model (models/example/users_dbt_model.sql)
  'jsonb_extract_path_text' is undefined. This can happen when calling a macro that does not exist. Check for typos and/or install package dependencies with "dbt deps".
[0m15:42:26.199346 [debug] [Thread-2  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'bca7db00-b54f-4f80-b444-084c9198c76f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x111d584f0>]}
[0m15:42:26.199863 [error] [Thread-2  ]: 2 of 3 ERROR creating sql view model public__airbyte_quarantine.users_scalar ... [[31mERROR[0m in 0.04s]
[0m15:42:26.200330 [debug] [Thread-2  ]: Finished running node model.pgmigrate.users_dbt_model
[0m15:42:26.201277 [debug] [Thread-1  ]: SQL status: BEGIN in 0.0 seconds
[0m15:42:26.201556 [debug] [Thread-1  ]: Using postgres connection "model.pgmigrate.my_first_dbt_model"
[0m15:42:26.202294 [debug] [Thread-1  ]: On model.pgmigrate.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.8.1", "profile_name": "pgmigrate", "target_name": "dev", "node_id": "model.pgmigrate.my_first_dbt_model"} */

  
    

  create  table "postgres"."public"."my_first_dbt_model__dbt_tmp"
  
  
    as
  
  (
    /*
    Welcome to your first dbt model!
    Did you know that you can also configure models directly within SQL files?
    This will override configurations stated in dbt_project.yml

    Try changing "table" to "view" below
*/



with source_data as (

    select 1 as id
    union all
    select null as id

)

select *
from source_data

/*
    Uncomment the line below to remove records with null `id` values
*/

-- where id is not null
  );
  
[0m15:42:26.204432 [debug] [Thread-1  ]: SQL status: SELECT 2 in 0.0 seconds
[0m15:42:26.210144 [debug] [Thread-1  ]: Using postgres connection "model.pgmigrate.my_first_dbt_model"
[0m15:42:26.210609 [debug] [Thread-1  ]: On model.pgmigrate.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.8.1", "profile_name": "pgmigrate", "target_name": "dev", "node_id": "model.pgmigrate.my_first_dbt_model"} */
alter table "postgres"."public"."my_first_dbt_model" rename to "my_first_dbt_model__dbt_backup"
[0m15:42:26.211596 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.0 seconds
[0m15:42:26.215636 [debug] [Thread-1  ]: Using postgres connection "model.pgmigrate.my_first_dbt_model"
[0m15:42:26.216714 [debug] [Thread-1  ]: On model.pgmigrate.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.8.1", "profile_name": "pgmigrate", "target_name": "dev", "node_id": "model.pgmigrate.my_first_dbt_model"} */
alter table "postgres"."public"."my_first_dbt_model__dbt_tmp" rename to "my_first_dbt_model"
[0m15:42:26.220421 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.0 seconds
[0m15:42:26.233531 [debug] [Thread-1  ]: On model.pgmigrate.my_first_dbt_model: COMMIT
[0m15:42:26.233911 [debug] [Thread-1  ]: Using postgres connection "model.pgmigrate.my_first_dbt_model"
[0m15:42:26.234226 [debug] [Thread-1  ]: On model.pgmigrate.my_first_dbt_model: COMMIT
[0m15:42:26.234901 [debug] [Thread-1  ]: SQL status: COMMIT in 0.0 seconds
[0m15:42:26.239853 [debug] [Thread-1  ]: Applying DROP to: "postgres"."public"."my_first_dbt_model__dbt_backup"
[0m15:42:26.244365 [debug] [Thread-1  ]: Using postgres connection "model.pgmigrate.my_first_dbt_model"
[0m15:42:26.244699 [debug] [Thread-1  ]: On model.pgmigrate.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.8.1", "profile_name": "pgmigrate", "target_name": "dev", "node_id": "model.pgmigrate.my_first_dbt_model"} */
drop table if exists "postgres"."public"."my_first_dbt_model__dbt_backup" cascade
[0m15:42:26.248274 [debug] [Thread-1  ]: SQL status: DROP TABLE in 0.0 seconds
[0m15:42:26.250174 [debug] [Thread-1  ]: On model.pgmigrate.my_first_dbt_model: Close
[0m15:42:26.250559 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'bca7db00-b54f-4f80-b444-084c9198c76f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11228a8b0>]}
[0m15:42:26.251038 [info ] [Thread-1  ]: 1 of 3 OK created sql table model public.my_first_dbt_model .................... [[32mSELECT 2[0m in 0.09s]
[0m15:42:26.251438 [debug] [Thread-1  ]: Finished running node model.pgmigrate.my_first_dbt_model
[0m15:42:26.252245 [debug] [Thread-4  ]: Began running node model.pgmigrate.my_second_dbt_model
[0m15:42:26.252860 [info ] [Thread-4  ]: 3 of 3 START sql view model public.my_second_dbt_model ......................... [RUN]
[0m15:42:26.253374 [debug] [Thread-4  ]: Acquiring new postgres connection 'model.pgmigrate.my_second_dbt_model'
[0m15:42:26.253796 [debug] [Thread-4  ]: Began compiling node model.pgmigrate.my_second_dbt_model
[0m15:42:26.255618 [debug] [Thread-4  ]: Writing injected SQL for node "model.pgmigrate.my_second_dbt_model"
[0m15:42:26.256049 [debug] [Thread-4  ]: Began executing node model.pgmigrate.my_second_dbt_model
[0m15:42:26.271397 [debug] [Thread-4  ]: Writing runtime sql for node "model.pgmigrate.my_second_dbt_model"
[0m15:42:26.272052 [debug] [Thread-4  ]: Using postgres connection "model.pgmigrate.my_second_dbt_model"
[0m15:42:26.272404 [debug] [Thread-4  ]: On model.pgmigrate.my_second_dbt_model: BEGIN
[0m15:42:26.272692 [debug] [Thread-4  ]: Opening a new connection, currently in state init
[0m15:42:26.277017 [debug] [Thread-4  ]: SQL status: BEGIN in 0.0 seconds
[0m15:42:26.277323 [debug] [Thread-4  ]: Using postgres connection "model.pgmigrate.my_second_dbt_model"
[0m15:42:26.277580 [debug] [Thread-4  ]: On model.pgmigrate.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "1.8.1", "profile_name": "pgmigrate", "target_name": "dev", "node_id": "model.pgmigrate.my_second_dbt_model"} */

  create view "postgres"."public"."my_second_dbt_model__dbt_tmp"
    
    
  as (
    -- Use the `ref` function to select from other models

select *
from "postgres"."public"."my_first_dbt_model"
where id = 1
  );
[0m15:42:26.279923 [debug] [Thread-4  ]: SQL status: CREATE VIEW in 0.0 seconds
[0m15:42:26.282091 [debug] [Thread-4  ]: Using postgres connection "model.pgmigrate.my_second_dbt_model"
[0m15:42:26.282370 [debug] [Thread-4  ]: On model.pgmigrate.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "1.8.1", "profile_name": "pgmigrate", "target_name": "dev", "node_id": "model.pgmigrate.my_second_dbt_model"} */
alter table "postgres"."public"."my_second_dbt_model__dbt_tmp" rename to "my_second_dbt_model"
[0m15:42:26.283183 [debug] [Thread-4  ]: SQL status: ALTER TABLE in 0.0 seconds
[0m15:42:26.284166 [debug] [Thread-4  ]: On model.pgmigrate.my_second_dbt_model: COMMIT
[0m15:42:26.284424 [debug] [Thread-4  ]: Using postgres connection "model.pgmigrate.my_second_dbt_model"
[0m15:42:26.284659 [debug] [Thread-4  ]: On model.pgmigrate.my_second_dbt_model: COMMIT
[0m15:42:26.285203 [debug] [Thread-4  ]: SQL status: COMMIT in 0.0 seconds
[0m15:42:26.286779 [debug] [Thread-4  ]: Applying DROP to: "postgres"."public"."my_second_dbt_model__dbt_backup"
[0m15:42:26.288428 [debug] [Thread-4  ]: Using postgres connection "model.pgmigrate.my_second_dbt_model"
[0m15:42:26.288697 [debug] [Thread-4  ]: On model.pgmigrate.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "1.8.1", "profile_name": "pgmigrate", "target_name": "dev", "node_id": "model.pgmigrate.my_second_dbt_model"} */
drop view if exists "postgres"."public"."my_second_dbt_model__dbt_backup" cascade
[0m15:42:26.289195 [debug] [Thread-4  ]: SQL status: DROP VIEW in 0.0 seconds
[0m15:42:26.289994 [debug] [Thread-4  ]: On model.pgmigrate.my_second_dbt_model: Close
[0m15:42:26.290376 [debug] [Thread-4  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'bca7db00-b54f-4f80-b444-084c9198c76f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11228a220>]}
[0m15:42:26.290782 [info ] [Thread-4  ]: 3 of 3 OK created sql view model public.my_second_dbt_model .................... [[32mCREATE VIEW[0m in 0.04s]
[0m15:42:26.291185 [debug] [Thread-4  ]: Finished running node model.pgmigrate.my_second_dbt_model
[0m15:42:26.292092 [debug] [MainThread]: Using postgres connection "master"
[0m15:42:26.292321 [debug] [MainThread]: On master: BEGIN
[0m15:42:26.292526 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m15:42:26.296269 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m15:42:26.296502 [debug] [MainThread]: On master: COMMIT
[0m15:42:26.296714 [debug] [MainThread]: Using postgres connection "master"
[0m15:42:26.296923 [debug] [MainThread]: On master: COMMIT
[0m15:42:26.297228 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m15:42:26.297440 [debug] [MainThread]: On master: Close
[0m15:42:26.297967 [debug] [MainThread]: Connection 'master' was properly closed.
[0m15:42:26.298640 [debug] [MainThread]: Connection 'model.pgmigrate.my_first_dbt_model' was properly closed.
[0m15:42:26.299183 [debug] [MainThread]: Connection 'model.pgmigrate.users_dbt_model' was properly closed.
[0m15:42:26.299774 [debug] [MainThread]: Connection 'model.pgmigrate.my_second_dbt_model' was properly closed.
[0m15:42:26.300416 [info ] [MainThread]: 
[0m15:42:26.300991 [info ] [MainThread]: Finished running 2 view models, 1 table model in 0 hours 0 minutes and 0.34 seconds (0.34s).
[0m15:42:26.301576 [debug] [MainThread]: Command end result
[0m15:42:26.319418 [info ] [MainThread]: 
[0m15:42:26.319785 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m15:42:26.320023 [info ] [MainThread]: 
[0m15:42:26.320302 [error] [MainThread]:   Compilation Error in model users_dbt_model (models/example/users_dbt_model.sql)
  'jsonb_extract_path_text' is undefined. This can happen when calling a macro that does not exist. Check for typos and/or install package dependencies with "dbt deps".
[0m15:42:26.320534 [info ] [MainThread]: 
[0m15:42:26.320772 [info ] [MainThread]: Done. PASS=2 WARN=0 ERROR=1 SKIP=0 TOTAL=3
[0m15:42:26.322349 [debug] [MainThread]: Resource report: {"command_name": "run", "command_wall_clock_time": 1.4412023, "process_user_time": 1.758602, "process_kernel_time": 0.182743, "process_mem_max_rss": "119390208", "command_success": false, "process_in_blocks": "0", "process_out_blocks": "0"}
[0m15:42:26.322716 [debug] [MainThread]: Command `dbt run` failed at 15:42:26.322666 after 1.44 seconds
[0m15:42:26.323001 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106e87a90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x110cf03d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x110cfd370>]}
[0m15:42:26.323262 [debug] [MainThread]: Flushing usage events
[0m15:42:41.567722 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1025cfa00>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1045e4e20>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1045e46a0>]}


============================== 15:42:41.570589 | 14a11c4a-3800-4be6-a0f6-3b5a2eea8344 ==============================
[0m15:42:41.570589 [info ] [MainThread]: Running with dbt=1.8.1
[0m15:42:41.570984 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/Users/shrikanth/Shrikanth/dbt-helloworld', 'version_check': 'True', 'debug': 'False', 'log_path': '/Users/shrikanth/Shrikanth/dbt-helloworld/logs', 'fail_fast': 'False', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'introspect': 'True', 'invocation_command': 'dbt build', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m15:42:41.697974 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '14a11c4a-3800-4be6-a0f6-3b5a2eea8344', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104905670>]}
[0m15:42:41.726641 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '14a11c4a-3800-4be6-a0f6-3b5a2eea8344', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104ad4580>]}
[0m15:42:41.727315 [info ] [MainThread]: Registered adapter: postgres=1.8.1
[0m15:42:41.731850 [error] [MainThread]: Encountered an error:
Compilation Error
  dbt found 1 package(s) specified in packages.yml, but only 0 package(s) installed in dbt_packages. Run "dbt deps" to install package dependencies.
[0m15:42:41.733628 [debug] [MainThread]: Resource report: {"command_name": "build", "command_wall_clock_time": 0.2121437, "process_user_time": 0.732295, "process_kernel_time": 0.098919, "process_mem_max_rss": "93683712", "command_success": false, "process_in_blocks": "0", "process_out_blocks": "0"}
[0m15:42:41.734195 [debug] [MainThread]: Command `dbt build` failed at 15:42:41.734118 after 0.21 seconds
[0m15:42:41.734590 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1025cfa00>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104a77e80>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104b08040>]}
[0m15:42:41.734899 [debug] [MainThread]: Flushing usage events
[0m15:42:55.128662 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106a38a60>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108a482b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108a48a30>]}


============================== 15:42:55.131656 | 0c9a45e8-0e87-49d8-9274-0a9ceb374c81 ==============================
[0m15:42:55.131656 [info ] [MainThread]: Running with dbt=1.8.1
[0m15:42:55.132238 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/Users/shrikanth/Shrikanth/dbt-helloworld', 'debug': 'False', 'warn_error': 'None', 'log_path': '/Users/shrikanth/Shrikanth/dbt-helloworld/logs', 'fail_fast': 'False', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'invocation_command': 'dbt deps', 'introspect': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m15:42:55.234243 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '0c9a45e8-0e87-49d8-9274-0a9ceb374c81', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108723eb0>]}
[0m15:42:55.246819 [debug] [MainThread]: Set downloads directory='/var/folders/ll/3nys2tln7dv4vrs7t9wxvd5w0000gn/T/dbt-downloads-km0vsdkh'
[0m15:42:55.247153 [info ] [MainThread]: Installing https://github.com/dbt-labs/dbt-utils.git
[0m15:42:55.247472 [debug] [MainThread]: Executing "git clone --depth 1 https://github.com/dbt-labs/dbt-utils.git b03949bb53de3439f6a8057088ba4032"
[0m15:42:56.462290 [debug] [MainThread]: STDOUT: "b''"
[0m15:42:56.463020 [debug] [MainThread]: STDERR: "b"Cloning into 'b03949bb53de3439f6a8057088ba4032'...\n""
[0m15:42:56.463478 [debug] [MainThread]: Pulling new dependency b03949bb53de3439f6a8057088ba4032.
[0m15:42:56.463766 [debug] [MainThread]: Executing "git rev-parse HEAD"
[0m15:42:56.469904 [debug] [MainThread]: STDOUT: "b'fc98e4e30cd299ddd67c43902f2a5efa9511edfb\n'"
[0m15:42:56.470586 [debug] [MainThread]: STDERR: "b''"
[0m15:42:56.470896 [debug] [MainThread]: Checking out revision 74a661ca00452da7d2b2811ff1e5a37f152c3ee2.
[0m15:42:56.471300 [debug] [MainThread]: Executing "git fetch origin --depth 1 74a661ca00452da7d2b2811ff1e5a37f152c3ee2"
[0m15:42:57.717108 [debug] [MainThread]: STDOUT: "b''"
[0m15:42:57.717713 [debug] [MainThread]: STDERR: "b'From https://github.com/dbt-labs/dbt-utils\n * branch            74a661ca00452da7d2b2811ff1e5a37f152c3ee2 -> FETCH_HEAD\n'"
[0m15:42:57.717997 [debug] [MainThread]: Executing "git reset --hard 74a661ca00452da7d2b2811ff1e5a37f152c3ee2"
[0m15:42:57.744683 [debug] [MainThread]: STDOUT: "b'HEAD is now at 74a661c Update CHANGELOG for v1.1.1 (#803)\n'"
[0m15:42:57.745254 [debug] [MainThread]: STDERR: "b''"
[0m15:42:57.745501 [debug] [MainThread]: Executing "git rev-parse HEAD"
[0m15:42:57.750995 [debug] [MainThread]: STDOUT: "b'74a661ca00452da7d2b2811ff1e5a37f152c3ee2\n'"
[0m15:42:57.751464 [debug] [MainThread]: STDERR: "b''"
[0m15:42:57.751709 [debug] [MainThread]: Checked out at 74a661c.
[0m15:42:57.751961 [debug] [MainThread]: Executing "git rev-parse HEAD"
[0m15:42:57.756578 [debug] [MainThread]: STDOUT: "b'74a661ca00452da7d2b2811ff1e5a37f152c3ee2\n'"
[0m15:42:57.757333 [debug] [MainThread]: STDERR: "b''"
[0m15:42:57.758119 [debug] [MainThread]: Executing "git clone --depth 1 https://github.com/dbt-labs/dbt-utils.git b03949bb53de3439f6a8057088ba4032"
[0m15:42:57.762646 [debug] [MainThread]: STDOUT: "b''"
[0m15:42:57.763115 [debug] [MainThread]: STDERR: "b"fatal: destination path 'b03949bb53de3439f6a8057088ba4032' already exists and is not an empty directory.\n""
[0m15:42:57.763333 [debug] [MainThread]: command return code=128
[0m15:42:57.764266 [debug] [MainThread]: Updating existing dependency b03949bb53de3439f6a8057088ba4032.
[0m15:42:57.764502 [debug] [MainThread]: Executing "git rev-parse HEAD"
[0m15:42:57.769088 [debug] [MainThread]: STDOUT: "b'74a661ca00452da7d2b2811ff1e5a37f152c3ee2\n'"
[0m15:42:57.769538 [debug] [MainThread]: STDERR: "b''"
[0m15:42:57.769790 [debug] [MainThread]: Checking out revision 74a661ca00452da7d2b2811ff1e5a37f152c3ee2.
[0m15:42:57.770028 [debug] [MainThread]: Executing "git fetch origin --depth 1 74a661ca00452da7d2b2811ff1e5a37f152c3ee2"
[0m15:42:58.723772 [debug] [MainThread]: STDOUT: "b''"
[0m15:42:58.724980 [debug] [MainThread]: STDERR: "b'From https://github.com/dbt-labs/dbt-utils\n * branch            74a661ca00452da7d2b2811ff1e5a37f152c3ee2 -> FETCH_HEAD\n'"
[0m15:42:58.725461 [debug] [MainThread]: Executing "git reset --hard 74a661ca00452da7d2b2811ff1e5a37f152c3ee2"
[0m15:42:58.742001 [debug] [MainThread]: STDOUT: "b'HEAD is now at 74a661c Update CHANGELOG for v1.1.1 (#803)\n'"
[0m15:42:58.742689 [debug] [MainThread]: STDERR: "b''"
[0m15:42:58.743031 [debug] [MainThread]: Executing "git rev-parse HEAD"
[0m15:42:58.748311 [debug] [MainThread]: STDOUT: "b'74a661ca00452da7d2b2811ff1e5a37f152c3ee2\n'"
[0m15:42:58.748827 [debug] [MainThread]: STDERR: "b''"
[0m15:42:58.749136 [debug] [MainThread]: Already at 74a661c, nothing to do.
[0m15:42:58.749544 [info ] [MainThread]: Installed from revision 74a661ca00452da7d2b2811ff1e5a37f152c3ee2
[0m15:42:58.749973 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'package', 'label': '0c9a45e8-0e87-49d8-9274-0a9ceb374c81', 'property_': 'install', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1089dea30>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108bb3550>]}
[0m15:42:58.753154 [debug] [MainThread]: Resource report: {"command_name": "deps", "command_success": true, "command_wall_clock_time": 3.6719887, "process_user_time": 0.726472, "process_kernel_time": 0.113479, "process_mem_max_rss": "90046464", "process_in_blocks": "0", "process_out_blocks": "0"}
[0m15:42:58.753684 [debug] [MainThread]: Command `dbt deps` succeeded at 15:42:58.753613 after 3.67 seconds
[0m15:42:58.754020 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106a38a60>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1089de0d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108bb3250>]}
[0m15:42:58.754312 [debug] [MainThread]: Flushing usage events
[0m15:43:04.709223 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106dc6a00>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1097e8df0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1097e8670>]}


============================== 15:43:04.711563 | 67b584cb-95af-4f9c-b912-cec8001624e2 ==============================
[0m15:43:04.711563 [info ] [MainThread]: Running with dbt=1.8.1
[0m15:43:04.711936 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'version_check': 'True', 'log_path': '/Users/shrikanth/Shrikanth/dbt-helloworld/logs', 'profiles_dir': '/Users/shrikanth/Shrikanth/dbt-helloworld', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'invocation_command': 'dbt build', 'introspect': 'True', 'static_parser': 'True', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m15:43:04.871419 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '67b584cb-95af-4f9c-b912-cec8001624e2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x109c61250>]}
[0m15:43:04.899564 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '67b584cb-95af-4f9c-b912-cec8001624e2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10964a0d0>]}
[0m15:43:04.900145 [info ] [MainThread]: Registered adapter: postgres=1.8.1
[0m15:43:04.913170 [debug] [MainThread]: checksum: ebc509fb14e151ea268e89b60fd5abf912ed99129f87516462718fa2f14f4838, vars: {}, profile: , target: , version: 1.8.1
[0m15:43:04.968805 [info ] [MainThread]: Unable to do partial parsing because a project dependency has been added
[0m15:43:04.969180 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': '67b584cb-95af-4f9c-b912-cec8001624e2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107d42760>]}
[0m15:43:05.733671 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '67b584cb-95af-4f9c-b912-cec8001624e2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10a94e130>]}
[0m15:43:05.799405 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '67b584cb-95af-4f9c-b912-cec8001624e2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10a9a5e50>]}
[0m15:43:05.799756 [info ] [MainThread]: Found 3 models, 4 data tests, 527 macros
[0m15:43:05.800745 [info ] [MainThread]: 
[0m15:43:05.801088 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m15:43:05.803194 [debug] [ThreadPool]: Acquiring new postgres connection 'list_postgres'
[0m15:43:05.803515 [debug] [ThreadPool]: Acquiring new postgres connection 'list_postgres'
[0m15:43:05.832979 [debug] [ThreadPool]: Using postgres connection "list_postgres"
[0m15:43:05.833283 [debug] [ThreadPool]: Using postgres connection "list_postgres"
[0m15:43:05.833564 [debug] [ThreadPool]: On list_postgres: /* {"app": "dbt", "dbt_version": "1.8.1", "profile_name": "pgmigrate", "target_name": "dev", "connection_name": "list_postgres"} */

    select distinct nspname from pg_namespace
  
[0m15:43:05.833815 [debug] [ThreadPool]: On list_postgres: /* {"app": "dbt", "dbt_version": "1.8.1", "profile_name": "pgmigrate", "target_name": "dev", "connection_name": "list_postgres"} */

    select distinct nspname from pg_namespace
  
[0m15:43:05.834060 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m15:43:05.834269 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m15:43:05.858675 [debug] [ThreadPool]: SQL status: SELECT 18 in 0.0 seconds
[0m15:43:05.858912 [debug] [ThreadPool]: SQL status: SELECT 18 in 0.0 seconds
[0m15:43:05.859723 [debug] [ThreadPool]: On list_postgres: Close
[0m15:43:05.860366 [debug] [ThreadPool]: On list_postgres: Close
[0m15:43:05.861201 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_postgres, now list_postgres_public__airbyte_quarantine)
[0m15:43:05.861506 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_postgres, now list_postgres_public)
[0m15:43:05.865178 [debug] [ThreadPool]: Using postgres connection "list_postgres_public__airbyte_quarantine"
[0m15:43:05.866811 [debug] [ThreadPool]: Using postgres connection "list_postgres_public"
[0m15:43:05.867051 [debug] [ThreadPool]: On list_postgres_public__airbyte_quarantine: BEGIN
[0m15:43:05.867261 [debug] [ThreadPool]: On list_postgres_public: BEGIN
[0m15:43:05.867459 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m15:43:05.867657 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m15:43:05.873103 [debug] [ThreadPool]: SQL status: BEGIN in 0.0 seconds
[0m15:43:05.873328 [debug] [ThreadPool]: SQL status: BEGIN in 0.0 seconds
[0m15:43:05.873526 [debug] [ThreadPool]: Using postgres connection "list_postgres_public__airbyte_quarantine"
[0m15:43:05.873729 [debug] [ThreadPool]: Using postgres connection "list_postgres_public"
[0m15:43:05.873949 [debug] [ThreadPool]: On list_postgres_public__airbyte_quarantine: /* {"app": "dbt", "dbt_version": "1.8.1", "profile_name": "pgmigrate", "target_name": "dev", "connection_name": "list_postgres_public__airbyte_quarantine"} */
select
      'postgres' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public__airbyte_quarantine'
    union all
    select
      'postgres' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public__airbyte_quarantine'
    union all
    select
      'postgres' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public__airbyte_quarantine'
  
[0m15:43:05.874186 [debug] [ThreadPool]: On list_postgres_public: /* {"app": "dbt", "dbt_version": "1.8.1", "profile_name": "pgmigrate", "target_name": "dev", "connection_name": "list_postgres_public"} */
select
      'postgres' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'postgres' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
    union all
    select
      'postgres' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public'
  
[0m15:43:05.881427 [debug] [ThreadPool]: SQL status: SELECT 0 in 0.0 seconds
[0m15:43:05.881637 [debug] [ThreadPool]: SQL status: SELECT 5 in 0.0 seconds
[0m15:43:05.882260 [debug] [ThreadPool]: On list_postgres_public__airbyte_quarantine: ROLLBACK
[0m15:43:05.882918 [debug] [ThreadPool]: On list_postgres_public: ROLLBACK
[0m15:43:05.883305 [debug] [ThreadPool]: On list_postgres_public: Close
[0m15:43:05.883504 [debug] [ThreadPool]: On list_postgres_public__airbyte_quarantine: Close
[0m15:43:05.886419 [debug] [MainThread]: Using postgres connection "master"
[0m15:43:05.886634 [debug] [MainThread]: On master: BEGIN
[0m15:43:05.886827 [debug] [MainThread]: Opening a new connection, currently in state init
[0m15:43:05.892264 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m15:43:05.892470 [debug] [MainThread]: Using postgres connection "master"
[0m15:43:05.892718 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.8.1", "profile_name": "pgmigrate", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m15:43:05.915765 [debug] [MainThread]: SQL status: SELECT 1 in 0.0 seconds
[0m15:43:05.916567 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '67b584cb-95af-4f9c-b912-cec8001624e2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10a816430>]}
[0m15:43:05.916857 [debug] [MainThread]: On master: ROLLBACK
[0m15:43:05.917187 [debug] [MainThread]: Using postgres connection "master"
[0m15:43:05.917417 [debug] [MainThread]: On master: BEGIN
[0m15:43:05.917817 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m15:43:05.918038 [debug] [MainThread]: On master: COMMIT
[0m15:43:05.918253 [debug] [MainThread]: Using postgres connection "master"
[0m15:43:05.918460 [debug] [MainThread]: On master: COMMIT
[0m15:43:05.918747 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m15:43:05.918967 [debug] [MainThread]: On master: Close
[0m15:43:05.919256 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m15:43:05.919496 [info ] [MainThread]: 
[0m15:43:05.920705 [debug] [Thread-1  ]: Began running node model.pgmigrate.my_first_dbt_model
[0m15:43:05.921070 [debug] [Thread-2  ]: Began running node model.pgmigrate.users_dbt_model
[0m15:43:05.921400 [info ] [Thread-1  ]: 1 of 7 START sql table model public.my_first_dbt_model ......................... [RUN]
[0m15:43:05.921747 [info ] [Thread-2  ]: 2 of 7 START sql view model public__airbyte_quarantine.users_scalar ............ [RUN]
[0m15:43:05.922052 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly list_postgres_public__airbyte_quarantine, now model.pgmigrate.my_first_dbt_model)
[0m15:43:05.922329 [debug] [Thread-2  ]: Re-using an available connection from the pool (formerly list_postgres_public, now model.pgmigrate.users_dbt_model)
[0m15:43:05.922588 [debug] [Thread-1  ]: Began compiling node model.pgmigrate.my_first_dbt_model
[0m15:43:05.922838 [debug] [Thread-2  ]: Began compiling node model.pgmigrate.users_dbt_model
[0m15:43:05.927647 [debug] [Thread-1  ]: Writing injected SQL for node "model.pgmigrate.my_first_dbt_model"
[0m15:43:05.931591 [debug] [Thread-1  ]: Began executing node model.pgmigrate.my_first_dbt_model
[0m15:43:05.954210 [debug] [Thread-1  ]: Writing runtime sql for node "model.pgmigrate.my_first_dbt_model"
[0m15:43:05.954705 [debug] [Thread-1  ]: Using postgres connection "model.pgmigrate.my_first_dbt_model"
[0m15:43:05.954968 [debug] [Thread-1  ]: On model.pgmigrate.my_first_dbt_model: BEGIN
[0m15:43:05.955205 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m15:43:05.957801 [debug] [Thread-2  ]: Compilation Error in model users_dbt_model (models/example/users_dbt_model.sql)
  'jsonb_extract_path_text' is undefined. This can happen when calling a macro that does not exist. Check for typos and/or install package dependencies with "dbt deps".
[0m15:43:05.958625 [debug] [Thread-2  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '67b584cb-95af-4f9c-b912-cec8001624e2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10aff5b50>]}
[0m15:43:05.958999 [error] [Thread-2  ]: 2 of 7 ERROR creating sql view model public__airbyte_quarantine.users_scalar ... [[31mERROR[0m in 0.04s]
[0m15:43:05.959346 [debug] [Thread-2  ]: Finished running node model.pgmigrate.users_dbt_model
[0m15:43:05.960034 [debug] [Thread-1  ]: SQL status: BEGIN in 0.0 seconds
[0m15:43:05.960287 [debug] [Thread-1  ]: Using postgres connection "model.pgmigrate.my_first_dbt_model"
[0m15:43:05.960535 [debug] [Thread-1  ]: On model.pgmigrate.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.8.1", "profile_name": "pgmigrate", "target_name": "dev", "node_id": "model.pgmigrate.my_first_dbt_model"} */

  
    

  create  table "postgres"."public"."my_first_dbt_model__dbt_tmp"
  
  
    as
  
  (
    /*
    Welcome to your first dbt model!
    Did you know that you can also configure models directly within SQL files?
    This will override configurations stated in dbt_project.yml

    Try changing "table" to "view" below
*/



with source_data as (

    select 1 as id
    union all
    select null as id

)

select *
from source_data

/*
    Uncomment the line below to remove records with null `id` values
*/

-- where id is not null
  );
  
[0m15:43:05.964779 [debug] [Thread-1  ]: SQL status: SELECT 2 in 0.0 seconds
[0m15:43:05.968588 [debug] [Thread-1  ]: Using postgres connection "model.pgmigrate.my_first_dbt_model"
[0m15:43:05.968847 [debug] [Thread-1  ]: On model.pgmigrate.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.8.1", "profile_name": "pgmigrate", "target_name": "dev", "node_id": "model.pgmigrate.my_first_dbt_model"} */
alter table "postgres"."public"."my_first_dbt_model" rename to "my_first_dbt_model__dbt_backup"
[0m15:43:05.969759 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.0 seconds
[0m15:43:05.971510 [debug] [Thread-1  ]: Using postgres connection "model.pgmigrate.my_first_dbt_model"
[0m15:43:05.971748 [debug] [Thread-1  ]: On model.pgmigrate.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.8.1", "profile_name": "pgmigrate", "target_name": "dev", "node_id": "model.pgmigrate.my_first_dbt_model"} */
alter table "postgres"."public"."my_first_dbt_model__dbt_tmp" rename to "my_first_dbt_model"
[0m15:43:05.972620 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.0 seconds
[0m15:43:05.983454 [debug] [Thread-1  ]: On model.pgmigrate.my_first_dbt_model: COMMIT
[0m15:43:05.983726 [debug] [Thread-1  ]: Using postgres connection "model.pgmigrate.my_first_dbt_model"
[0m15:43:05.983950 [debug] [Thread-1  ]: On model.pgmigrate.my_first_dbt_model: COMMIT
[0m15:43:05.985347 [debug] [Thread-1  ]: SQL status: COMMIT in 0.0 seconds
[0m15:43:05.988822 [debug] [Thread-1  ]: Applying DROP to: "postgres"."public"."my_first_dbt_model__dbt_backup"
[0m15:43:05.991177 [debug] [Thread-1  ]: Using postgres connection "model.pgmigrate.my_first_dbt_model"
[0m15:43:05.991428 [debug] [Thread-1  ]: On model.pgmigrate.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.8.1", "profile_name": "pgmigrate", "target_name": "dev", "node_id": "model.pgmigrate.my_first_dbt_model"} */
drop table if exists "postgres"."public"."my_first_dbt_model__dbt_backup" cascade
[0m15:43:05.996003 [debug] [Thread-1  ]: SQL status: DROP TABLE in 0.0 seconds
[0m15:43:05.997217 [debug] [Thread-1  ]: On model.pgmigrate.my_first_dbt_model: Close
[0m15:43:05.997533 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '67b584cb-95af-4f9c-b912-cec8001624e2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10ad00130>]}
[0m15:43:05.997887 [info ] [Thread-1  ]: 1 of 7 OK created sql table model public.my_first_dbt_model .................... [[32mSELECT 2[0m in 0.08s]
[0m15:43:05.998243 [debug] [Thread-1  ]: Finished running node model.pgmigrate.my_first_dbt_model
[0m15:43:05.998741 [debug] [Thread-4  ]: Began running node test.pgmigrate.not_null_my_first_dbt_model_id.5fb22c2710
[0m15:43:05.999046 [debug] [Thread-3  ]: Began running node test.pgmigrate.unique_my_first_dbt_model_id.16e066b321
[0m15:43:05.999356 [info ] [Thread-4  ]: 3 of 7 START test not_null_my_first_dbt_model_id ............................... [RUN]
[0m15:43:05.999672 [info ] [Thread-3  ]: 4 of 7 START test unique_my_first_dbt_model_id ................................. [RUN]
[0m15:43:06.000052 [debug] [Thread-4  ]: Acquiring new postgres connection 'test.pgmigrate.not_null_my_first_dbt_model_id.5fb22c2710'
[0m15:43:06.000340 [debug] [Thread-3  ]: Acquiring new postgres connection 'test.pgmigrate.unique_my_first_dbt_model_id.16e066b321'
[0m15:43:06.000581 [debug] [Thread-4  ]: Began compiling node test.pgmigrate.not_null_my_first_dbt_model_id.5fb22c2710
[0m15:43:06.000830 [debug] [Thread-3  ]: Began compiling node test.pgmigrate.unique_my_first_dbt_model_id.16e066b321
[0m15:43:06.007428 [debug] [Thread-4  ]: Writing injected SQL for node "test.pgmigrate.not_null_my_first_dbt_model_id.5fb22c2710"
[0m15:43:06.011685 [debug] [Thread-3  ]: Writing injected SQL for node "test.pgmigrate.unique_my_first_dbt_model_id.16e066b321"
[0m15:43:06.012209 [debug] [Thread-3  ]: Began executing node test.pgmigrate.unique_my_first_dbt_model_id.16e066b321
[0m15:43:06.012461 [debug] [Thread-4  ]: Began executing node test.pgmigrate.not_null_my_first_dbt_model_id.5fb22c2710
[0m15:43:06.020750 [debug] [Thread-3  ]: Writing runtime sql for node "test.pgmigrate.unique_my_first_dbt_model_id.16e066b321"
[0m15:43:06.022312 [debug] [Thread-4  ]: Writing runtime sql for node "test.pgmigrate.not_null_my_first_dbt_model_id.5fb22c2710"
[0m15:43:06.022801 [debug] [Thread-4  ]: Using postgres connection "test.pgmigrate.not_null_my_first_dbt_model_id.5fb22c2710"
[0m15:43:06.023060 [debug] [Thread-3  ]: Using postgres connection "test.pgmigrate.unique_my_first_dbt_model_id.16e066b321"
[0m15:43:06.023299 [debug] [Thread-4  ]: On test.pgmigrate.not_null_my_first_dbt_model_id.5fb22c2710: BEGIN
[0m15:43:06.023544 [debug] [Thread-3  ]: On test.pgmigrate.unique_my_first_dbt_model_id.16e066b321: BEGIN
[0m15:43:06.023770 [debug] [Thread-4  ]: Opening a new connection, currently in state init
[0m15:43:06.023991 [debug] [Thread-3  ]: Opening a new connection, currently in state init
[0m15:43:06.029818 [debug] [Thread-4  ]: SQL status: BEGIN in 0.0 seconds
[0m15:43:06.030042 [debug] [Thread-3  ]: SQL status: BEGIN in 0.0 seconds
[0m15:43:06.030281 [debug] [Thread-4  ]: Using postgres connection "test.pgmigrate.not_null_my_first_dbt_model_id.5fb22c2710"
[0m15:43:06.030512 [debug] [Thread-3  ]: Using postgres connection "test.pgmigrate.unique_my_first_dbt_model_id.16e066b321"
[0m15:43:06.030748 [debug] [Thread-4  ]: On test.pgmigrate.not_null_my_first_dbt_model_id.5fb22c2710: /* {"app": "dbt", "dbt_version": "1.8.1", "profile_name": "pgmigrate", "target_name": "dev", "node_id": "test.pgmigrate.not_null_my_first_dbt_model_id.5fb22c2710"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select id
from "postgres"."public"."my_first_dbt_model"
where id is null



      
    ) dbt_internal_test
[0m15:43:06.031001 [debug] [Thread-3  ]: On test.pgmigrate.unique_my_first_dbt_model_id.16e066b321: /* {"app": "dbt", "dbt_version": "1.8.1", "profile_name": "pgmigrate", "target_name": "dev", "node_id": "test.pgmigrate.unique_my_first_dbt_model_id.16e066b321"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

select
    id as unique_field,
    count(*) as n_records

from "postgres"."public"."my_first_dbt_model"
where id is not null
group by id
having count(*) > 1



      
    ) dbt_internal_test
[0m15:43:06.033227 [debug] [Thread-4  ]: SQL status: SELECT 1 in 0.0 seconds
[0m15:43:06.035233 [debug] [Thread-4  ]: On test.pgmigrate.not_null_my_first_dbt_model_id.5fb22c2710: ROLLBACK
[0m15:43:06.035492 [debug] [Thread-3  ]: SQL status: SELECT 1 in 0.0 seconds
[0m15:43:06.036286 [debug] [Thread-3  ]: On test.pgmigrate.unique_my_first_dbt_model_id.16e066b321: ROLLBACK
[0m15:43:06.036526 [debug] [Thread-4  ]: On test.pgmigrate.not_null_my_first_dbt_model_id.5fb22c2710: Close
[0m15:43:06.037090 [debug] [Thread-3  ]: On test.pgmigrate.unique_my_first_dbt_model_id.16e066b321: Close
[0m15:43:06.036902 [error] [Thread-4  ]: 3 of 7 FAIL 1 not_null_my_first_dbt_model_id ................................... [[31mFAIL 1[0m in 0.04s]
[0m15:43:06.037526 [info ] [Thread-3  ]: 4 of 7 PASS unique_my_first_dbt_model_id ....................................... [[32mPASS[0m in 0.04s]
[0m15:43:06.037871 [debug] [Thread-4  ]: Finished running node test.pgmigrate.not_null_my_first_dbt_model_id.5fb22c2710
[0m15:43:06.038181 [debug] [Thread-3  ]: Finished running node test.pgmigrate.unique_my_first_dbt_model_id.16e066b321
[0m15:43:06.038712 [debug] [Thread-1  ]: Began running node model.pgmigrate.my_second_dbt_model
[0m15:43:06.039020 [info ] [Thread-1  ]: 5 of 7 SKIP relation public.my_second_dbt_model ................................ [[33mSKIP[0m]
[0m15:43:06.039312 [debug] [Thread-1  ]: Finished running node model.pgmigrate.my_second_dbt_model
[0m15:43:06.039708 [debug] [Thread-4  ]: Began running node test.pgmigrate.not_null_my_second_dbt_model_id.151b76d778
[0m15:43:06.040002 [debug] [Thread-3  ]: Began running node test.pgmigrate.unique_my_second_dbt_model_id.57a0f8c493
[0m15:43:06.040275 [info ] [Thread-4  ]: 6 of 7 SKIP test not_null_my_second_dbt_model_id ............................... [[33mSKIP[0m]
[0m15:43:06.040598 [info ] [Thread-3  ]: 7 of 7 SKIP test unique_my_second_dbt_model_id ................................. [[33mSKIP[0m]
[0m15:43:06.040904 [debug] [Thread-4  ]: Finished running node test.pgmigrate.not_null_my_second_dbt_model_id.151b76d778
[0m15:43:06.041158 [debug] [Thread-3  ]: Finished running node test.pgmigrate.unique_my_second_dbt_model_id.57a0f8c493
[0m15:43:06.041802 [debug] [MainThread]: Using postgres connection "master"
[0m15:43:06.042004 [debug] [MainThread]: On master: BEGIN
[0m15:43:06.042210 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m15:43:06.046724 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m15:43:06.046932 [debug] [MainThread]: On master: COMMIT
[0m15:43:06.047122 [debug] [MainThread]: Using postgres connection "master"
[0m15:43:06.047306 [debug] [MainThread]: On master: COMMIT
[0m15:43:06.047621 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m15:43:06.047832 [debug] [MainThread]: On master: Close
[0m15:43:06.048099 [debug] [MainThread]: Connection 'master' was properly closed.
[0m15:43:06.048298 [debug] [MainThread]: Connection 'model.pgmigrate.my_first_dbt_model' was properly closed.
[0m15:43:06.048491 [debug] [MainThread]: Connection 'model.pgmigrate.users_dbt_model' was properly closed.
[0m15:43:06.048694 [debug] [MainThread]: Connection 'test.pgmigrate.not_null_my_first_dbt_model_id.5fb22c2710' was properly closed.
[0m15:43:06.048881 [debug] [MainThread]: Connection 'test.pgmigrate.unique_my_first_dbt_model_id.16e066b321' was properly closed.
[0m15:43:06.049136 [info ] [MainThread]: 
[0m15:43:06.049372 [info ] [MainThread]: Finished running 2 view models, 1 table model, 4 data tests in 0 hours 0 minutes and 0.25 seconds (0.25s).
[0m15:43:06.049979 [debug] [MainThread]: Command end result
[0m15:43:06.096328 [info ] [MainThread]: 
[0m15:43:06.096711 [info ] [MainThread]: [31mCompleted with 2 errors and 0 warnings:[0m
[0m15:43:06.096965 [info ] [MainThread]: 
[0m15:43:06.097269 [error] [MainThread]:   Compilation Error in model users_dbt_model (models/example/users_dbt_model.sql)
  'jsonb_extract_path_text' is undefined. This can happen when calling a macro that does not exist. Check for typos and/or install package dependencies with "dbt deps".
[0m15:43:06.097530 [info ] [MainThread]: 
[0m15:43:06.097811 [error] [MainThread]: [31mFailure in test not_null_my_first_dbt_model_id (models/example/schema.yml)[0m
[0m15:43:06.098064 [error] [MainThread]:   Got 1 result, configured to fail if != 0
[0m15:43:06.098276 [info ] [MainThread]: 
[0m15:43:06.098524 [info ] [MainThread]:   compiled code at target/compiled/pgmigrate/models/example/schema.yml/not_null_my_first_dbt_model_id.sql
[0m15:43:06.098761 [info ] [MainThread]: 
[0m15:43:06.098991 [info ] [MainThread]: Done. PASS=2 WARN=0 ERROR=2 SKIP=3 TOTAL=7
[0m15:43:06.100204 [debug] [MainThread]: Resource report: {"command_name": "build", "command_wall_clock_time": 1.4269577, "process_user_time": 1.748241, "process_kernel_time": 0.127746, "process_mem_max_rss": "122503168", "command_success": false, "process_in_blocks": "0", "process_out_blocks": "0"}
[0m15:43:06.100522 [debug] [MainThread]: Command `dbt build` failed at 15:43:06.100479 after 1.43 seconds
[0m15:43:06.100769 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106dc6a00>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10b24d940>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10b24d4f0>]}
[0m15:43:06.101002 [debug] [MainThread]: Flushing usage events
[0m15:43:36.519223 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104c56a00>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106c6ce20>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106c6c6a0>]}


============================== 15:43:36.521771 | 610a0b0c-6713-4e51-a2e6-480913ddf4fa ==============================
[0m15:43:36.521771 [info ] [MainThread]: Running with dbt=1.8.1
[0m15:43:36.522152 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'debug': 'False', 'log_path': '/Users/shrikanth/Shrikanth/dbt-helloworld/logs', 'profiles_dir': '/Users/shrikanth/Shrikanth/dbt-helloworld', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'static_parser': 'True', 'introspect': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'target_path': 'None', 'invocation_command': 'dbt build', 'send_anonymous_usage_stats': 'True'}
[0m15:43:36.658705 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '610a0b0c-6713-4e51-a2e6-480913ddf4fa', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106f8d8e0>]}
[0m15:43:36.687820 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '610a0b0c-6713-4e51-a2e6-480913ddf4fa', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10715e580>]}
[0m15:43:36.688470 [info ] [MainThread]: Registered adapter: postgres=1.8.1
[0m15:43:36.702206 [debug] [MainThread]: checksum: ebc509fb14e151ea268e89b60fd5abf912ed99129f87516462718fa2f14f4838, vars: {}, profile: , target: , version: 1.8.1
[0m15:43:36.791690 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m15:43:36.791983 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m15:43:36.816165 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '610a0b0c-6713-4e51-a2e6-480913ddf4fa', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107798130>]}
[0m15:43:36.882069 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '610a0b0c-6713-4e51-a2e6-480913ddf4fa', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1077a3b50>]}
[0m15:43:36.882405 [info ] [MainThread]: Found 3 models, 4 data tests, 527 macros
[0m15:43:36.883416 [info ] [MainThread]: 
[0m15:43:36.883771 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m15:43:36.885920 [debug] [ThreadPool]: Acquiring new postgres connection 'list_postgres'
[0m15:43:36.886241 [debug] [ThreadPool]: Acquiring new postgres connection 'list_postgres'
[0m15:43:36.914745 [debug] [ThreadPool]: Using postgres connection "list_postgres"
[0m15:43:36.915006 [debug] [ThreadPool]: Using postgres connection "list_postgres"
[0m15:43:36.915252 [debug] [ThreadPool]: On list_postgres: /* {"app": "dbt", "dbt_version": "1.8.1", "profile_name": "pgmigrate", "target_name": "dev", "connection_name": "list_postgres"} */

    select distinct nspname from pg_namespace
  
[0m15:43:36.915479 [debug] [ThreadPool]: On list_postgres: /* {"app": "dbt", "dbt_version": "1.8.1", "profile_name": "pgmigrate", "target_name": "dev", "connection_name": "list_postgres"} */

    select distinct nspname from pg_namespace
  
[0m15:43:36.915696 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m15:43:36.915902 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m15:43:36.936714 [debug] [ThreadPool]: SQL status: SELECT 18 in 0.0 seconds
[0m15:43:36.936976 [debug] [ThreadPool]: SQL status: SELECT 18 in 0.0 seconds
[0m15:43:36.937746 [debug] [ThreadPool]: On list_postgres: Close
[0m15:43:36.938392 [debug] [ThreadPool]: On list_postgres: Close
[0m15:43:36.939203 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_postgres, now list_postgres_public)
[0m15:43:36.939528 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_postgres, now list_postgres_public__airbyte_quarantine)
[0m15:43:36.943386 [debug] [ThreadPool]: Using postgres connection "list_postgres_public"
[0m15:43:36.944733 [debug] [ThreadPool]: Using postgres connection "list_postgres_public__airbyte_quarantine"
[0m15:43:36.944959 [debug] [ThreadPool]: On list_postgres_public: BEGIN
[0m15:43:36.945197 [debug] [ThreadPool]: On list_postgres_public__airbyte_quarantine: BEGIN
[0m15:43:36.945411 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m15:43:36.945627 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m15:43:36.950946 [debug] [ThreadPool]: SQL status: BEGIN in 0.0 seconds
[0m15:43:36.951181 [debug] [ThreadPool]: SQL status: BEGIN in 0.0 seconds
[0m15:43:36.951396 [debug] [ThreadPool]: Using postgres connection "list_postgres_public"
[0m15:43:36.951606 [debug] [ThreadPool]: Using postgres connection "list_postgres_public__airbyte_quarantine"
[0m15:43:36.951826 [debug] [ThreadPool]: On list_postgres_public: /* {"app": "dbt", "dbt_version": "1.8.1", "profile_name": "pgmigrate", "target_name": "dev", "connection_name": "list_postgres_public"} */
select
      'postgres' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'postgres' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
    union all
    select
      'postgres' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public'
  
[0m15:43:36.952061 [debug] [ThreadPool]: On list_postgres_public__airbyte_quarantine: /* {"app": "dbt", "dbt_version": "1.8.1", "profile_name": "pgmigrate", "target_name": "dev", "connection_name": "list_postgres_public__airbyte_quarantine"} */
select
      'postgres' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public__airbyte_quarantine'
    union all
    select
      'postgres' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public__airbyte_quarantine'
    union all
    select
      'postgres' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public__airbyte_quarantine'
  
[0m15:43:36.958630 [debug] [ThreadPool]: SQL status: SELECT 0 in 0.0 seconds
[0m15:43:36.958845 [debug] [ThreadPool]: SQL status: SELECT 4 in 0.0 seconds
[0m15:43:36.959487 [debug] [ThreadPool]: On list_postgres_public__airbyte_quarantine: ROLLBACK
[0m15:43:36.960142 [debug] [ThreadPool]: On list_postgres_public: ROLLBACK
[0m15:43:36.960503 [debug] [ThreadPool]: On list_postgres_public__airbyte_quarantine: Close
[0m15:43:36.960712 [debug] [ThreadPool]: On list_postgres_public: Close
[0m15:43:36.963639 [debug] [MainThread]: Using postgres connection "master"
[0m15:43:36.963882 [debug] [MainThread]: On master: BEGIN
[0m15:43:36.964075 [debug] [MainThread]: Opening a new connection, currently in state init
[0m15:43:36.969474 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m15:43:36.969684 [debug] [MainThread]: Using postgres connection "master"
[0m15:43:36.969940 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.8.1", "profile_name": "pgmigrate", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m15:43:36.986372 [debug] [MainThread]: SQL status: SELECT 0 in 0.0 seconds
[0m15:43:36.987022 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '610a0b0c-6713-4e51-a2e6-480913ddf4fa', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107108be0>]}
[0m15:43:36.987309 [debug] [MainThread]: On master: ROLLBACK
[0m15:43:36.987678 [debug] [MainThread]: Using postgres connection "master"
[0m15:43:36.987888 [debug] [MainThread]: On master: BEGIN
[0m15:43:36.988301 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m15:43:36.988518 [debug] [MainThread]: On master: COMMIT
[0m15:43:36.988722 [debug] [MainThread]: Using postgres connection "master"
[0m15:43:36.988922 [debug] [MainThread]: On master: COMMIT
[0m15:43:36.989221 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m15:43:36.989434 [debug] [MainThread]: On master: Close
[0m15:43:36.989714 [info ] [MainThread]: Concurrency: 2 threads (target='dev')
[0m15:43:36.989943 [info ] [MainThread]: 
[0m15:43:36.991110 [debug] [Thread-1  ]: Began running node model.pgmigrate.my_first_dbt_model
[0m15:43:36.991378 [debug] [Thread-2  ]: Began running node model.pgmigrate.users_dbt_model
[0m15:43:36.991711 [info ] [Thread-1  ]: 1 of 7 START sql table model public.my_first_dbt_model ......................... [RUN]
[0m15:43:36.992060 [info ] [Thread-2  ]: 2 of 7 START sql view model public__airbyte_quarantine.users_scalar ............ [RUN]
[0m15:43:36.992421 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly list_postgres_public, now model.pgmigrate.my_first_dbt_model)
[0m15:43:36.992694 [debug] [Thread-2  ]: Re-using an available connection from the pool (formerly list_postgres_public__airbyte_quarantine, now model.pgmigrate.users_dbt_model)
[0m15:43:36.992939 [debug] [Thread-1  ]: Began compiling node model.pgmigrate.my_first_dbt_model
[0m15:43:36.993179 [debug] [Thread-2  ]: Began compiling node model.pgmigrate.users_dbt_model
[0m15:43:36.998025 [debug] [Thread-1  ]: Writing injected SQL for node "model.pgmigrate.my_first_dbt_model"
[0m15:43:37.001972 [debug] [Thread-1  ]: Began executing node model.pgmigrate.my_first_dbt_model
[0m15:43:37.024896 [debug] [Thread-1  ]: Writing runtime sql for node "model.pgmigrate.my_first_dbt_model"
[0m15:43:37.025407 [debug] [Thread-1  ]: Using postgres connection "model.pgmigrate.my_first_dbt_model"
[0m15:43:37.025742 [debug] [Thread-1  ]: On model.pgmigrate.my_first_dbt_model: BEGIN
[0m15:43:37.026011 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m15:43:37.028121 [debug] [Thread-2  ]: Compilation Error in model users_dbt_model (models/example/users_dbt_model.sql)
  'jsonb_extract_path_text' is undefined. This can happen when calling a macro that does not exist. Check for typos and/or install package dependencies with "dbt deps".
[0m15:43:37.028956 [debug] [Thread-2  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '610a0b0c-6713-4e51-a2e6-480913ddf4fa', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107a61b50>]}
[0m15:43:37.029340 [error] [Thread-2  ]: 2 of 7 ERROR creating sql view model public__airbyte_quarantine.users_scalar ... [[31mERROR[0m in 0.04s]
[0m15:43:37.029727 [debug] [Thread-2  ]: Finished running node model.pgmigrate.users_dbt_model
[0m15:43:37.029965 [debug] [Thread-1  ]: SQL status: BEGIN in 0.0 seconds
[0m15:43:37.030327 [debug] [Thread-1  ]: Using postgres connection "model.pgmigrate.my_first_dbt_model"
[0m15:43:37.030591 [debug] [Thread-1  ]: On model.pgmigrate.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.8.1", "profile_name": "pgmigrate", "target_name": "dev", "node_id": "model.pgmigrate.my_first_dbt_model"} */

  
    

  create  table "postgres"."public"."my_first_dbt_model__dbt_tmp"
  
  
    as
  
  (
    /*
    Welcome to your first dbt model!
    Did you know that you can also configure models directly within SQL files?
    This will override configurations stated in dbt_project.yml

    Try changing "table" to "view" below
*/



with source_data as (

    select 1 as id
    union all
    select null as id

)

select *
from source_data

/*
    Uncomment the line below to remove records with null `id` values
*/

-- where id is not null
  );
  
[0m15:43:37.033851 [debug] [Thread-1  ]: SQL status: SELECT 2 in 0.0 seconds
[0m15:43:37.037592 [debug] [Thread-1  ]: Using postgres connection "model.pgmigrate.my_first_dbt_model"
[0m15:43:37.037871 [debug] [Thread-1  ]: On model.pgmigrate.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.8.1", "profile_name": "pgmigrate", "target_name": "dev", "node_id": "model.pgmigrate.my_first_dbt_model"} */
alter table "postgres"."public"."my_first_dbt_model" rename to "my_first_dbt_model__dbt_backup"
[0m15:43:37.038353 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.0 seconds
[0m15:43:37.040317 [debug] [Thread-1  ]: Using postgres connection "model.pgmigrate.my_first_dbt_model"
[0m15:43:37.040554 [debug] [Thread-1  ]: On model.pgmigrate.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.8.1", "profile_name": "pgmigrate", "target_name": "dev", "node_id": "model.pgmigrate.my_first_dbt_model"} */
alter table "postgres"."public"."my_first_dbt_model__dbt_tmp" rename to "my_first_dbt_model"
[0m15:43:37.041138 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.0 seconds
[0m15:43:37.052125 [debug] [Thread-1  ]: On model.pgmigrate.my_first_dbt_model: COMMIT
[0m15:43:37.052374 [debug] [Thread-1  ]: Using postgres connection "model.pgmigrate.my_first_dbt_model"
[0m15:43:37.052593 [debug] [Thread-1  ]: On model.pgmigrate.my_first_dbt_model: COMMIT
[0m15:43:37.053500 [debug] [Thread-1  ]: SQL status: COMMIT in 0.0 seconds
[0m15:43:37.056906 [debug] [Thread-1  ]: Applying DROP to: "postgres"."public"."my_first_dbt_model__dbt_backup"
[0m15:43:37.059305 [debug] [Thread-1  ]: Using postgres connection "model.pgmigrate.my_first_dbt_model"
[0m15:43:37.059549 [debug] [Thread-1  ]: On model.pgmigrate.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.8.1", "profile_name": "pgmigrate", "target_name": "dev", "node_id": "model.pgmigrate.my_first_dbt_model"} */
drop table if exists "postgres"."public"."my_first_dbt_model__dbt_backup" cascade
[0m15:43:37.072699 [debug] [Thread-1  ]: SQL status: DROP TABLE in 0.0 seconds
[0m15:43:37.074118 [debug] [Thread-1  ]: On model.pgmigrate.my_first_dbt_model: Close
[0m15:43:37.074465 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '610a0b0c-6713-4e51-a2e6-480913ddf4fa', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107decee0>]}
[0m15:43:37.074829 [info ] [Thread-1  ]: 1 of 7 OK created sql table model public.my_first_dbt_model .................... [[32mSELECT 2[0m in 0.08s]
[0m15:43:37.075207 [debug] [Thread-1  ]: Finished running node model.pgmigrate.my_first_dbt_model
[0m15:43:37.075678 [debug] [Thread-2  ]: Began running node test.pgmigrate.not_null_my_first_dbt_model_id.5fb22c2710
[0m15:43:37.075935 [debug] [Thread-1  ]: Began running node test.pgmigrate.unique_my_first_dbt_model_id.16e066b321
[0m15:43:37.076222 [info ] [Thread-2  ]: 3 of 7 START test not_null_my_first_dbt_model_id ............................... [RUN]
[0m15:43:37.076548 [info ] [Thread-1  ]: 4 of 7 START test unique_my_first_dbt_model_id ................................. [RUN]
[0m15:43:37.076881 [debug] [Thread-2  ]: Re-using an available connection from the pool (formerly model.pgmigrate.users_dbt_model, now test.pgmigrate.not_null_my_first_dbt_model_id.5fb22c2710)
[0m15:43:37.077149 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.pgmigrate.my_first_dbt_model, now test.pgmigrate.unique_my_first_dbt_model_id.16e066b321)
[0m15:43:37.077388 [debug] [Thread-2  ]: Began compiling node test.pgmigrate.not_null_my_first_dbt_model_id.5fb22c2710
[0m15:43:37.077619 [debug] [Thread-1  ]: Began compiling node test.pgmigrate.unique_my_first_dbt_model_id.16e066b321
[0m15:43:37.085408 [debug] [Thread-2  ]: Writing injected SQL for node "test.pgmigrate.not_null_my_first_dbt_model_id.5fb22c2710"
[0m15:43:37.089293 [debug] [Thread-1  ]: Writing injected SQL for node "test.pgmigrate.unique_my_first_dbt_model_id.16e066b321"
[0m15:43:37.089833 [debug] [Thread-2  ]: Began executing node test.pgmigrate.not_null_my_first_dbt_model_id.5fb22c2710
[0m15:43:37.090130 [debug] [Thread-1  ]: Began executing node test.pgmigrate.unique_my_first_dbt_model_id.16e066b321
[0m15:43:37.098850 [debug] [Thread-2  ]: Writing runtime sql for node "test.pgmigrate.not_null_my_first_dbt_model_id.5fb22c2710"
[0m15:43:37.100585 [debug] [Thread-1  ]: Writing runtime sql for node "test.pgmigrate.unique_my_first_dbt_model_id.16e066b321"
[0m15:43:37.101117 [debug] [Thread-2  ]: Using postgres connection "test.pgmigrate.not_null_my_first_dbt_model_id.5fb22c2710"
[0m15:43:37.101401 [debug] [Thread-1  ]: Using postgres connection "test.pgmigrate.unique_my_first_dbt_model_id.16e066b321"
[0m15:43:37.101664 [debug] [Thread-2  ]: On test.pgmigrate.not_null_my_first_dbt_model_id.5fb22c2710: BEGIN
[0m15:43:37.101908 [debug] [Thread-1  ]: On test.pgmigrate.unique_my_first_dbt_model_id.16e066b321: BEGIN
[0m15:43:37.102163 [debug] [Thread-2  ]: Opening a new connection, currently in state closed
[0m15:43:37.102405 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m15:43:37.108290 [debug] [Thread-1  ]: SQL status: BEGIN in 0.0 seconds
[0m15:43:37.108557 [debug] [Thread-2  ]: SQL status: BEGIN in 0.0 seconds
[0m15:43:37.108834 [debug] [Thread-1  ]: Using postgres connection "test.pgmigrate.unique_my_first_dbt_model_id.16e066b321"
[0m15:43:37.109106 [debug] [Thread-2  ]: Using postgres connection "test.pgmigrate.not_null_my_first_dbt_model_id.5fb22c2710"
[0m15:43:37.109393 [debug] [Thread-1  ]: On test.pgmigrate.unique_my_first_dbt_model_id.16e066b321: /* {"app": "dbt", "dbt_version": "1.8.1", "profile_name": "pgmigrate", "target_name": "dev", "node_id": "test.pgmigrate.unique_my_first_dbt_model_id.16e066b321"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

select
    id as unique_field,
    count(*) as n_records

from "postgres"."public"."my_first_dbt_model"
where id is not null
group by id
having count(*) > 1



      
    ) dbt_internal_test
[0m15:43:37.109675 [debug] [Thread-2  ]: On test.pgmigrate.not_null_my_first_dbt_model_id.5fb22c2710: /* {"app": "dbt", "dbt_version": "1.8.1", "profile_name": "pgmigrate", "target_name": "dev", "node_id": "test.pgmigrate.not_null_my_first_dbt_model_id.5fb22c2710"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select id
from "postgres"."public"."my_first_dbt_model"
where id is null



      
    ) dbt_internal_test
[0m15:43:37.111181 [debug] [Thread-2  ]: SQL status: SELECT 1 in 0.0 seconds
[0m15:43:37.113312 [debug] [Thread-2  ]: On test.pgmigrate.not_null_my_first_dbt_model_id.5fb22c2710: ROLLBACK
[0m15:43:37.117228 [debug] [Thread-2  ]: On test.pgmigrate.not_null_my_first_dbt_model_id.5fb22c2710: Close
[0m15:43:37.117678 [error] [Thread-2  ]: 3 of 7 FAIL 1 not_null_my_first_dbt_model_id ................................... [[31mFAIL 1[0m in 0.04s]
[0m15:43:37.118106 [debug] [Thread-2  ]: Finished running node test.pgmigrate.not_null_my_first_dbt_model_id.5fb22c2710
[0m15:43:37.122976 [debug] [Thread-1  ]: SQL status: SELECT 1 in 0.0 seconds
[0m15:43:37.123816 [debug] [Thread-1  ]: On test.pgmigrate.unique_my_first_dbt_model_id.16e066b321: ROLLBACK
[0m15:43:37.124198 [debug] [Thread-1  ]: On test.pgmigrate.unique_my_first_dbt_model_id.16e066b321: Close
[0m15:43:37.124563 [info ] [Thread-1  ]: 4 of 7 PASS unique_my_first_dbt_model_id ....................................... [[32mPASS[0m in 0.05s]
[0m15:43:37.124908 [debug] [Thread-1  ]: Finished running node test.pgmigrate.unique_my_first_dbt_model_id.16e066b321
[0m15:43:37.125359 [debug] [Thread-2  ]: Began running node model.pgmigrate.my_second_dbt_model
[0m15:43:37.125655 [info ] [Thread-2  ]: 5 of 7 SKIP relation public.my_second_dbt_model ................................ [[33mSKIP[0m]
[0m15:43:37.125939 [debug] [Thread-2  ]: Finished running node model.pgmigrate.my_second_dbt_model
[0m15:43:37.126336 [debug] [Thread-1  ]: Began running node test.pgmigrate.not_null_my_second_dbt_model_id.151b76d778
[0m15:43:37.126607 [debug] [Thread-2  ]: Began running node test.pgmigrate.unique_my_second_dbt_model_id.57a0f8c493
[0m15:43:37.126912 [info ] [Thread-1  ]: 6 of 7 SKIP test not_null_my_second_dbt_model_id ............................... [[33mSKIP[0m]
[0m15:43:37.127208 [info ] [Thread-2  ]: 7 of 7 SKIP test unique_my_second_dbt_model_id ................................. [[33mSKIP[0m]
[0m15:43:37.127497 [debug] [Thread-1  ]: Finished running node test.pgmigrate.not_null_my_second_dbt_model_id.151b76d778
[0m15:43:37.127739 [debug] [Thread-2  ]: Finished running node test.pgmigrate.unique_my_second_dbt_model_id.57a0f8c493
[0m15:43:37.128381 [debug] [MainThread]: Using postgres connection "master"
[0m15:43:37.128595 [debug] [MainThread]: On master: BEGIN
[0m15:43:37.128779 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m15:43:37.132651 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m15:43:37.132899 [debug] [MainThread]: On master: COMMIT
[0m15:43:37.133119 [debug] [MainThread]: Using postgres connection "master"
[0m15:43:37.133315 [debug] [MainThread]: On master: COMMIT
[0m15:43:37.133644 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m15:43:37.133842 [debug] [MainThread]: On master: Close
[0m15:43:37.134156 [debug] [MainThread]: Connection 'master' was properly closed.
[0m15:43:37.134355 [debug] [MainThread]: Connection 'test.pgmigrate.unique_my_first_dbt_model_id.16e066b321' was properly closed.
[0m15:43:37.134555 [debug] [MainThread]: Connection 'test.pgmigrate.not_null_my_first_dbt_model_id.5fb22c2710' was properly closed.
[0m15:43:37.134845 [info ] [MainThread]: 
[0m15:43:37.135114 [info ] [MainThread]: Finished running 2 view models, 1 table model, 4 data tests in 0 hours 0 minutes and 0.25 seconds (0.25s).
[0m15:43:37.135719 [debug] [MainThread]: Command end result
[0m15:43:37.155404 [info ] [MainThread]: 
[0m15:43:37.155742 [info ] [MainThread]: [31mCompleted with 2 errors and 0 warnings:[0m
[0m15:43:37.155971 [info ] [MainThread]: 
[0m15:43:37.156237 [error] [MainThread]:   Compilation Error in model users_dbt_model (models/example/users_dbt_model.sql)
  'jsonb_extract_path_text' is undefined. This can happen when calling a macro that does not exist. Check for typos and/or install package dependencies with "dbt deps".
[0m15:43:37.156459 [info ] [MainThread]: 
[0m15:43:37.156708 [error] [MainThread]: [31mFailure in test not_null_my_first_dbt_model_id (models/example/schema.yml)[0m
[0m15:43:37.156945 [error] [MainThread]:   Got 1 result, configured to fail if != 0
[0m15:43:37.157147 [info ] [MainThread]: 
[0m15:43:37.157378 [info ] [MainThread]:   compiled code at target/compiled/pgmigrate/models/example/schema.yml/not_null_my_first_dbt_model_id.sql
[0m15:43:37.157592 [info ] [MainThread]: 
[0m15:43:37.157809 [info ] [MainThread]: Done. PASS=2 WARN=0 ERROR=2 SKIP=3 TOTAL=7
[0m15:43:37.159147 [debug] [MainThread]: Resource report: {"command_name": "build", "command_wall_clock_time": 0.6787236, "process_user_time": 1.027596, "process_kernel_time": 0.127173, "process_mem_max_rss": "116932608", "command_success": false, "process_in_blocks": "0", "process_out_blocks": "0"}
[0m15:43:37.159482 [debug] [MainThread]: Command `dbt build` failed at 15:43:37.159440 after 0.68 seconds
[0m15:43:37.159732 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104c56a00>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1066379a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107f50700>]}
[0m15:43:37.159967 [debug] [MainThread]: Flushing usage events
[0m15:47:27.280964 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10650ba90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108520eb0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108520730>]}


============================== 15:47:27.283511 | 0770761d-22a9-4325-b526-0e7c1331a8b7 ==============================
[0m15:47:27.283511 [info ] [MainThread]: Running with dbt=1.8.1
[0m15:47:27.283921 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/Users/shrikanth/Shrikanth/dbt-helloworld', 'version_check': 'True', 'warn_error': 'None', 'log_path': '/Users/shrikanth/Shrikanth/dbt-helloworld/logs', 'fail_fast': 'False', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'introspect': 'True', 'static_parser': 'True', 'invocation_command': 'dbt build', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m15:47:27.437184 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '0770761d-22a9-4325-b526-0e7c1331a8b7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108974790>]}
[0m15:47:27.464929 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '0770761d-22a9-4325-b526-0e7c1331a8b7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10887efa0>]}
[0m15:47:27.465554 [info ] [MainThread]: Registered adapter: postgres=1.8.1
[0m15:47:27.479602 [debug] [MainThread]: checksum: ebc509fb14e151ea268e89b60fd5abf912ed99129f87516462718fa2f14f4838, vars: {}, profile: , target: , version: 1.8.1
[0m15:47:27.568924 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m15:47:27.569332 [debug] [MainThread]: Partial parsing: updated file: pgmigrate://models/example/users_dbt_model.sql
[0m15:47:27.692261 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '0770761d-22a9-4325-b526-0e7c1331a8b7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x109196130>]}
[0m15:47:27.758509 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '0770761d-22a9-4325-b526-0e7c1331a8b7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x109012130>]}
[0m15:47:27.758846 [info ] [MainThread]: Found 3 models, 4 data tests, 527 macros
[0m15:47:27.759846 [info ] [MainThread]: 
[0m15:47:27.760211 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m15:47:27.762344 [debug] [ThreadPool]: Acquiring new postgres connection 'list_postgres'
[0m15:47:27.762664 [debug] [ThreadPool]: Acquiring new postgres connection 'list_postgres'
[0m15:47:27.791336 [debug] [ThreadPool]: Using postgres connection "list_postgres"
[0m15:47:27.791607 [debug] [ThreadPool]: Using postgres connection "list_postgres"
[0m15:47:27.791859 [debug] [ThreadPool]: On list_postgres: /* {"app": "dbt", "dbt_version": "1.8.1", "profile_name": "pgmigrate", "target_name": "dev", "connection_name": "list_postgres"} */

    select distinct nspname from pg_namespace
  
[0m15:47:27.792089 [debug] [ThreadPool]: On list_postgres: /* {"app": "dbt", "dbt_version": "1.8.1", "profile_name": "pgmigrate", "target_name": "dev", "connection_name": "list_postgres"} */

    select distinct nspname from pg_namespace
  
[0m15:47:27.792306 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m15:47:27.792507 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m15:47:27.886192 [debug] [ThreadPool]: SQL status: SELECT 18 in 0.0 seconds
[0m15:47:27.886571 [debug] [ThreadPool]: SQL status: SELECT 18 in 0.0 seconds
[0m15:47:27.887597 [debug] [ThreadPool]: On list_postgres: Close
[0m15:47:27.888491 [debug] [ThreadPool]: On list_postgres: Close
[0m15:47:27.889596 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_postgres, now list_postgres_public__airbyte_quarantine)
[0m15:47:27.890024 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_postgres, now list_postgres_public)
[0m15:47:27.895151 [debug] [ThreadPool]: Using postgres connection "list_postgres_public__airbyte_quarantine"
[0m15:47:27.896973 [debug] [ThreadPool]: Using postgres connection "list_postgres_public"
[0m15:47:27.897288 [debug] [ThreadPool]: On list_postgres_public__airbyte_quarantine: BEGIN
[0m15:47:27.897566 [debug] [ThreadPool]: On list_postgres_public: BEGIN
[0m15:47:27.897824 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m15:47:27.898076 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m15:47:27.901956 [debug] [ThreadPool]: SQL status: BEGIN in 0.0 seconds
[0m15:47:27.902240 [debug] [ThreadPool]: SQL status: BEGIN in 0.0 seconds
[0m15:47:27.902535 [debug] [ThreadPool]: Using postgres connection "list_postgres_public"
[0m15:47:27.902809 [debug] [ThreadPool]: Using postgres connection "list_postgres_public__airbyte_quarantine"
[0m15:47:27.903098 [debug] [ThreadPool]: On list_postgres_public: /* {"app": "dbt", "dbt_version": "1.8.1", "profile_name": "pgmigrate", "target_name": "dev", "connection_name": "list_postgres_public"} */
select
      'postgres' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'postgres' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
    union all
    select
      'postgres' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public'
  
[0m15:47:27.903403 [debug] [ThreadPool]: On list_postgres_public__airbyte_quarantine: /* {"app": "dbt", "dbt_version": "1.8.1", "profile_name": "pgmigrate", "target_name": "dev", "connection_name": "list_postgres_public__airbyte_quarantine"} */
select
      'postgres' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public__airbyte_quarantine'
    union all
    select
      'postgres' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public__airbyte_quarantine'
    union all
    select
      'postgres' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public__airbyte_quarantine'
  
[0m15:47:27.909119 [debug] [ThreadPool]: SQL status: SELECT 0 in 0.0 seconds
[0m15:47:27.909388 [debug] [ThreadPool]: SQL status: SELECT 5 in 0.0 seconds
[0m15:47:27.910225 [debug] [ThreadPool]: On list_postgres_public__airbyte_quarantine: ROLLBACK
[0m15:47:27.911094 [debug] [ThreadPool]: On list_postgres_public: ROLLBACK
[0m15:47:27.911508 [debug] [ThreadPool]: On list_postgres_public__airbyte_quarantine: Close
[0m15:47:27.911750 [debug] [ThreadPool]: On list_postgres_public: Close
[0m15:47:27.915665 [debug] [MainThread]: Using postgres connection "master"
[0m15:47:27.915986 [debug] [MainThread]: On master: BEGIN
[0m15:47:27.916251 [debug] [MainThread]: Opening a new connection, currently in state init
[0m15:47:27.921604 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m15:47:27.921894 [debug] [MainThread]: Using postgres connection "master"
[0m15:47:27.922233 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.8.1", "profile_name": "pgmigrate", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m15:47:27.990765 [debug] [MainThread]: SQL status: SELECT 1 in 0.0 seconds
[0m15:47:27.991933 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '0770761d-22a9-4325-b526-0e7c1331a8b7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10930ce20>]}
[0m15:47:27.992304 [debug] [MainThread]: On master: ROLLBACK
[0m15:47:27.992712 [debug] [MainThread]: Using postgres connection "master"
[0m15:47:27.992980 [debug] [MainThread]: On master: BEGIN
[0m15:47:27.993390 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m15:47:27.993613 [debug] [MainThread]: On master: COMMIT
[0m15:47:27.993827 [debug] [MainThread]: Using postgres connection "master"
[0m15:47:27.994036 [debug] [MainThread]: On master: COMMIT
[0m15:47:27.994314 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m15:47:27.994543 [debug] [MainThread]: On master: Close
[0m15:47:27.994863 [info ] [MainThread]: Concurrency: 2 threads (target='dev')
[0m15:47:27.995107 [info ] [MainThread]: 
[0m15:47:27.996364 [debug] [Thread-1  ]: Began running node model.pgmigrate.my_first_dbt_model
[0m15:47:27.996629 [debug] [Thread-2  ]: Began running node model.pgmigrate.users_dbt_model
[0m15:47:27.996978 [info ] [Thread-1  ]: 1 of 7 START sql table model public.my_first_dbt_model ......................... [RUN]
[0m15:47:27.997308 [info ] [Thread-2  ]: 2 of 7 START sql view model public__airbyte_quarantine.users_scalar ............ [RUN]
[0m15:47:27.997646 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly list_postgres_public__airbyte_quarantine, now model.pgmigrate.my_first_dbt_model)
[0m15:47:27.997914 [debug] [Thread-2  ]: Re-using an available connection from the pool (formerly list_postgres_public, now model.pgmigrate.users_dbt_model)
[0m15:47:27.998163 [debug] [Thread-1  ]: Began compiling node model.pgmigrate.my_first_dbt_model
[0m15:47:27.998410 [debug] [Thread-2  ]: Began compiling node model.pgmigrate.users_dbt_model
[0m15:47:28.003719 [debug] [Thread-1  ]: Writing injected SQL for node "model.pgmigrate.my_first_dbt_model"
[0m15:47:28.007506 [debug] [Thread-1  ]: Began executing node model.pgmigrate.my_first_dbt_model
[0m15:47:28.032771 [debug] [Thread-1  ]: Writing runtime sql for node "model.pgmigrate.my_first_dbt_model"
[0m15:47:28.033323 [debug] [Thread-1  ]: Using postgres connection "model.pgmigrate.my_first_dbt_model"
[0m15:47:28.033591 [debug] [Thread-1  ]: On model.pgmigrate.my_first_dbt_model: BEGIN
[0m15:47:28.033843 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m15:47:28.036367 [debug] [Thread-2  ]: Compilation Error in model users_dbt_model (models/example/users_dbt_model.sql)
  '_airbyte_data' is undefined. This can happen when calling a macro that does not exist. Check for typos and/or install package dependencies with "dbt deps".
[0m15:47:28.037201 [debug] [Thread-2  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '0770761d-22a9-4325-b526-0e7c1331a8b7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1079315e0>]}
[0m15:47:28.037578 [error] [Thread-2  ]: 2 of 7 ERROR creating sql view model public__airbyte_quarantine.users_scalar ... [[31mERROR[0m in 0.04s]
[0m15:47:28.038011 [debug] [Thread-2  ]: Finished running node model.pgmigrate.users_dbt_model
[0m15:47:28.038264 [debug] [Thread-1  ]: SQL status: BEGIN in 0.0 seconds
[0m15:47:28.038639 [debug] [Thread-1  ]: Using postgres connection "model.pgmigrate.my_first_dbt_model"
[0m15:47:28.038926 [debug] [Thread-1  ]: On model.pgmigrate.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.8.1", "profile_name": "pgmigrate", "target_name": "dev", "node_id": "model.pgmigrate.my_first_dbt_model"} */

  
    

  create  table "postgres"."public"."my_first_dbt_model__dbt_tmp"
  
  
    as
  
  (
    /*
    Welcome to your first dbt model!
    Did you know that you can also configure models directly within SQL files?
    This will override configurations stated in dbt_project.yml

    Try changing "table" to "view" below
*/



with source_data as (

    select 1 as id
    union all
    select null as id

)

select *
from source_data

/*
    Uncomment the line below to remove records with null `id` values
*/

-- where id is not null
  );
  
[0m15:47:28.041112 [debug] [Thread-1  ]: SQL status: SELECT 2 in 0.0 seconds
[0m15:47:28.045103 [debug] [Thread-1  ]: Using postgres connection "model.pgmigrate.my_first_dbt_model"
[0m15:47:28.045429 [debug] [Thread-1  ]: On model.pgmigrate.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.8.1", "profile_name": "pgmigrate", "target_name": "dev", "node_id": "model.pgmigrate.my_first_dbt_model"} */
alter table "postgres"."public"."my_first_dbt_model" rename to "my_first_dbt_model__dbt_backup"
[0m15:47:28.046190 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.0 seconds
[0m15:47:28.048317 [debug] [Thread-1  ]: Using postgres connection "model.pgmigrate.my_first_dbt_model"
[0m15:47:28.048574 [debug] [Thread-1  ]: On model.pgmigrate.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.8.1", "profile_name": "pgmigrate", "target_name": "dev", "node_id": "model.pgmigrate.my_first_dbt_model"} */
alter table "postgres"."public"."my_first_dbt_model__dbt_tmp" rename to "my_first_dbt_model"
[0m15:47:28.049508 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.0 seconds
[0m15:47:28.061580 [debug] [Thread-1  ]: On model.pgmigrate.my_first_dbt_model: COMMIT
[0m15:47:28.061867 [debug] [Thread-1  ]: Using postgres connection "model.pgmigrate.my_first_dbt_model"
[0m15:47:28.062112 [debug] [Thread-1  ]: On model.pgmigrate.my_first_dbt_model: COMMIT
[0m15:47:28.062816 [debug] [Thread-1  ]: SQL status: COMMIT in 0.0 seconds
[0m15:47:28.066543 [debug] [Thread-1  ]: Applying DROP to: "postgres"."public"."my_first_dbt_model__dbt_backup"
[0m15:47:28.069082 [debug] [Thread-1  ]: Using postgres connection "model.pgmigrate.my_first_dbt_model"
[0m15:47:28.069337 [debug] [Thread-1  ]: On model.pgmigrate.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.8.1", "profile_name": "pgmigrate", "target_name": "dev", "node_id": "model.pgmigrate.my_first_dbt_model"} */
drop table if exists "postgres"."public"."my_first_dbt_model__dbt_backup" cascade
[0m15:47:28.072853 [debug] [Thread-1  ]: SQL status: DROP TABLE in 0.0 seconds
[0m15:47:28.074133 [debug] [Thread-1  ]: On model.pgmigrate.my_first_dbt_model: Close
[0m15:47:28.074476 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '0770761d-22a9-4325-b526-0e7c1331a8b7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10984fc10>]}
[0m15:47:28.074855 [info ] [Thread-1  ]: 1 of 7 OK created sql table model public.my_first_dbt_model .................... [[32mSELECT 2[0m in 0.08s]
[0m15:47:28.075229 [debug] [Thread-1  ]: Finished running node model.pgmigrate.my_first_dbt_model
[0m15:47:28.075707 [debug] [Thread-2  ]: Began running node test.pgmigrate.not_null_my_first_dbt_model_id.5fb22c2710
[0m15:47:28.075993 [debug] [Thread-1  ]: Began running node test.pgmigrate.unique_my_first_dbt_model_id.16e066b321
[0m15:47:28.076243 [info ] [Thread-2  ]: 3 of 7 START test not_null_my_first_dbt_model_id ............................... [RUN]
[0m15:47:28.076525 [info ] [Thread-1  ]: 4 of 7 START test unique_my_first_dbt_model_id ................................. [RUN]
[0m15:47:28.076819 [debug] [Thread-2  ]: Re-using an available connection from the pool (formerly model.pgmigrate.users_dbt_model, now test.pgmigrate.not_null_my_first_dbt_model_id.5fb22c2710)
[0m15:47:28.077071 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.pgmigrate.my_first_dbt_model, now test.pgmigrate.unique_my_first_dbt_model_id.16e066b321)
[0m15:47:28.077303 [debug] [Thread-2  ]: Began compiling node test.pgmigrate.not_null_my_first_dbt_model_id.5fb22c2710
[0m15:47:28.077527 [debug] [Thread-1  ]: Began compiling node test.pgmigrate.unique_my_first_dbt_model_id.16e066b321
[0m15:47:28.084317 [debug] [Thread-2  ]: Writing injected SQL for node "test.pgmigrate.not_null_my_first_dbt_model_id.5fb22c2710"
[0m15:47:28.111930 [debug] [Thread-1  ]: Writing injected SQL for node "test.pgmigrate.unique_my_first_dbt_model_id.16e066b321"
[0m15:47:28.112667 [debug] [Thread-2  ]: Began executing node test.pgmigrate.not_null_my_first_dbt_model_id.5fb22c2710
[0m15:47:28.112932 [debug] [Thread-1  ]: Began executing node test.pgmigrate.unique_my_first_dbt_model_id.16e066b321
[0m15:47:28.121157 [debug] [Thread-2  ]: Writing runtime sql for node "test.pgmigrate.not_null_my_first_dbt_model_id.5fb22c2710"
[0m15:47:28.122739 [debug] [Thread-1  ]: Writing runtime sql for node "test.pgmigrate.unique_my_first_dbt_model_id.16e066b321"
[0m15:47:28.123200 [debug] [Thread-2  ]: Using postgres connection "test.pgmigrate.not_null_my_first_dbt_model_id.5fb22c2710"
[0m15:47:28.123457 [debug] [Thread-2  ]: On test.pgmigrate.not_null_my_first_dbt_model_id.5fb22c2710: BEGIN
[0m15:47:28.123712 [debug] [Thread-1  ]: Using postgres connection "test.pgmigrate.unique_my_first_dbt_model_id.16e066b321"
[0m15:47:28.123948 [debug] [Thread-2  ]: Opening a new connection, currently in state closed
[0m15:47:28.124185 [debug] [Thread-1  ]: On test.pgmigrate.unique_my_first_dbt_model_id.16e066b321: BEGIN
[0m15:47:28.124534 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m15:47:28.139366 [debug] [Thread-2  ]: SQL status: BEGIN in 0.0 seconds
[0m15:47:28.139669 [debug] [Thread-2  ]: Using postgres connection "test.pgmigrate.not_null_my_first_dbt_model_id.5fb22c2710"
[0m15:47:28.139910 [debug] [Thread-2  ]: On test.pgmigrate.not_null_my_first_dbt_model_id.5fb22c2710: /* {"app": "dbt", "dbt_version": "1.8.1", "profile_name": "pgmigrate", "target_name": "dev", "node_id": "test.pgmigrate.not_null_my_first_dbt_model_id.5fb22c2710"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select id
from "postgres"."public"."my_first_dbt_model"
where id is null



      
    ) dbt_internal_test
[0m15:47:28.140523 [debug] [Thread-1  ]: SQL status: BEGIN in 0.0 seconds
[0m15:47:28.140758 [debug] [Thread-1  ]: Using postgres connection "test.pgmigrate.unique_my_first_dbt_model_id.16e066b321"
[0m15:47:28.141012 [debug] [Thread-1  ]: On test.pgmigrate.unique_my_first_dbt_model_id.16e066b321: /* {"app": "dbt", "dbt_version": "1.8.1", "profile_name": "pgmigrate", "target_name": "dev", "node_id": "test.pgmigrate.unique_my_first_dbt_model_id.16e066b321"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

select
    id as unique_field,
    count(*) as n_records

from "postgres"."public"."my_first_dbt_model"
where id is not null
group by id
having count(*) > 1



      
    ) dbt_internal_test
[0m15:47:28.142650 [debug] [Thread-2  ]: SQL status: SELECT 1 in 0.0 seconds
[0m15:47:28.144609 [debug] [Thread-2  ]: On test.pgmigrate.not_null_my_first_dbt_model_id.5fb22c2710: ROLLBACK
[0m15:47:28.144877 [debug] [Thread-1  ]: SQL status: SELECT 1 in 0.0 seconds
[0m15:47:28.145688 [debug] [Thread-1  ]: On test.pgmigrate.unique_my_first_dbt_model_id.16e066b321: ROLLBACK
[0m15:47:28.145948 [debug] [Thread-2  ]: On test.pgmigrate.not_null_my_first_dbt_model_id.5fb22c2710: Close
[0m15:47:28.146181 [debug] [Thread-1  ]: On test.pgmigrate.unique_my_first_dbt_model_id.16e066b321: Close
[0m15:47:28.146568 [error] [Thread-2  ]: 3 of 7 FAIL 1 not_null_my_first_dbt_model_id ................................... [[31mFAIL 1[0m in 0.07s]
[0m15:47:28.146944 [info ] [Thread-1  ]: 4 of 7 PASS unique_my_first_dbt_model_id ....................................... [[32mPASS[0m in 0.07s]
[0m15:47:28.147310 [debug] [Thread-2  ]: Finished running node test.pgmigrate.not_null_my_first_dbt_model_id.5fb22c2710
[0m15:47:28.147624 [debug] [Thread-1  ]: Finished running node test.pgmigrate.unique_my_first_dbt_model_id.16e066b321
[0m15:47:28.148178 [debug] [Thread-2  ]: Began running node model.pgmigrate.my_second_dbt_model
[0m15:47:28.148482 [info ] [Thread-2  ]: 5 of 7 SKIP relation public.my_second_dbt_model ................................ [[33mSKIP[0m]
[0m15:47:28.148760 [debug] [Thread-2  ]: Finished running node model.pgmigrate.my_second_dbt_model
[0m15:47:28.149159 [debug] [Thread-1  ]: Began running node test.pgmigrate.not_null_my_second_dbt_model_id.151b76d778
[0m15:47:28.149396 [debug] [Thread-2  ]: Began running node test.pgmigrate.unique_my_second_dbt_model_id.57a0f8c493
[0m15:47:28.149663 [info ] [Thread-1  ]: 6 of 7 SKIP test not_null_my_second_dbt_model_id ............................... [[33mSKIP[0m]
[0m15:47:28.149952 [info ] [Thread-2  ]: 7 of 7 SKIP test unique_my_second_dbt_model_id ................................. [[33mSKIP[0m]
[0m15:47:28.150246 [debug] [Thread-1  ]: Finished running node test.pgmigrate.not_null_my_second_dbt_model_id.151b76d778
[0m15:47:28.150505 [debug] [Thread-2  ]: Finished running node test.pgmigrate.unique_my_second_dbt_model_id.57a0f8c493
[0m15:47:28.151111 [debug] [MainThread]: Using postgres connection "master"
[0m15:47:28.151336 [debug] [MainThread]: On master: BEGIN
[0m15:47:28.151537 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m15:47:28.155350 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m15:47:28.155597 [debug] [MainThread]: On master: COMMIT
[0m15:47:28.155854 [debug] [MainThread]: Using postgres connection "master"
[0m15:47:28.156141 [debug] [MainThread]: On master: COMMIT
[0m15:47:28.156455 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m15:47:28.156670 [debug] [MainThread]: On master: Close
[0m15:47:28.156952 [debug] [MainThread]: Connection 'master' was properly closed.
[0m15:47:28.157173 [debug] [MainThread]: Connection 'test.pgmigrate.unique_my_first_dbt_model_id.16e066b321' was properly closed.
[0m15:47:28.157358 [debug] [MainThread]: Connection 'test.pgmigrate.not_null_my_first_dbt_model_id.5fb22c2710' was properly closed.
[0m15:47:28.157658 [info ] [MainThread]: 
[0m15:47:28.157935 [info ] [MainThread]: Finished running 2 view models, 1 table model, 4 data tests in 0 hours 0 minutes and 0.40 seconds (0.40s).
[0m15:47:28.158580 [debug] [MainThread]: Command end result
[0m15:47:28.178165 [info ] [MainThread]: 
[0m15:47:28.178479 [info ] [MainThread]: [31mCompleted with 2 errors and 0 warnings:[0m
[0m15:47:28.178706 [info ] [MainThread]: 
[0m15:47:28.178973 [error] [MainThread]:   Compilation Error in model users_dbt_model (models/example/users_dbt_model.sql)
  '_airbyte_data' is undefined. This can happen when calling a macro that does not exist. Check for typos and/or install package dependencies with "dbt deps".
[0m15:47:28.179198 [info ] [MainThread]: 
[0m15:47:28.179451 [error] [MainThread]: [31mFailure in test not_null_my_first_dbt_model_id (models/example/schema.yml)[0m
[0m15:47:28.179693 [error] [MainThread]:   Got 1 result, configured to fail if != 0
[0m15:47:28.179897 [info ] [MainThread]: 
[0m15:47:28.180134 [info ] [MainThread]:   compiled code at target/compiled/pgmigrate/models/example/schema.yml/not_null_my_first_dbt_model_id.sql
[0m15:47:28.180351 [info ] [MainThread]: 
[0m15:47:28.180575 [info ] [MainThread]: Done. PASS=2 WARN=0 ERROR=2 SKIP=3 TOTAL=7
[0m15:47:28.182163 [debug] [MainThread]: Resource report: {"command_name": "build", "command_wall_clock_time": 0.93936473, "process_user_time": 1.137361, "process_kernel_time": 0.133133, "process_mem_max_rss": "118685696", "command_success": false, "process_in_blocks": "0", "process_out_blocks": "0"}
[0m15:47:28.182514 [debug] [MainThread]: Command `dbt build` failed at 15:47:28.182468 after 0.94 seconds
[0m15:47:28.182780 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10650ba90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1092f29d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1092f25e0>]}
[0m15:47:28.183027 [debug] [MainThread]: Flushing usage events
[0m15:47:50.361867 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106f20a60>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1120ece80>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1120ec700>]}


============================== 15:47:50.364265 | 7699e08f-3de8-42f0-a6cb-97d53f89099e ==============================
[0m15:47:50.364265 [info ] [MainThread]: Running with dbt=1.8.1
[0m15:47:50.364647 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/Users/shrikanth/Shrikanth/dbt-helloworld', 'debug': 'False', 'version_check': 'True', 'log_path': '/Users/shrikanth/Shrikanth/dbt-helloworld/logs', 'warn_error': 'None', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'static_parser': 'True', 'invocation_command': 'dbt build', 'introspect': 'True', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m15:47:50.476283 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '7699e08f-3de8-42f0-a6cb-97d53f89099e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1124a0700>]}
[0m15:47:50.505546 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '7699e08f-3de8-42f0-a6cb-97d53f89099e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1105bca30>]}
[0m15:47:50.506921 [info ] [MainThread]: Registered adapter: postgres=1.8.1
[0m15:47:50.519227 [debug] [MainThread]: checksum: ebc509fb14e151ea268e89b60fd5abf912ed99129f87516462718fa2f14f4838, vars: {}, profile: , target: , version: 1.8.1
[0m15:47:50.607380 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m15:47:50.607831 [debug] [MainThread]: Partial parsing: updated file: pgmigrate://models/example/users_dbt_model.sql
[0m15:47:50.731868 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '7699e08f-3de8-42f0-a6cb-97d53f89099e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x112fb7130>]}
[0m15:47:50.795500 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '7699e08f-3de8-42f0-a6cb-97d53f89099e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x112fde6a0>]}
[0m15:47:50.795850 [info ] [MainThread]: Found 3 models, 4 data tests, 527 macros
[0m15:47:50.796835 [info ] [MainThread]: 
[0m15:47:50.797237 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m15:47:50.799408 [debug] [ThreadPool]: Acquiring new postgres connection 'list_postgres'
[0m15:47:50.799750 [debug] [ThreadPool]: Acquiring new postgres connection 'list_postgres'
[0m15:47:50.827099 [debug] [ThreadPool]: Using postgres connection "list_postgres"
[0m15:47:50.827377 [debug] [ThreadPool]: Using postgres connection "list_postgres"
[0m15:47:50.827621 [debug] [ThreadPool]: On list_postgres: /* {"app": "dbt", "dbt_version": "1.8.1", "profile_name": "pgmigrate", "target_name": "dev", "connection_name": "list_postgres"} */

    select distinct nspname from pg_namespace
  
[0m15:47:50.827848 [debug] [ThreadPool]: On list_postgres: /* {"app": "dbt", "dbt_version": "1.8.1", "profile_name": "pgmigrate", "target_name": "dev", "connection_name": "list_postgres"} */

    select distinct nspname from pg_namespace
  
[0m15:47:50.828069 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m15:47:50.828274 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m15:47:50.843043 [debug] [ThreadPool]: SQL status: SELECT 18 in 0.0 seconds
[0m15:47:50.843298 [debug] [ThreadPool]: SQL status: SELECT 18 in 0.0 seconds
[0m15:47:50.844103 [debug] [ThreadPool]: On list_postgres: Close
[0m15:47:50.844750 [debug] [ThreadPool]: On list_postgres: Close
[0m15:47:50.845603 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_postgres, now list_postgres_public__airbyte_quarantine)
[0m15:47:50.845965 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_postgres, now list_postgres_public)
[0m15:47:50.849725 [debug] [ThreadPool]: Using postgres connection "list_postgres_public__airbyte_quarantine"
[0m15:47:50.851108 [debug] [ThreadPool]: Using postgres connection "list_postgres_public"
[0m15:47:50.851340 [debug] [ThreadPool]: On list_postgres_public__airbyte_quarantine: BEGIN
[0m15:47:50.851577 [debug] [ThreadPool]: On list_postgres_public: BEGIN
[0m15:47:50.851791 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m15:47:50.851992 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m15:47:50.859270 [debug] [ThreadPool]: SQL status: BEGIN in 0.0 seconds
[0m15:47:50.859499 [debug] [ThreadPool]: SQL status: BEGIN in 0.0 seconds
[0m15:47:50.859716 [debug] [ThreadPool]: Using postgres connection "list_postgres_public"
[0m15:47:50.859928 [debug] [ThreadPool]: Using postgres connection "list_postgres_public__airbyte_quarantine"
[0m15:47:50.860148 [debug] [ThreadPool]: On list_postgres_public: /* {"app": "dbt", "dbt_version": "1.8.1", "profile_name": "pgmigrate", "target_name": "dev", "connection_name": "list_postgres_public"} */
select
      'postgres' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'postgres' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
    union all
    select
      'postgres' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public'
  
[0m15:47:50.860386 [debug] [ThreadPool]: On list_postgres_public__airbyte_quarantine: /* {"app": "dbt", "dbt_version": "1.8.1", "profile_name": "pgmigrate", "target_name": "dev", "connection_name": "list_postgres_public__airbyte_quarantine"} */
select
      'postgres' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public__airbyte_quarantine'
    union all
    select
      'postgres' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public__airbyte_quarantine'
    union all
    select
      'postgres' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public__airbyte_quarantine'
  
[0m15:47:50.866963 [debug] [ThreadPool]: SQL status: SELECT 0 in 0.0 seconds
[0m15:47:50.867176 [debug] [ThreadPool]: SQL status: SELECT 4 in 0.0 seconds
[0m15:47:50.867808 [debug] [ThreadPool]: On list_postgres_public__airbyte_quarantine: ROLLBACK
[0m15:47:50.868460 [debug] [ThreadPool]: On list_postgres_public: ROLLBACK
[0m15:47:50.868826 [debug] [ThreadPool]: On list_postgres_public: Close
[0m15:47:50.869029 [debug] [ThreadPool]: On list_postgres_public__airbyte_quarantine: Close
[0m15:47:50.871950 [debug] [MainThread]: Using postgres connection "master"
[0m15:47:50.872174 [debug] [MainThread]: On master: BEGIN
[0m15:47:50.872366 [debug] [MainThread]: Opening a new connection, currently in state init
[0m15:47:50.876629 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m15:47:50.876836 [debug] [MainThread]: Using postgres connection "master"
[0m15:47:50.877085 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.8.1", "profile_name": "pgmigrate", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m15:47:50.890920 [debug] [MainThread]: SQL status: SELECT 0 in 0.0 seconds
[0m15:47:50.891602 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '7699e08f-3de8-42f0-a6cb-97d53f89099e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x113259430>]}
[0m15:47:50.891893 [debug] [MainThread]: On master: ROLLBACK
[0m15:47:50.892248 [debug] [MainThread]: Using postgres connection "master"
[0m15:47:50.892465 [debug] [MainThread]: On master: BEGIN
[0m15:47:50.892845 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m15:47:50.893061 [debug] [MainThread]: On master: COMMIT
[0m15:47:50.893265 [debug] [MainThread]: Using postgres connection "master"
[0m15:47:50.893468 [debug] [MainThread]: On master: COMMIT
[0m15:47:50.893795 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m15:47:50.894007 [debug] [MainThread]: On master: Close
[0m15:47:50.894287 [info ] [MainThread]: Concurrency: 2 threads (target='dev')
[0m15:47:50.894511 [info ] [MainThread]: 
[0m15:47:50.895718 [debug] [Thread-1  ]: Began running node model.pgmigrate.my_first_dbt_model
[0m15:47:50.895986 [debug] [Thread-2  ]: Began running node model.pgmigrate.users_dbt_model
[0m15:47:50.896300 [info ] [Thread-1  ]: 1 of 7 START sql table model public.my_first_dbt_model ......................... [RUN]
[0m15:47:50.896621 [info ] [Thread-2  ]: 2 of 7 START sql view model public__airbyte_quarantine.users_scalar ............ [RUN]
[0m15:47:50.896913 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly list_postgres_public__airbyte_quarantine, now model.pgmigrate.my_first_dbt_model)
[0m15:47:50.897171 [debug] [Thread-2  ]: Re-using an available connection from the pool (formerly list_postgres_public, now model.pgmigrate.users_dbt_model)
[0m15:47:50.897411 [debug] [Thread-1  ]: Began compiling node model.pgmigrate.my_first_dbt_model
[0m15:47:50.897645 [debug] [Thread-2  ]: Began compiling node model.pgmigrate.users_dbt_model
[0m15:47:50.902366 [debug] [Thread-1  ]: Writing injected SQL for node "model.pgmigrate.my_first_dbt_model"
[0m15:47:50.905687 [debug] [Thread-1  ]: Began executing node model.pgmigrate.my_first_dbt_model
[0m15:47:50.928165 [debug] [Thread-1  ]: Writing runtime sql for node "model.pgmigrate.my_first_dbt_model"
[0m15:47:50.928629 [debug] [Thread-1  ]: Using postgres connection "model.pgmigrate.my_first_dbt_model"
[0m15:47:50.928945 [debug] [Thread-1  ]: On model.pgmigrate.my_first_dbt_model: BEGIN
[0m15:47:50.929202 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m15:47:50.931545 [debug] [Thread-2  ]: Compilation Error in model users_dbt_model (models/example/users_dbt_model.sql)
  '_airbyte_data' is undefined. This can happen when calling a macro that does not exist. Check for typos and/or install package dependencies with "dbt deps".
[0m15:47:50.932362 [debug] [Thread-2  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '7699e08f-3de8-42f0-a6cb-97d53f89099e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11367e760>]}
[0m15:47:50.932734 [error] [Thread-2  ]: 2 of 7 ERROR creating sql view model public__airbyte_quarantine.users_scalar ... [[31mERROR[0m in 0.03s]
[0m15:47:50.933089 [debug] [Thread-2  ]: Finished running node model.pgmigrate.users_dbt_model
[0m15:47:50.933835 [debug] [Thread-1  ]: SQL status: BEGIN in 0.0 seconds
[0m15:47:50.934130 [debug] [Thread-1  ]: Using postgres connection "model.pgmigrate.my_first_dbt_model"
[0m15:47:50.934390 [debug] [Thread-1  ]: On model.pgmigrate.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.8.1", "profile_name": "pgmigrate", "target_name": "dev", "node_id": "model.pgmigrate.my_first_dbt_model"} */

  
    

  create  table "postgres"."public"."my_first_dbt_model__dbt_tmp"
  
  
    as
  
  (
    /*
    Welcome to your first dbt model!
    Did you know that you can also configure models directly within SQL files?
    This will override configurations stated in dbt_project.yml

    Try changing "table" to "view" below
*/



with source_data as (

    select 1 as id
    union all
    select null as id

)

select *
from source_data

/*
    Uncomment the line below to remove records with null `id` values
*/

-- where id is not null
  );
  
[0m15:47:50.938516 [debug] [Thread-1  ]: SQL status: SELECT 2 in 0.0 seconds
[0m15:47:50.942312 [debug] [Thread-1  ]: Using postgres connection "model.pgmigrate.my_first_dbt_model"
[0m15:47:50.942575 [debug] [Thread-1  ]: On model.pgmigrate.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.8.1", "profile_name": "pgmigrate", "target_name": "dev", "node_id": "model.pgmigrate.my_first_dbt_model"} */
alter table "postgres"."public"."my_first_dbt_model" rename to "my_first_dbt_model__dbt_backup"
[0m15:47:50.943287 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.0 seconds
[0m15:47:50.945051 [debug] [Thread-1  ]: Using postgres connection "model.pgmigrate.my_first_dbt_model"
[0m15:47:50.945289 [debug] [Thread-1  ]: On model.pgmigrate.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.8.1", "profile_name": "pgmigrate", "target_name": "dev", "node_id": "model.pgmigrate.my_first_dbt_model"} */
alter table "postgres"."public"."my_first_dbt_model__dbt_tmp" rename to "my_first_dbt_model"
[0m15:47:50.946621 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.0 seconds
[0m15:47:50.957677 [debug] [Thread-1  ]: On model.pgmigrate.my_first_dbt_model: COMMIT
[0m15:47:50.957965 [debug] [Thread-1  ]: Using postgres connection "model.pgmigrate.my_first_dbt_model"
[0m15:47:50.958251 [debug] [Thread-1  ]: On model.pgmigrate.my_first_dbt_model: COMMIT
[0m15:47:50.959124 [debug] [Thread-1  ]: SQL status: COMMIT in 0.0 seconds
[0m15:47:50.962607 [debug] [Thread-1  ]: Applying DROP to: "postgres"."public"."my_first_dbt_model__dbt_backup"
[0m15:47:50.964983 [debug] [Thread-1  ]: Using postgres connection "model.pgmigrate.my_first_dbt_model"
[0m15:47:50.965419 [debug] [Thread-1  ]: On model.pgmigrate.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.8.1", "profile_name": "pgmigrate", "target_name": "dev", "node_id": "model.pgmigrate.my_first_dbt_model"} */
drop table if exists "postgres"."public"."my_first_dbt_model__dbt_backup" cascade
[0m15:47:50.968834 [debug] [Thread-1  ]: SQL status: DROP TABLE in 0.0 seconds
[0m15:47:50.970126 [debug] [Thread-1  ]: On model.pgmigrate.my_first_dbt_model: Close
[0m15:47:50.970508 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '7699e08f-3de8-42f0-a6cb-97d53f89099e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11354c910>]}
[0m15:47:50.970880 [info ] [Thread-1  ]: 1 of 7 OK created sql table model public.my_first_dbt_model .................... [[32mSELECT 2[0m in 0.07s]
[0m15:47:50.971235 [debug] [Thread-1  ]: Finished running node model.pgmigrate.my_first_dbt_model
[0m15:47:50.971719 [debug] [Thread-2  ]: Began running node test.pgmigrate.not_null_my_first_dbt_model_id.5fb22c2710
[0m15:47:50.971978 [debug] [Thread-1  ]: Began running node test.pgmigrate.unique_my_first_dbt_model_id.16e066b321
[0m15:47:50.972261 [info ] [Thread-2  ]: 3 of 7 START test not_null_my_first_dbt_model_id ............................... [RUN]
[0m15:47:50.972567 [info ] [Thread-1  ]: 4 of 7 START test unique_my_first_dbt_model_id ................................. [RUN]
[0m15:47:50.972880 [debug] [Thread-2  ]: Re-using an available connection from the pool (formerly model.pgmigrate.users_dbt_model, now test.pgmigrate.not_null_my_first_dbt_model_id.5fb22c2710)
[0m15:47:50.973135 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.pgmigrate.my_first_dbt_model, now test.pgmigrate.unique_my_first_dbt_model_id.16e066b321)
[0m15:47:50.973375 [debug] [Thread-2  ]: Began compiling node test.pgmigrate.not_null_my_first_dbt_model_id.5fb22c2710
[0m15:47:50.973602 [debug] [Thread-1  ]: Began compiling node test.pgmigrate.unique_my_first_dbt_model_id.16e066b321
[0m15:47:50.980208 [debug] [Thread-2  ]: Writing injected SQL for node "test.pgmigrate.not_null_my_first_dbt_model_id.5fb22c2710"
[0m15:47:51.008900 [debug] [Thread-1  ]: Writing injected SQL for node "test.pgmigrate.unique_my_first_dbt_model_id.16e066b321"
[0m15:47:51.009525 [debug] [Thread-1  ]: Began executing node test.pgmigrate.unique_my_first_dbt_model_id.16e066b321
[0m15:47:51.009778 [debug] [Thread-2  ]: Began executing node test.pgmigrate.not_null_my_first_dbt_model_id.5fb22c2710
[0m15:47:51.018196 [debug] [Thread-1  ]: Writing runtime sql for node "test.pgmigrate.unique_my_first_dbt_model_id.16e066b321"
[0m15:47:51.019890 [debug] [Thread-2  ]: Writing runtime sql for node "test.pgmigrate.not_null_my_first_dbt_model_id.5fb22c2710"
[0m15:47:51.020339 [debug] [Thread-1  ]: Using postgres connection "test.pgmigrate.unique_my_first_dbt_model_id.16e066b321"
[0m15:47:51.020596 [debug] [Thread-2  ]: Using postgres connection "test.pgmigrate.not_null_my_first_dbt_model_id.5fb22c2710"
[0m15:47:51.020851 [debug] [Thread-1  ]: On test.pgmigrate.unique_my_first_dbt_model_id.16e066b321: BEGIN
[0m15:47:51.021085 [debug] [Thread-2  ]: On test.pgmigrate.not_null_my_first_dbt_model_id.5fb22c2710: BEGIN
[0m15:47:51.021313 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m15:47:51.021534 [debug] [Thread-2  ]: Opening a new connection, currently in state closed
[0m15:47:51.027288 [debug] [Thread-1  ]: SQL status: BEGIN in 0.0 seconds
[0m15:47:51.027517 [debug] [Thread-2  ]: SQL status: BEGIN in 0.0 seconds
[0m15:47:51.027756 [debug] [Thread-1  ]: Using postgres connection "test.pgmigrate.unique_my_first_dbt_model_id.16e066b321"
[0m15:47:51.027985 [debug] [Thread-2  ]: Using postgres connection "test.pgmigrate.not_null_my_first_dbt_model_id.5fb22c2710"
[0m15:47:51.028225 [debug] [Thread-1  ]: On test.pgmigrate.unique_my_first_dbt_model_id.16e066b321: /* {"app": "dbt", "dbt_version": "1.8.1", "profile_name": "pgmigrate", "target_name": "dev", "node_id": "test.pgmigrate.unique_my_first_dbt_model_id.16e066b321"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

select
    id as unique_field,
    count(*) as n_records

from "postgres"."public"."my_first_dbt_model"
where id is not null
group by id
having count(*) > 1



      
    ) dbt_internal_test
[0m15:47:51.028480 [debug] [Thread-2  ]: On test.pgmigrate.not_null_my_first_dbt_model_id.5fb22c2710: /* {"app": "dbt", "dbt_version": "1.8.1", "profile_name": "pgmigrate", "target_name": "dev", "node_id": "test.pgmigrate.not_null_my_first_dbt_model_id.5fb22c2710"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select id
from "postgres"."public"."my_first_dbt_model"
where id is null



      
    ) dbt_internal_test
[0m15:47:51.030089 [debug] [Thread-2  ]: SQL status: SELECT 1 in 0.0 seconds
[0m15:47:51.031864 [debug] [Thread-2  ]: On test.pgmigrate.not_null_my_first_dbt_model_id.5fb22c2710: ROLLBACK
[0m15:47:51.032118 [debug] [Thread-1  ]: SQL status: SELECT 1 in 0.0 seconds
[0m15:47:51.032891 [debug] [Thread-1  ]: On test.pgmigrate.unique_my_first_dbt_model_id.16e066b321: ROLLBACK
[0m15:47:51.033128 [debug] [Thread-2  ]: On test.pgmigrate.not_null_my_first_dbt_model_id.5fb22c2710: Close
[0m15:47:51.033673 [debug] [Thread-1  ]: On test.pgmigrate.unique_my_first_dbt_model_id.16e066b321: Close
[0m15:47:51.033492 [error] [Thread-2  ]: 3 of 7 FAIL 1 not_null_my_first_dbt_model_id ................................... [[31mFAIL 1[0m in 0.06s]
[0m15:47:51.034118 [debug] [Thread-2  ]: Finished running node test.pgmigrate.not_null_my_first_dbt_model_id.5fb22c2710
[0m15:47:51.034510 [info ] [Thread-1  ]: 4 of 7 PASS unique_my_first_dbt_model_id ....................................... [[32mPASS[0m in 0.06s]
[0m15:47:51.034841 [debug] [Thread-1  ]: Finished running node test.pgmigrate.unique_my_first_dbt_model_id.16e066b321
[0m15:47:51.035322 [debug] [Thread-2  ]: Began running node model.pgmigrate.my_second_dbt_model
[0m15:47:51.035582 [info ] [Thread-2  ]: 5 of 7 SKIP relation public.my_second_dbt_model ................................ [[33mSKIP[0m]
[0m15:47:51.035854 [debug] [Thread-2  ]: Finished running node model.pgmigrate.my_second_dbt_model
[0m15:47:51.036252 [debug] [Thread-1  ]: Began running node test.pgmigrate.not_null_my_second_dbt_model_id.151b76d778
[0m15:47:51.036546 [debug] [Thread-2  ]: Began running node test.pgmigrate.unique_my_second_dbt_model_id.57a0f8c493
[0m15:47:51.036824 [info ] [Thread-1  ]: 6 of 7 SKIP test not_null_my_second_dbt_model_id ............................... [[33mSKIP[0m]
[0m15:47:51.037141 [info ] [Thread-2  ]: 7 of 7 SKIP test unique_my_second_dbt_model_id ................................. [[33mSKIP[0m]
[0m15:47:51.037458 [debug] [Thread-1  ]: Finished running node test.pgmigrate.not_null_my_second_dbt_model_id.151b76d778
[0m15:47:51.037713 [debug] [Thread-2  ]: Finished running node test.pgmigrate.unique_my_second_dbt_model_id.57a0f8c493
[0m15:47:51.038353 [debug] [MainThread]: Using postgres connection "master"
[0m15:47:51.038547 [debug] [MainThread]: On master: BEGIN
[0m15:47:51.038726 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m15:47:51.042432 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m15:47:51.042680 [debug] [MainThread]: On master: COMMIT
[0m15:47:51.042914 [debug] [MainThread]: Using postgres connection "master"
[0m15:47:51.043137 [debug] [MainThread]: On master: COMMIT
[0m15:47:51.043429 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m15:47:51.043637 [debug] [MainThread]: On master: Close
[0m15:47:51.043893 [debug] [MainThread]: Connection 'master' was properly closed.
[0m15:47:51.044075 [debug] [MainThread]: Connection 'test.pgmigrate.unique_my_first_dbt_model_id.16e066b321' was properly closed.
[0m15:47:51.044252 [debug] [MainThread]: Connection 'test.pgmigrate.not_null_my_first_dbt_model_id.5fb22c2710' was properly closed.
[0m15:47:51.044480 [info ] [MainThread]: 
[0m15:47:51.044709 [info ] [MainThread]: Finished running 2 view models, 1 table model, 4 data tests in 0 hours 0 minutes and 0.25 seconds (0.25s).
[0m15:47:51.045293 [debug] [MainThread]: Command end result
[0m15:47:51.064143 [info ] [MainThread]: 
[0m15:47:51.064436 [info ] [MainThread]: [31mCompleted with 2 errors and 0 warnings:[0m
[0m15:47:51.064659 [info ] [MainThread]: 
[0m15:47:51.064920 [error] [MainThread]:   Compilation Error in model users_dbt_model (models/example/users_dbt_model.sql)
  '_airbyte_data' is undefined. This can happen when calling a macro that does not exist. Check for typos and/or install package dependencies with "dbt deps".
[0m15:47:51.065138 [info ] [MainThread]: 
[0m15:47:51.065384 [error] [MainThread]: [31mFailure in test not_null_my_first_dbt_model_id (models/example/schema.yml)[0m
[0m15:47:51.065626 [error] [MainThread]:   Got 1 result, configured to fail if != 0
[0m15:47:51.065829 [info ] [MainThread]: 
[0m15:47:51.066068 [info ] [MainThread]:   compiled code at target/compiled/pgmigrate/models/example/schema.yml/not_null_my_first_dbt_model_id.sql
[0m15:47:51.066276 [info ] [MainThread]: 
[0m15:47:51.066495 [info ] [MainThread]: Done. PASS=2 WARN=0 ERROR=2 SKIP=3 TOTAL=7
[0m15:47:51.067784 [debug] [MainThread]: Resource report: {"command_name": "build", "command_wall_clock_time": 0.74219865, "process_user_time": 1.142366, "process_kernel_time": 0.115883, "process_mem_max_rss": "119848960", "command_success": false, "process_in_blocks": "0", "process_out_blocks": "0"}
[0m15:47:51.068099 [debug] [MainThread]: Command `dbt build` failed at 15:47:51.068056 after 0.74 seconds
[0m15:47:51.068337 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106f20a60>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11357ec10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x112fde6a0>]}
[0m15:47:51.068568 [debug] [MainThread]: Flushing usage events
[0m15:48:16.095325 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10485ea00>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106874e20>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1068746a0>]}


============================== 15:48:16.098030 | 8c270911-0b59-448b-b6f4-812670add47e ==============================
[0m15:48:16.098030 [info ] [MainThread]: Running with dbt=1.8.1
[0m15:48:16.098409 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'version_check': 'True', 'log_path': '/Users/shrikanth/Shrikanth/dbt-helloworld/logs', 'profiles_dir': '/Users/shrikanth/Shrikanth/dbt-helloworld', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'invocation_command': 'dbt build', 'log_format': 'default', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m15:48:16.205126 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '8c270911-0b59-448b-b6f4-812670add47e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106b94670>]}
[0m15:48:16.233630 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '8c270911-0b59-448b-b6f4-812670add47e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106d65580>]}
[0m15:48:16.234313 [info ] [MainThread]: Registered adapter: postgres=1.8.1
[0m15:48:16.246412 [debug] [MainThread]: checksum: ebc509fb14e151ea268e89b60fd5abf912ed99129f87516462718fa2f14f4838, vars: {}, profile: , target: , version: 1.8.1
[0m15:48:16.333159 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m15:48:16.333587 [debug] [MainThread]: Partial parsing: updated file: pgmigrate://models/example/users_dbt_model.sql
[0m15:48:16.456974 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '8c270911-0b59-448b-b6f4-812670add47e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1074d2130>]}
[0m15:48:16.520358 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '8c270911-0b59-448b-b6f4-812670add47e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107367d90>]}
[0m15:48:16.520691 [info ] [MainThread]: Found 3 models, 4 data tests, 527 macros
[0m15:48:16.521688 [info ] [MainThread]: 
[0m15:48:16.522039 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m15:48:16.524175 [debug] [ThreadPool]: Acquiring new postgres connection 'list_postgres'
[0m15:48:16.524498 [debug] [ThreadPool]: Acquiring new postgres connection 'list_postgres'
[0m15:48:16.551789 [debug] [ThreadPool]: Using postgres connection "list_postgres"
[0m15:48:16.552047 [debug] [ThreadPool]: Using postgres connection "list_postgres"
[0m15:48:16.552305 [debug] [ThreadPool]: On list_postgres: /* {"app": "dbt", "dbt_version": "1.8.1", "profile_name": "pgmigrate", "target_name": "dev", "connection_name": "list_postgres"} */

    select distinct nspname from pg_namespace
  
[0m15:48:16.552537 [debug] [ThreadPool]: On list_postgres: /* {"app": "dbt", "dbt_version": "1.8.1", "profile_name": "pgmigrate", "target_name": "dev", "connection_name": "list_postgres"} */

    select distinct nspname from pg_namespace
  
[0m15:48:16.552755 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m15:48:16.552963 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m15:48:16.566736 [debug] [ThreadPool]: SQL status: SELECT 18 in 0.0 seconds
[0m15:48:16.566966 [debug] [ThreadPool]: SQL status: SELECT 18 in 0.0 seconds
[0m15:48:16.567728 [debug] [ThreadPool]: On list_postgres: Close
[0m15:48:16.568372 [debug] [ThreadPool]: On list_postgres: Close
[0m15:48:16.569202 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_postgres, now list_postgres_public)
[0m15:48:16.569511 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_postgres, now list_postgres_public__airbyte_quarantine)
[0m15:48:16.573029 [debug] [ThreadPool]: Using postgres connection "list_postgres_public"
[0m15:48:16.574654 [debug] [ThreadPool]: Using postgres connection "list_postgres_public__airbyte_quarantine"
[0m15:48:16.574880 [debug] [ThreadPool]: On list_postgres_public: BEGIN
[0m15:48:16.575103 [debug] [ThreadPool]: On list_postgres_public__airbyte_quarantine: BEGIN
[0m15:48:16.575310 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m15:48:16.575508 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m15:48:16.580767 [debug] [ThreadPool]: SQL status: BEGIN in 0.0 seconds
[0m15:48:16.580990 [debug] [ThreadPool]: SQL status: BEGIN in 0.0 seconds
[0m15:48:16.581197 [debug] [ThreadPool]: Using postgres connection "list_postgres_public"
[0m15:48:16.581409 [debug] [ThreadPool]: Using postgres connection "list_postgres_public__airbyte_quarantine"
[0m15:48:16.581630 [debug] [ThreadPool]: On list_postgres_public: /* {"app": "dbt", "dbt_version": "1.8.1", "profile_name": "pgmigrate", "target_name": "dev", "connection_name": "list_postgres_public"} */
select
      'postgres' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'postgres' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
    union all
    select
      'postgres' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public'
  
[0m15:48:16.581866 [debug] [ThreadPool]: On list_postgres_public__airbyte_quarantine: /* {"app": "dbt", "dbt_version": "1.8.1", "profile_name": "pgmigrate", "target_name": "dev", "connection_name": "list_postgres_public__airbyte_quarantine"} */
select
      'postgres' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public__airbyte_quarantine'
    union all
    select
      'postgres' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public__airbyte_quarantine'
    union all
    select
      'postgres' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public__airbyte_quarantine'
  
[0m15:48:16.588571 [debug] [ThreadPool]: SQL status: SELECT 0 in 0.0 seconds
[0m15:48:16.588783 [debug] [ThreadPool]: SQL status: SELECT 4 in 0.0 seconds
[0m15:48:16.589404 [debug] [ThreadPool]: On list_postgres_public__airbyte_quarantine: ROLLBACK
[0m15:48:16.590064 [debug] [ThreadPool]: On list_postgres_public: ROLLBACK
[0m15:48:16.590452 [debug] [ThreadPool]: On list_postgres_public__airbyte_quarantine: Close
[0m15:48:16.590654 [debug] [ThreadPool]: On list_postgres_public: Close
[0m15:48:16.593541 [debug] [MainThread]: Using postgres connection "master"
[0m15:48:16.593784 [debug] [MainThread]: On master: BEGIN
[0m15:48:16.593984 [debug] [MainThread]: Opening a new connection, currently in state init
[0m15:48:16.597336 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m15:48:16.597534 [debug] [MainThread]: Using postgres connection "master"
[0m15:48:16.597774 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.8.1", "profile_name": "pgmigrate", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m15:48:16.614174 [debug] [MainThread]: SQL status: SELECT 0 in 0.0 seconds
[0m15:48:16.614827 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '8c270911-0b59-448b-b6f4-812670add47e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107abdc10>]}
[0m15:48:16.615110 [debug] [MainThread]: On master: ROLLBACK
[0m15:48:16.615427 [debug] [MainThread]: Using postgres connection "master"
[0m15:48:16.615631 [debug] [MainThread]: On master: BEGIN
[0m15:48:16.616014 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m15:48:16.616219 [debug] [MainThread]: On master: COMMIT
[0m15:48:16.616416 [debug] [MainThread]: Using postgres connection "master"
[0m15:48:16.616611 [debug] [MainThread]: On master: COMMIT
[0m15:48:16.616869 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m15:48:16.617073 [debug] [MainThread]: On master: Close
[0m15:48:16.617354 [info ] [MainThread]: Concurrency: 2 threads (target='dev')
[0m15:48:16.617579 [info ] [MainThread]: 
[0m15:48:16.618769 [debug] [Thread-1  ]: Began running node model.pgmigrate.my_first_dbt_model
[0m15:48:16.619040 [debug] [Thread-2  ]: Began running node model.pgmigrate.users_dbt_model
[0m15:48:16.619358 [info ] [Thread-1  ]: 1 of 7 START sql table model public.my_first_dbt_model ......................... [RUN]
[0m15:48:16.619738 [info ] [Thread-2  ]: 2 of 7 START sql view model public__airbyte_quarantine.users_scalar ............ [RUN]
[0m15:48:16.620069 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly list_postgres_public, now model.pgmigrate.my_first_dbt_model)
[0m15:48:16.620341 [debug] [Thread-2  ]: Re-using an available connection from the pool (formerly list_postgres_public__airbyte_quarantine, now model.pgmigrate.users_dbt_model)
[0m15:48:16.620605 [debug] [Thread-1  ]: Began compiling node model.pgmigrate.my_first_dbt_model
[0m15:48:16.620845 [debug] [Thread-2  ]: Began compiling node model.pgmigrate.users_dbt_model
[0m15:48:16.626044 [debug] [Thread-1  ]: Writing injected SQL for node "model.pgmigrate.my_first_dbt_model"
[0m15:48:16.628110 [debug] [Thread-2  ]: Writing injected SQL for node "model.pgmigrate.users_dbt_model"
[0m15:48:16.628578 [debug] [Thread-1  ]: Began executing node model.pgmigrate.my_first_dbt_model
[0m15:48:16.628844 [debug] [Thread-2  ]: Began executing node model.pgmigrate.users_dbt_model
[0m15:48:16.651032 [debug] [Thread-1  ]: Writing runtime sql for node "model.pgmigrate.my_first_dbt_model"
[0m15:48:16.661230 [debug] [Thread-2  ]: Writing runtime sql for node "model.pgmigrate.users_dbt_model"
[0m15:48:16.661704 [debug] [Thread-1  ]: Using postgres connection "model.pgmigrate.my_first_dbt_model"
[0m15:48:16.661961 [debug] [Thread-1  ]: On model.pgmigrate.my_first_dbt_model: BEGIN
[0m15:48:16.662219 [debug] [Thread-2  ]: Using postgres connection "model.pgmigrate.users_dbt_model"
[0m15:48:16.662457 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m15:48:16.662707 [debug] [Thread-2  ]: On model.pgmigrate.users_dbt_model: BEGIN
[0m15:48:16.663017 [debug] [Thread-2  ]: Opening a new connection, currently in state closed
[0m15:48:16.668437 [debug] [Thread-1  ]: SQL status: BEGIN in 0.0 seconds
[0m15:48:16.668672 [debug] [Thread-2  ]: SQL status: BEGIN in 0.0 seconds
[0m15:48:16.668916 [debug] [Thread-1  ]: Using postgres connection "model.pgmigrate.my_first_dbt_model"
[0m15:48:16.669150 [debug] [Thread-2  ]: Using postgres connection "model.pgmigrate.users_dbt_model"
[0m15:48:16.669398 [debug] [Thread-1  ]: On model.pgmigrate.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.8.1", "profile_name": "pgmigrate", "target_name": "dev", "node_id": "model.pgmigrate.my_first_dbt_model"} */

  
    

  create  table "postgres"."public"."my_first_dbt_model__dbt_tmp"
  
  
    as
  
  (
    /*
    Welcome to your first dbt model!
    Did you know that you can also configure models directly within SQL files?
    This will override configurations stated in dbt_project.yml

    Try changing "table" to "view" below
*/



with source_data as (

    select 1 as id
    union all
    select null as id

)

select *
from source_data

/*
    Uncomment the line below to remove records with null `id` values
*/

-- where id is not null
  );
  
[0m15:48:16.669670 [debug] [Thread-2  ]: On model.pgmigrate.users_dbt_model: /* {"app": "dbt", "dbt_version": "1.8.1", "profile_name": "pgmigrate", "target_name": "dev", "node_id": "model.pgmigrate.users_dbt_model"} */

  create view "postgres"."public__airbyte_quarantine"."users_scalar__dbt_tmp"
    
    
  as (
    
-- SQL model to parse JSON blob stored in a single column and extract into separated field columns as described by the JSON Schema

select
    _airbyte_data['_id'] as legacy_id,
    _airbyte_data['createdAt']  as start_date,
    _airbyte_data ['updatedAt']  as update_date,
    _airbyte_data ['name']  as name,
    _airbyte_data ['email']  as email,
    _airbyte_data ['status']  as status,
    _airbyte_data ['lastName']  as last_name,
    _airbyte_data ['firstName']  as first_name,
    _airbyte_data ['remoteCreatedAt']  as remote_created_at,
    _airbyte_data ['employmentStatus']  as employment_status,
    _airbyte_data ['organization']  as organization,
    _airbyte_data ['onboardingStep']  as onboarding_step,
    _airbyte_emitted_at
from 'public._airbyte_raw_users'
  );
[0m15:48:16.670536 [debug] [Thread-2  ]: Postgres adapter: Postgres error: syntax error at or near "'public._airbyte_raw_users'"
LINE 24: from 'public._airbyte_raw_users'
              ^

[0m15:48:16.670790 [debug] [Thread-2  ]: On model.pgmigrate.users_dbt_model: ROLLBACK
[0m15:48:16.671166 [debug] [Thread-2  ]: On model.pgmigrate.users_dbt_model: Close
[0m15:48:16.675010 [debug] [Thread-2  ]: Database Error in model users_dbt_model (models/example/users_dbt_model.sql)
  syntax error at or near "'public._airbyte_raw_users'"
  LINE 24: from 'public._airbyte_raw_users'
                ^
  compiled Code at target/run/pgmigrate/models/example/users_dbt_model.sql
[0m15:48:16.675866 [debug] [Thread-2  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '8c270911-0b59-448b-b6f4-812670add47e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107c003d0>]}
[0m15:48:16.676237 [error] [Thread-2  ]: 2 of 7 ERROR creating sql view model public__airbyte_quarantine.users_scalar ... [[31mERROR[0m in 0.05s]
[0m15:48:16.676634 [debug] [Thread-2  ]: Finished running node model.pgmigrate.users_dbt_model
[0m15:48:16.677471 [debug] [Thread-1  ]: SQL status: SELECT 2 in 0.0 seconds
[0m15:48:16.681009 [debug] [Thread-1  ]: Using postgres connection "model.pgmigrate.my_first_dbt_model"
[0m15:48:16.681261 [debug] [Thread-1  ]: On model.pgmigrate.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.8.1", "profile_name": "pgmigrate", "target_name": "dev", "node_id": "model.pgmigrate.my_first_dbt_model"} */
alter table "postgres"."public"."my_first_dbt_model" rename to "my_first_dbt_model__dbt_backup"
[0m15:48:16.681871 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.0 seconds
[0m15:48:16.683705 [debug] [Thread-1  ]: Using postgres connection "model.pgmigrate.my_first_dbt_model"
[0m15:48:16.683957 [debug] [Thread-1  ]: On model.pgmigrate.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.8.1", "profile_name": "pgmigrate", "target_name": "dev", "node_id": "model.pgmigrate.my_first_dbt_model"} */
alter table "postgres"."public"."my_first_dbt_model__dbt_tmp" rename to "my_first_dbt_model"
[0m15:48:16.684867 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.0 seconds
[0m15:48:16.695852 [debug] [Thread-1  ]: On model.pgmigrate.my_first_dbt_model: COMMIT
[0m15:48:16.696102 [debug] [Thread-1  ]: Using postgres connection "model.pgmigrate.my_first_dbt_model"
[0m15:48:16.696327 [debug] [Thread-1  ]: On model.pgmigrate.my_first_dbt_model: COMMIT
[0m15:48:16.697337 [debug] [Thread-1  ]: SQL status: COMMIT in 0.0 seconds
[0m15:48:16.700776 [debug] [Thread-1  ]: Applying DROP to: "postgres"."public"."my_first_dbt_model__dbt_backup"
[0m15:48:16.703177 [debug] [Thread-1  ]: Using postgres connection "model.pgmigrate.my_first_dbt_model"
[0m15:48:16.703458 [debug] [Thread-1  ]: On model.pgmigrate.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.8.1", "profile_name": "pgmigrate", "target_name": "dev", "node_id": "model.pgmigrate.my_first_dbt_model"} */
drop table if exists "postgres"."public"."my_first_dbt_model__dbt_backup" cascade
[0m15:48:16.705774 [debug] [Thread-1  ]: SQL status: DROP TABLE in 0.0 seconds
[0m15:48:16.706965 [debug] [Thread-1  ]: On model.pgmigrate.my_first_dbt_model: Close
[0m15:48:16.707283 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '8c270911-0b59-448b-b6f4-812670add47e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107a838b0>]}
[0m15:48:16.707639 [info ] [Thread-1  ]: 1 of 7 OK created sql table model public.my_first_dbt_model .................... [[32mSELECT 2[0m in 0.09s]
[0m15:48:16.707993 [debug] [Thread-1  ]: Finished running node model.pgmigrate.my_first_dbt_model
[0m15:48:16.708493 [debug] [Thread-2  ]: Began running node test.pgmigrate.not_null_my_first_dbt_model_id.5fb22c2710
[0m15:48:16.708751 [debug] [Thread-1  ]: Began running node test.pgmigrate.unique_my_first_dbt_model_id.16e066b321
[0m15:48:16.709010 [info ] [Thread-2  ]: 3 of 7 START test not_null_my_first_dbt_model_id ............................... [RUN]
[0m15:48:16.709305 [info ] [Thread-1  ]: 4 of 7 START test unique_my_first_dbt_model_id ................................. [RUN]
[0m15:48:16.709622 [debug] [Thread-2  ]: Re-using an available connection from the pool (formerly model.pgmigrate.users_dbt_model, now test.pgmigrate.not_null_my_first_dbt_model_id.5fb22c2710)
[0m15:48:16.709877 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.pgmigrate.my_first_dbt_model, now test.pgmigrate.unique_my_first_dbt_model_id.16e066b321)
[0m15:48:16.710109 [debug] [Thread-2  ]: Began compiling node test.pgmigrate.not_null_my_first_dbt_model_id.5fb22c2710
[0m15:48:16.710338 [debug] [Thread-1  ]: Began compiling node test.pgmigrate.unique_my_first_dbt_model_id.16e066b321
[0m15:48:16.741452 [debug] [Thread-2  ]: Writing injected SQL for node "test.pgmigrate.not_null_my_first_dbt_model_id.5fb22c2710"
[0m15:48:16.745126 [debug] [Thread-1  ]: Writing injected SQL for node "test.pgmigrate.unique_my_first_dbt_model_id.16e066b321"
[0m15:48:16.745657 [debug] [Thread-1  ]: Began executing node test.pgmigrate.unique_my_first_dbt_model_id.16e066b321
[0m15:48:16.745920 [debug] [Thread-2  ]: Began executing node test.pgmigrate.not_null_my_first_dbt_model_id.5fb22c2710
[0m15:48:16.754222 [debug] [Thread-1  ]: Writing runtime sql for node "test.pgmigrate.unique_my_first_dbt_model_id.16e066b321"
[0m15:48:16.755770 [debug] [Thread-2  ]: Writing runtime sql for node "test.pgmigrate.not_null_my_first_dbt_model_id.5fb22c2710"
[0m15:48:16.756213 [debug] [Thread-1  ]: Using postgres connection "test.pgmigrate.unique_my_first_dbt_model_id.16e066b321"
[0m15:48:16.756462 [debug] [Thread-2  ]: Using postgres connection "test.pgmigrate.not_null_my_first_dbt_model_id.5fb22c2710"
[0m15:48:16.756708 [debug] [Thread-1  ]: On test.pgmigrate.unique_my_first_dbt_model_id.16e066b321: BEGIN
[0m15:48:16.756944 [debug] [Thread-2  ]: On test.pgmigrate.not_null_my_first_dbt_model_id.5fb22c2710: BEGIN
[0m15:48:16.757173 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m15:48:16.757393 [debug] [Thread-2  ]: Opening a new connection, currently in state closed
[0m15:48:16.761451 [debug] [Thread-1  ]: SQL status: BEGIN in 0.0 seconds
[0m15:48:16.761687 [debug] [Thread-2  ]: SQL status: BEGIN in 0.0 seconds
[0m15:48:16.761938 [debug] [Thread-1  ]: Using postgres connection "test.pgmigrate.unique_my_first_dbt_model_id.16e066b321"
[0m15:48:16.762172 [debug] [Thread-2  ]: Using postgres connection "test.pgmigrate.not_null_my_first_dbt_model_id.5fb22c2710"
[0m15:48:16.762413 [debug] [Thread-1  ]: On test.pgmigrate.unique_my_first_dbt_model_id.16e066b321: /* {"app": "dbt", "dbt_version": "1.8.1", "profile_name": "pgmigrate", "target_name": "dev", "node_id": "test.pgmigrate.unique_my_first_dbt_model_id.16e066b321"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

select
    id as unique_field,
    count(*) as n_records

from "postgres"."public"."my_first_dbt_model"
where id is not null
group by id
having count(*) > 1



      
    ) dbt_internal_test
[0m15:48:16.762668 [debug] [Thread-2  ]: On test.pgmigrate.not_null_my_first_dbt_model_id.5fb22c2710: /* {"app": "dbt", "dbt_version": "1.8.1", "profile_name": "pgmigrate", "target_name": "dev", "node_id": "test.pgmigrate.not_null_my_first_dbt_model_id.5fb22c2710"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select id
from "postgres"."public"."my_first_dbt_model"
where id is null



      
    ) dbt_internal_test
[0m15:48:16.764285 [debug] [Thread-2  ]: SQL status: SELECT 1 in 0.0 seconds
[0m15:48:16.766002 [debug] [Thread-2  ]: On test.pgmigrate.not_null_my_first_dbt_model_id.5fb22c2710: ROLLBACK
[0m15:48:16.766264 [debug] [Thread-1  ]: SQL status: SELECT 1 in 0.0 seconds
[0m15:48:16.767085 [debug] [Thread-1  ]: On test.pgmigrate.unique_my_first_dbt_model_id.16e066b321: ROLLBACK
[0m15:48:16.767355 [debug] [Thread-2  ]: On test.pgmigrate.not_null_my_first_dbt_model_id.5fb22c2710: Close
[0m15:48:16.767932 [debug] [Thread-1  ]: On test.pgmigrate.unique_my_first_dbt_model_id.16e066b321: Close
[0m15:48:16.767753 [error] [Thread-2  ]: 3 of 7 FAIL 1 not_null_my_first_dbt_model_id ................................... [[31mFAIL 1[0m in 0.06s]
[0m15:48:16.768353 [info ] [Thread-1  ]: 4 of 7 PASS unique_my_first_dbt_model_id ....................................... [[32mPASS[0m in 0.06s]
[0m15:48:16.768708 [debug] [Thread-2  ]: Finished running node test.pgmigrate.not_null_my_first_dbt_model_id.5fb22c2710
[0m15:48:16.769009 [debug] [Thread-1  ]: Finished running node test.pgmigrate.unique_my_first_dbt_model_id.16e066b321
[0m15:48:16.769522 [debug] [Thread-2  ]: Began running node model.pgmigrate.my_second_dbt_model
[0m15:48:16.769801 [info ] [Thread-2  ]: 5 of 7 SKIP relation public.my_second_dbt_model ................................ [[33mSKIP[0m]
[0m15:48:16.770081 [debug] [Thread-2  ]: Finished running node model.pgmigrate.my_second_dbt_model
[0m15:48:16.770482 [debug] [Thread-1  ]: Began running node test.pgmigrate.not_null_my_second_dbt_model_id.151b76d778
[0m15:48:16.770763 [debug] [Thread-2  ]: Began running node test.pgmigrate.unique_my_second_dbt_model_id.57a0f8c493
[0m15:48:16.771026 [info ] [Thread-1  ]: 6 of 7 SKIP test not_null_my_second_dbt_model_id ............................... [[33mSKIP[0m]
[0m15:48:16.771334 [info ] [Thread-2  ]: 7 of 7 SKIP test unique_my_second_dbt_model_id ................................. [[33mSKIP[0m]
[0m15:48:16.771625 [debug] [Thread-1  ]: Finished running node test.pgmigrate.not_null_my_second_dbt_model_id.151b76d778
[0m15:48:16.771880 [debug] [Thread-2  ]: Finished running node test.pgmigrate.unique_my_second_dbt_model_id.57a0f8c493
[0m15:48:16.772495 [debug] [MainThread]: Using postgres connection "master"
[0m15:48:16.772687 [debug] [MainThread]: On master: BEGIN
[0m15:48:16.772898 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m15:48:16.776480 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m15:48:16.776694 [debug] [MainThread]: On master: COMMIT
[0m15:48:16.776883 [debug] [MainThread]: Using postgres connection "master"
[0m15:48:16.777063 [debug] [MainThread]: On master: COMMIT
[0m15:48:16.777369 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m15:48:16.777557 [debug] [MainThread]: On master: Close
[0m15:48:16.777789 [debug] [MainThread]: Connection 'master' was properly closed.
[0m15:48:16.777965 [debug] [MainThread]: Connection 'test.pgmigrate.unique_my_first_dbt_model_id.16e066b321' was properly closed.
[0m15:48:16.778138 [debug] [MainThread]: Connection 'test.pgmigrate.not_null_my_first_dbt_model_id.5fb22c2710' was properly closed.
[0m15:48:16.778352 [info ] [MainThread]: 
[0m15:48:16.778576 [info ] [MainThread]: Finished running 2 view models, 1 table model, 4 data tests in 0 hours 0 minutes and 0.26 seconds (0.26s).
[0m15:48:16.779208 [debug] [MainThread]: Command end result
[0m15:48:16.798331 [info ] [MainThread]: 
[0m15:48:16.798652 [info ] [MainThread]: [31mCompleted with 2 errors and 0 warnings:[0m
[0m15:48:16.798885 [info ] [MainThread]: 
[0m15:48:16.799153 [error] [MainThread]:   Database Error in model users_dbt_model (models/example/users_dbt_model.sql)
  syntax error at or near "'public._airbyte_raw_users'"
  LINE 24: from 'public._airbyte_raw_users'
                ^
  compiled Code at target/run/pgmigrate/models/example/users_dbt_model.sql
[0m15:48:16.799376 [info ] [MainThread]: 
[0m15:48:16.799629 [error] [MainThread]: [31mFailure in test not_null_my_first_dbt_model_id (models/example/schema.yml)[0m
[0m15:48:16.799871 [error] [MainThread]:   Got 1 result, configured to fail if != 0
[0m15:48:16.800076 [info ] [MainThread]: 
[0m15:48:16.800313 [info ] [MainThread]:   compiled code at target/compiled/pgmigrate/models/example/schema.yml/not_null_my_first_dbt_model_id.sql
[0m15:48:16.800526 [info ] [MainThread]: 
[0m15:48:16.800753 [info ] [MainThread]: Done. PASS=2 WARN=0 ERROR=2 SKIP=3 TOTAL=7
[0m15:48:16.801936 [debug] [MainThread]: Resource report: {"command_name": "build", "command_wall_clock_time": 0.74217594, "process_user_time": 1.144421, "process_kernel_time": 0.107729, "process_mem_max_rss": "118865920", "command_success": false, "process_in_blocks": "0", "process_out_blocks": "0"}
[0m15:48:16.802289 [debug] [MainThread]: Command `dbt build` failed at 15:48:16.802244 after 0.74 seconds
[0m15:48:16.802541 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10485ea00>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107cdaaf0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107cdaa60>]}
[0m15:48:16.802781 [debug] [MainThread]: Flushing usage events
[0m15:49:01.089581 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10690ba60>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108920e80>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108920700>]}


============================== 15:49:01.092524 | f18318c5-c3d2-4129-b37c-d993f893f6a5 ==============================
[0m15:49:01.092524 [info ] [MainThread]: Running with dbt=1.8.1
[0m15:49:01.092897 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/Users/shrikanth/Shrikanth/dbt-helloworld', 'fail_fast': 'False', 'warn_error': 'None', 'log_path': '/Users/shrikanth/Shrikanth/dbt-helloworld/logs', 'debug': 'False', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'invocation_command': 'dbt build', 'static_parser': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m15:49:01.250137 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'f18318c5-c3d2-4129-b37c-d993f893f6a5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108c65700>]}
[0m15:49:01.277804 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'f18318c5-c3d2-4129-b37c-d993f893f6a5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107800a30>]}
[0m15:49:01.278398 [info ] [MainThread]: Registered adapter: postgres=1.8.1
[0m15:49:01.291933 [debug] [MainThread]: checksum: ebc509fb14e151ea268e89b60fd5abf912ed99129f87516462718fa2f14f4838, vars: {}, profile: , target: , version: 1.8.1
[0m15:49:01.379849 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m15:49:01.380257 [debug] [MainThread]: Partial parsing: updated file: pgmigrate://models/example/users_dbt_model.sql
[0m15:49:01.500968 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'f18318c5-c3d2-4129-b37c-d993f893f6a5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10957e130>]}
[0m15:49:01.568160 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'f18318c5-c3d2-4129-b37c-d993f893f6a5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x109412cd0>]}
[0m15:49:01.568502 [info ] [MainThread]: Found 3 models, 4 data tests, 527 macros
[0m15:49:01.569517 [info ] [MainThread]: 
[0m15:49:01.569882 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m15:49:01.572054 [debug] [ThreadPool]: Acquiring new postgres connection 'list_postgres'
[0m15:49:01.572372 [debug] [ThreadPool]: Acquiring new postgres connection 'list_postgres'
[0m15:49:01.601000 [debug] [ThreadPool]: Using postgres connection "list_postgres"
[0m15:49:01.601267 [debug] [ThreadPool]: Using postgres connection "list_postgres"
[0m15:49:01.601524 [debug] [ThreadPool]: On list_postgres: /* {"app": "dbt", "dbt_version": "1.8.1", "profile_name": "pgmigrate", "target_name": "dev", "connection_name": "list_postgres"} */

    select distinct nspname from pg_namespace
  
[0m15:49:01.601757 [debug] [ThreadPool]: On list_postgres: /* {"app": "dbt", "dbt_version": "1.8.1", "profile_name": "pgmigrate", "target_name": "dev", "connection_name": "list_postgres"} */

    select distinct nspname from pg_namespace
  
[0m15:49:01.601976 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m15:49:01.602179 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m15:49:01.621512 [debug] [ThreadPool]: SQL status: SELECT 18 in 0.0 seconds
[0m15:49:01.621775 [debug] [ThreadPool]: SQL status: SELECT 18 in 0.0 seconds
[0m15:49:01.622569 [debug] [ThreadPool]: On list_postgres: Close
[0m15:49:01.623218 [debug] [ThreadPool]: On list_postgres: Close
[0m15:49:01.624045 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_postgres, now list_postgres_public)
[0m15:49:01.624351 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_postgres, now list_postgres_public__airbyte_quarantine)
[0m15:49:01.628000 [debug] [ThreadPool]: Using postgres connection "list_postgres_public"
[0m15:49:01.629668 [debug] [ThreadPool]: Using postgres connection "list_postgres_public__airbyte_quarantine"
[0m15:49:01.629907 [debug] [ThreadPool]: On list_postgres_public: BEGIN
[0m15:49:01.630117 [debug] [ThreadPool]: On list_postgres_public__airbyte_quarantine: BEGIN
[0m15:49:01.630328 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m15:49:01.630526 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m15:49:01.635708 [debug] [ThreadPool]: SQL status: BEGIN in 0.0 seconds
[0m15:49:01.635933 [debug] [ThreadPool]: SQL status: BEGIN in 0.0 seconds
[0m15:49:01.636144 [debug] [ThreadPool]: Using postgres connection "list_postgres_public"
[0m15:49:01.636355 [debug] [ThreadPool]: Using postgres connection "list_postgres_public__airbyte_quarantine"
[0m15:49:01.636575 [debug] [ThreadPool]: On list_postgres_public: /* {"app": "dbt", "dbt_version": "1.8.1", "profile_name": "pgmigrate", "target_name": "dev", "connection_name": "list_postgres_public"} */
select
      'postgres' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'postgres' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
    union all
    select
      'postgres' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public'
  
[0m15:49:01.636812 [debug] [ThreadPool]: On list_postgres_public__airbyte_quarantine: /* {"app": "dbt", "dbt_version": "1.8.1", "profile_name": "pgmigrate", "target_name": "dev", "connection_name": "list_postgres_public__airbyte_quarantine"} */
select
      'postgres' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public__airbyte_quarantine'
    union all
    select
      'postgres' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public__airbyte_quarantine'
    union all
    select
      'postgres' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public__airbyte_quarantine'
  
[0m15:49:01.643602 [debug] [ThreadPool]: SQL status: SELECT 0 in 0.0 seconds
[0m15:49:01.643822 [debug] [ThreadPool]: SQL status: SELECT 4 in 0.0 seconds
[0m15:49:01.644449 [debug] [ThreadPool]: On list_postgres_public__airbyte_quarantine: ROLLBACK
[0m15:49:01.645112 [debug] [ThreadPool]: On list_postgres_public: ROLLBACK
[0m15:49:01.645487 [debug] [ThreadPool]: On list_postgres_public__airbyte_quarantine: Close
[0m15:49:01.645689 [debug] [ThreadPool]: On list_postgres_public: Close
[0m15:49:01.648607 [debug] [MainThread]: Using postgres connection "master"
[0m15:49:01.648859 [debug] [MainThread]: On master: BEGIN
[0m15:49:01.649062 [debug] [MainThread]: Opening a new connection, currently in state init
[0m15:49:01.652366 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m15:49:01.652568 [debug] [MainThread]: Using postgres connection "master"
[0m15:49:01.652815 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.8.1", "profile_name": "pgmigrate", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m15:49:01.671639 [debug] [MainThread]: SQL status: SELECT 0 in 0.0 seconds
[0m15:49:01.672288 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'f18318c5-c3d2-4129-b37c-d993f893f6a5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1098378e0>]}
[0m15:49:01.672574 [debug] [MainThread]: On master: ROLLBACK
[0m15:49:01.672919 [debug] [MainThread]: Using postgres connection "master"
[0m15:49:01.673136 [debug] [MainThread]: On master: BEGIN
[0m15:49:01.673545 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m15:49:01.673789 [debug] [MainThread]: On master: COMMIT
[0m15:49:01.673998 [debug] [MainThread]: Using postgres connection "master"
[0m15:49:01.674200 [debug] [MainThread]: On master: COMMIT
[0m15:49:01.674511 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m15:49:01.674725 [debug] [MainThread]: On master: Close
[0m15:49:01.675011 [info ] [MainThread]: Concurrency: 2 threads (target='dev')
[0m15:49:01.675243 [info ] [MainThread]: 
[0m15:49:01.676396 [debug] [Thread-1  ]: Began running node model.pgmigrate.my_first_dbt_model
[0m15:49:01.676677 [debug] [Thread-2  ]: Began running node model.pgmigrate.users_dbt_model
[0m15:49:01.677013 [info ] [Thread-1  ]: 1 of 7 START sql table model public.my_first_dbt_model ......................... [RUN]
[0m15:49:01.677346 [info ] [Thread-2  ]: 2 of 7 START sql view model public__airbyte_quarantine.users_scalar ............ [RUN]
[0m15:49:01.677645 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly list_postgres_public, now model.pgmigrate.my_first_dbt_model)
[0m15:49:01.677907 [debug] [Thread-2  ]: Re-using an available connection from the pool (formerly list_postgres_public__airbyte_quarantine, now model.pgmigrate.users_dbt_model)
[0m15:49:01.678154 [debug] [Thread-1  ]: Began compiling node model.pgmigrate.my_first_dbt_model
[0m15:49:01.678404 [debug] [Thread-2  ]: Began compiling node model.pgmigrate.users_dbt_model
[0m15:49:01.683316 [debug] [Thread-1  ]: Writing injected SQL for node "model.pgmigrate.my_first_dbt_model"
[0m15:49:01.685283 [debug] [Thread-2  ]: Writing injected SQL for node "model.pgmigrate.users_dbt_model"
[0m15:49:01.685769 [debug] [Thread-2  ]: Began executing node model.pgmigrate.users_dbt_model
[0m15:49:01.686023 [debug] [Thread-1  ]: Began executing node model.pgmigrate.my_first_dbt_model
[0m15:49:01.705325 [debug] [Thread-2  ]: Writing runtime sql for node "model.pgmigrate.users_dbt_model"
[0m15:49:01.718333 [debug] [Thread-1  ]: Writing runtime sql for node "model.pgmigrate.my_first_dbt_model"
[0m15:49:01.718747 [debug] [Thread-2  ]: Using postgres connection "model.pgmigrate.users_dbt_model"
[0m15:49:01.719014 [debug] [Thread-1  ]: Using postgres connection "model.pgmigrate.my_first_dbt_model"
[0m15:49:01.719260 [debug] [Thread-2  ]: On model.pgmigrate.users_dbt_model: BEGIN
[0m15:49:01.719507 [debug] [Thread-1  ]: On model.pgmigrate.my_first_dbt_model: BEGIN
[0m15:49:01.719738 [debug] [Thread-2  ]: Opening a new connection, currently in state closed
[0m15:49:01.719961 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m15:49:01.726990 [debug] [Thread-2  ]: SQL status: BEGIN in 0.0 seconds
[0m15:49:01.727227 [debug] [Thread-2  ]: Using postgres connection "model.pgmigrate.users_dbt_model"
[0m15:49:01.727461 [debug] [Thread-1  ]: SQL status: BEGIN in 0.0 seconds
[0m15:49:01.727733 [debug] [Thread-2  ]: On model.pgmigrate.users_dbt_model: /* {"app": "dbt", "dbt_version": "1.8.1", "profile_name": "pgmigrate", "target_name": "dev", "node_id": "model.pgmigrate.users_dbt_model"} */

  create view "postgres"."public__airbyte_quarantine"."users_scalar__dbt_tmp"
    
    
  as (
    
-- SQL model to parse JSON blob stored in a single column and extract into separated field columns as described by the JSON Schema

select
    _airbyte_data['_id'] as legacy_id,
    _airbyte_data['createdAt']  as start_date,
    _airbyte_data ['updatedAt']  as update_date,
    _airbyte_data ['name']  as name,
    _airbyte_data ['email']  as email,
    _airbyte_data ['status']  as status,
    _airbyte_data ['lastName']  as last_name,
    _airbyte_data ['firstName']  as first_name,
    _airbyte_data ['remoteCreatedAt']  as remote_created_at,
    _airbyte_data ['employmentStatus']  as employment_status,
    _airbyte_data ['organization']  as organization,
    _airbyte_data ['onboardingStep']  as onboarding_step,
    _airbyte_emitted_at
from public._airbyte_raw_users
  );
[0m15:49:01.728005 [debug] [Thread-1  ]: Using postgres connection "model.pgmigrate.my_first_dbt_model"
[0m15:49:01.728293 [debug] [Thread-1  ]: On model.pgmigrate.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.8.1", "profile_name": "pgmigrate", "target_name": "dev", "node_id": "model.pgmigrate.my_first_dbt_model"} */

  
    

  create  table "postgres"."public"."my_first_dbt_model__dbt_tmp"
  
  
    as
  
  (
    /*
    Welcome to your first dbt model!
    Did you know that you can also configure models directly within SQL files?
    This will override configurations stated in dbt_project.yml

    Try changing "table" to "view" below
*/



with source_data as (

    select 1 as id
    union all
    select null as id

)

select *
from source_data

/*
    Uncomment the line below to remove records with null `id` values
*/

-- where id is not null
  );
  
[0m15:49:01.732237 [debug] [Thread-1  ]: SQL status: SELECT 2 in 0.0 seconds
[0m15:49:01.735809 [debug] [Thread-1  ]: Using postgres connection "model.pgmigrate.my_first_dbt_model"
[0m15:49:01.736060 [debug] [Thread-2  ]: SQL status: CREATE VIEW in 0.0 seconds
[0m15:49:01.736300 [debug] [Thread-1  ]: On model.pgmigrate.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.8.1", "profile_name": "pgmigrate", "target_name": "dev", "node_id": "model.pgmigrate.my_first_dbt_model"} */
alter table "postgres"."public"."my_first_dbt_model" rename to "my_first_dbt_model__dbt_backup"
[0m15:49:01.738181 [debug] [Thread-2  ]: Using postgres connection "model.pgmigrate.users_dbt_model"
[0m15:49:01.738476 [debug] [Thread-2  ]: On model.pgmigrate.users_dbt_model: /* {"app": "dbt", "dbt_version": "1.8.1", "profile_name": "pgmigrate", "target_name": "dev", "node_id": "model.pgmigrate.users_dbt_model"} */
alter table "postgres"."public__airbyte_quarantine"."users_scalar__dbt_tmp" rename to "users_scalar"
[0m15:49:01.738865 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.0 seconds
[0m15:49:01.740596 [debug] [Thread-1  ]: Using postgres connection "model.pgmigrate.my_first_dbt_model"
[0m15:49:01.740834 [debug] [Thread-2  ]: SQL status: ALTER TABLE in 0.0 seconds
[0m15:49:01.741055 [debug] [Thread-1  ]: On model.pgmigrate.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.8.1", "profile_name": "pgmigrate", "target_name": "dev", "node_id": "model.pgmigrate.my_first_dbt_model"} */
alter table "postgres"."public"."my_first_dbt_model__dbt_tmp" rename to "my_first_dbt_model"
[0m15:49:01.749078 [debug] [Thread-2  ]: On model.pgmigrate.users_dbt_model: COMMIT
[0m15:49:01.749381 [debug] [Thread-2  ]: Using postgres connection "model.pgmigrate.users_dbt_model"
[0m15:49:01.749613 [debug] [Thread-2  ]: On model.pgmigrate.users_dbt_model: COMMIT
[0m15:49:01.749967 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.0 seconds
[0m15:49:01.753771 [debug] [Thread-1  ]: On model.pgmigrate.my_first_dbt_model: COMMIT
[0m15:49:01.754018 [debug] [Thread-2  ]: SQL status: COMMIT in 0.0 seconds
[0m15:49:01.754251 [debug] [Thread-1  ]: Using postgres connection "model.pgmigrate.my_first_dbt_model"
[0m15:49:01.758173 [debug] [Thread-2  ]: Applying DROP to: "postgres"."public__airbyte_quarantine"."users_scalar__dbt_backup"
[0m15:49:01.758447 [debug] [Thread-1  ]: On model.pgmigrate.my_first_dbt_model: COMMIT
[0m15:49:01.760835 [debug] [Thread-2  ]: Using postgres connection "model.pgmigrate.users_dbt_model"
[0m15:49:01.761133 [debug] [Thread-2  ]: On model.pgmigrate.users_dbt_model: /* {"app": "dbt", "dbt_version": "1.8.1", "profile_name": "pgmigrate", "target_name": "dev", "node_id": "model.pgmigrate.users_dbt_model"} */
drop view if exists "postgres"."public__airbyte_quarantine"."users_scalar__dbt_backup" cascade
[0m15:49:01.761497 [debug] [Thread-1  ]: SQL status: COMMIT in 0.0 seconds
[0m15:49:01.761744 [debug] [Thread-2  ]: SQL status: DROP VIEW in 0.0 seconds
[0m15:49:01.784103 [debug] [Thread-1  ]: Applying DROP to: "postgres"."public"."my_first_dbt_model__dbt_backup"
[0m15:49:01.785458 [debug] [Thread-2  ]: On model.pgmigrate.users_dbt_model: Close
[0m15:49:01.787077 [debug] [Thread-1  ]: Using postgres connection "model.pgmigrate.my_first_dbt_model"
[0m15:49:01.787930 [debug] [Thread-2  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'f18318c5-c3d2-4129-b37c-d993f893f6a5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x109b33400>]}
[0m15:49:01.788170 [debug] [Thread-1  ]: On model.pgmigrate.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.8.1", "profile_name": "pgmigrate", "target_name": "dev", "node_id": "model.pgmigrate.my_first_dbt_model"} */
drop table if exists "postgres"."public"."my_first_dbt_model__dbt_backup" cascade
[0m15:49:01.788545 [info ] [Thread-2  ]: 2 of 7 OK created sql view model public__airbyte_quarantine.users_scalar ....... [[32mCREATE VIEW[0m in 0.11s]
[0m15:49:01.788976 [debug] [Thread-2  ]: Finished running node model.pgmigrate.users_dbt_model
[0m15:49:01.790980 [debug] [Thread-1  ]: SQL status: DROP TABLE in 0.0 seconds
[0m15:49:01.791653 [debug] [Thread-1  ]: On model.pgmigrate.my_first_dbt_model: Close
[0m15:49:01.791943 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'f18318c5-c3d2-4129-b37c-d993f893f6a5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x109c793d0>]}
[0m15:49:01.792262 [info ] [Thread-1  ]: 1 of 7 OK created sql table model public.my_first_dbt_model .................... [[32mSELECT 2[0m in 0.11s]
[0m15:49:01.792601 [debug] [Thread-1  ]: Finished running node model.pgmigrate.my_first_dbt_model
[0m15:49:01.793049 [debug] [Thread-2  ]: Began running node test.pgmigrate.not_null_my_first_dbt_model_id.5fb22c2710
[0m15:49:01.793335 [debug] [Thread-1  ]: Began running node test.pgmigrate.unique_my_first_dbt_model_id.16e066b321
[0m15:49:01.793588 [info ] [Thread-2  ]: 3 of 7 START test not_null_my_first_dbt_model_id ............................... [RUN]
[0m15:49:01.793875 [info ] [Thread-1  ]: 4 of 7 START test unique_my_first_dbt_model_id ................................. [RUN]
[0m15:49:01.794209 [debug] [Thread-2  ]: Re-using an available connection from the pool (formerly model.pgmigrate.users_dbt_model, now test.pgmigrate.not_null_my_first_dbt_model_id.5fb22c2710)
[0m15:49:01.794499 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.pgmigrate.my_first_dbt_model, now test.pgmigrate.unique_my_first_dbt_model_id.16e066b321)
[0m15:49:01.794780 [debug] [Thread-2  ]: Began compiling node test.pgmigrate.not_null_my_first_dbt_model_id.5fb22c2710
[0m15:49:01.795027 [debug] [Thread-1  ]: Began compiling node test.pgmigrate.unique_my_first_dbt_model_id.16e066b321
[0m15:49:01.801853 [debug] [Thread-2  ]: Writing injected SQL for node "test.pgmigrate.not_null_my_first_dbt_model_id.5fb22c2710"
[0m15:49:01.805708 [debug] [Thread-1  ]: Writing injected SQL for node "test.pgmigrate.unique_my_first_dbt_model_id.16e066b321"
[0m15:49:01.806265 [debug] [Thread-2  ]: Began executing node test.pgmigrate.not_null_my_first_dbt_model_id.5fb22c2710
[0m15:49:01.806531 [debug] [Thread-1  ]: Began executing node test.pgmigrate.unique_my_first_dbt_model_id.16e066b321
[0m15:49:01.814616 [debug] [Thread-2  ]: Writing runtime sql for node "test.pgmigrate.not_null_my_first_dbt_model_id.5fb22c2710"
[0m15:49:01.816100 [debug] [Thread-1  ]: Writing runtime sql for node "test.pgmigrate.unique_my_first_dbt_model_id.16e066b321"
[0m15:49:01.816534 [debug] [Thread-2  ]: Using postgres connection "test.pgmigrate.not_null_my_first_dbt_model_id.5fb22c2710"
[0m15:49:01.816787 [debug] [Thread-2  ]: On test.pgmigrate.not_null_my_first_dbt_model_id.5fb22c2710: BEGIN
[0m15:49:01.817037 [debug] [Thread-1  ]: Using postgres connection "test.pgmigrate.unique_my_first_dbt_model_id.16e066b321"
[0m15:49:01.817287 [debug] [Thread-2  ]: Opening a new connection, currently in state closed
[0m15:49:01.817537 [debug] [Thread-1  ]: On test.pgmigrate.unique_my_first_dbt_model_id.16e066b321: BEGIN
[0m15:49:01.817837 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m15:49:01.821237 [debug] [Thread-2  ]: SQL status: BEGIN in 0.0 seconds
[0m15:49:01.821515 [debug] [Thread-1  ]: SQL status: BEGIN in 0.0 seconds
[0m15:49:01.821768 [debug] [Thread-2  ]: Using postgres connection "test.pgmigrate.not_null_my_first_dbt_model_id.5fb22c2710"
[0m15:49:01.822007 [debug] [Thread-1  ]: Using postgres connection "test.pgmigrate.unique_my_first_dbt_model_id.16e066b321"
[0m15:49:01.822251 [debug] [Thread-2  ]: On test.pgmigrate.not_null_my_first_dbt_model_id.5fb22c2710: /* {"app": "dbt", "dbt_version": "1.8.1", "profile_name": "pgmigrate", "target_name": "dev", "node_id": "test.pgmigrate.not_null_my_first_dbt_model_id.5fb22c2710"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select id
from "postgres"."public"."my_first_dbt_model"
where id is null



      
    ) dbt_internal_test
[0m15:49:01.822516 [debug] [Thread-1  ]: On test.pgmigrate.unique_my_first_dbt_model_id.16e066b321: /* {"app": "dbt", "dbt_version": "1.8.1", "profile_name": "pgmigrate", "target_name": "dev", "node_id": "test.pgmigrate.unique_my_first_dbt_model_id.16e066b321"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

select
    id as unique_field,
    count(*) as n_records

from "postgres"."public"."my_first_dbt_model"
where id is not null
group by id
having count(*) > 1



      
    ) dbt_internal_test
[0m15:49:01.824123 [debug] [Thread-2  ]: SQL status: SELECT 1 in 0.0 seconds
[0m15:49:01.825871 [debug] [Thread-2  ]: On test.pgmigrate.not_null_my_first_dbt_model_id.5fb22c2710: ROLLBACK
[0m15:49:01.826125 [debug] [Thread-1  ]: SQL status: SELECT 1 in 0.0 seconds
[0m15:49:01.826909 [debug] [Thread-1  ]: On test.pgmigrate.unique_my_first_dbt_model_id.16e066b321: ROLLBACK
[0m15:49:01.827150 [debug] [Thread-2  ]: On test.pgmigrate.not_null_my_first_dbt_model_id.5fb22c2710: Close
[0m15:49:01.827723 [debug] [Thread-1  ]: On test.pgmigrate.unique_my_first_dbt_model_id.16e066b321: Close
[0m15:49:01.827530 [error] [Thread-2  ]: 3 of 7 FAIL 1 not_null_my_first_dbt_model_id ................................... [[31mFAIL 1[0m in 0.03s]
[0m15:49:01.828138 [info ] [Thread-1  ]: 4 of 7 PASS unique_my_first_dbt_model_id ....................................... [[32mPASS[0m in 0.03s]
[0m15:49:01.828485 [debug] [Thread-2  ]: Finished running node test.pgmigrate.not_null_my_first_dbt_model_id.5fb22c2710
[0m15:49:01.828799 [debug] [Thread-1  ]: Finished running node test.pgmigrate.unique_my_first_dbt_model_id.16e066b321
[0m15:49:01.829270 [debug] [Thread-2  ]: Began running node model.pgmigrate.my_second_dbt_model
[0m15:49:01.829620 [info ] [Thread-2  ]: 5 of 7 SKIP relation public.my_second_dbt_model ................................ [[33mSKIP[0m]
[0m15:49:01.829917 [debug] [Thread-2  ]: Finished running node model.pgmigrate.my_second_dbt_model
[0m15:49:01.830308 [debug] [Thread-1  ]: Began running node test.pgmigrate.not_null_my_second_dbt_model_id.151b76d778
[0m15:49:01.830577 [debug] [Thread-2  ]: Began running node test.pgmigrate.unique_my_second_dbt_model_id.57a0f8c493
[0m15:49:01.830837 [info ] [Thread-1  ]: 6 of 7 SKIP test not_null_my_second_dbt_model_id ............................... [[33mSKIP[0m]
[0m15:49:01.831116 [info ] [Thread-2  ]: 7 of 7 SKIP test unique_my_second_dbt_model_id ................................. [[33mSKIP[0m]
[0m15:49:01.831390 [debug] [Thread-1  ]: Finished running node test.pgmigrate.not_null_my_second_dbt_model_id.151b76d778
[0m15:49:01.831639 [debug] [Thread-2  ]: Finished running node test.pgmigrate.unique_my_second_dbt_model_id.57a0f8c493
[0m15:49:01.832216 [debug] [MainThread]: Using postgres connection "master"
[0m15:49:01.832414 [debug] [MainThread]: On master: BEGIN
[0m15:49:01.832598 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m15:49:01.837481 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m15:49:01.837781 [debug] [MainThread]: On master: COMMIT
[0m15:49:01.838021 [debug] [MainThread]: Using postgres connection "master"
[0m15:49:01.838233 [debug] [MainThread]: On master: COMMIT
[0m15:49:01.838536 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m15:49:01.838802 [debug] [MainThread]: On master: Close
[0m15:49:01.839147 [debug] [MainThread]: Connection 'master' was properly closed.
[0m15:49:01.839357 [debug] [MainThread]: Connection 'test.pgmigrate.unique_my_first_dbt_model_id.16e066b321' was properly closed.
[0m15:49:01.839567 [debug] [MainThread]: Connection 'test.pgmigrate.not_null_my_first_dbt_model_id.5fb22c2710' was properly closed.
[0m15:49:01.839815 [info ] [MainThread]: 
[0m15:49:01.840083 [info ] [MainThread]: Finished running 2 view models, 1 table model, 4 data tests in 0 hours 0 minutes and 0.27 seconds (0.27s).
[0m15:49:01.840810 [debug] [MainThread]: Command end result
[0m15:49:01.862023 [info ] [MainThread]: 
[0m15:49:01.862348 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m15:49:01.862579 [info ] [MainThread]: 
[0m15:49:01.862853 [error] [MainThread]: [31mFailure in test not_null_my_first_dbt_model_id (models/example/schema.yml)[0m
[0m15:49:01.863102 [error] [MainThread]:   Got 1 result, configured to fail if != 0
[0m15:49:01.863309 [info ] [MainThread]: 
[0m15:49:01.863549 [info ] [MainThread]:   compiled code at target/compiled/pgmigrate/models/example/schema.yml/not_null_my_first_dbt_model_id.sql
[0m15:49:01.863765 [info ] [MainThread]: 
[0m15:49:01.863988 [info ] [MainThread]: Done. PASS=3 WARN=0 ERROR=1 SKIP=3 TOTAL=7
[0m15:49:01.865206 [debug] [MainThread]: Resource report: {"command_name": "build", "command_wall_clock_time": 0.81821024, "process_user_time": 1.154561, "process_kernel_time": 0.139203, "process_mem_max_rss": "117555200", "command_success": false, "process_in_blocks": "0", "process_out_blocks": "0"}
[0m15:49:01.865510 [debug] [MainThread]: Command `dbt build` failed at 15:49:01.865470 after 0.82 seconds
[0m15:49:01.865754 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10690ba60>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1085ac250>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1085ac280>]}
[0m15:49:01.865990 [debug] [MainThread]: Flushing usage events
[0m15:49:59.092825 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104d17a90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10716ceb0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10716c730>]}


============================== 15:49:59.096007 | 8e636635-f00b-489f-9623-085f42979781 ==============================
[0m15:49:59.096007 [info ] [MainThread]: Running with dbt=1.8.1
[0m15:49:59.096423 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/Users/shrikanth/Shrikanth/dbt-helloworld', 'debug': 'False', 'version_check': 'True', 'log_path': '/Users/shrikanth/Shrikanth/dbt-helloworld/logs', 'fail_fast': 'False', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'invocation_command': 'dbt build', 'introspect': 'True', 'static_parser': 'True', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m15:49:59.268606 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '8e636635-f00b-489f-9623-085f42979781', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107570790>]}
[0m15:49:59.300714 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '8e636635-f00b-489f-9623-085f42979781', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107479fa0>]}
[0m15:49:59.302177 [info ] [MainThread]: Registered adapter: postgres=1.8.1
[0m15:49:59.319932 [debug] [MainThread]: checksum: ebc509fb14e151ea268e89b60fd5abf912ed99129f87516462718fa2f14f4838, vars: {}, profile: , target: , version: 1.8.1
[0m15:49:59.418705 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m15:49:59.419265 [debug] [MainThread]: Partial parsing: updated file: pgmigrate://models/example/schema.yml
[0m15:49:59.642621 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '8e636635-f00b-489f-9623-085f42979781', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x111b1cdf0>]}
[0m15:49:59.715345 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '8e636635-f00b-489f-9623-085f42979781', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x111b29640>]}
[0m15:49:59.715745 [info ] [MainThread]: Found 3 models, 4 data tests, 527 macros
[0m15:49:59.716789 [info ] [MainThread]: 
[0m15:49:59.717171 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m15:49:59.719683 [debug] [ThreadPool]: Acquiring new postgres connection 'list_postgres'
[0m15:49:59.720356 [debug] [ThreadPool]: Acquiring new postgres connection 'list_postgres'
[0m15:49:59.761707 [debug] [ThreadPool]: Using postgres connection "list_postgres"
[0m15:49:59.762044 [debug] [ThreadPool]: Using postgres connection "list_postgres"
[0m15:49:59.762380 [debug] [ThreadPool]: On list_postgres: /* {"app": "dbt", "dbt_version": "1.8.1", "profile_name": "pgmigrate", "target_name": "dev", "connection_name": "list_postgres"} */

    select distinct nspname from pg_namespace
  
[0m15:49:59.763047 [debug] [ThreadPool]: On list_postgres: /* {"app": "dbt", "dbt_version": "1.8.1", "profile_name": "pgmigrate", "target_name": "dev", "connection_name": "list_postgres"} */

    select distinct nspname from pg_namespace
  
[0m15:49:59.763579 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m15:49:59.764078 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m15:49:59.787299 [debug] [ThreadPool]: SQL status: SELECT 18 in 0.0 seconds
[0m15:49:59.787622 [debug] [ThreadPool]: SQL status: SELECT 18 in 0.0 seconds
[0m15:49:59.789364 [debug] [ThreadPool]: On list_postgres: Close
[0m15:49:59.790596 [debug] [ThreadPool]: On list_postgres: Close
[0m15:49:59.792057 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_postgres, now list_postgres_public__airbyte_quarantine)
[0m15:49:59.792900 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_postgres, now list_postgres_public)
[0m15:49:59.798329 [debug] [ThreadPool]: Using postgres connection "list_postgres_public__airbyte_quarantine"
[0m15:49:59.799813 [debug] [ThreadPool]: Using postgres connection "list_postgres_public"
[0m15:49:59.800056 [debug] [ThreadPool]: On list_postgres_public__airbyte_quarantine: BEGIN
[0m15:49:59.800277 [debug] [ThreadPool]: On list_postgres_public: BEGIN
[0m15:49:59.800499 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m15:49:59.800702 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m15:49:59.806021 [debug] [ThreadPool]: SQL status: BEGIN in 0.0 seconds
[0m15:49:59.806639 [debug] [ThreadPool]: SQL status: BEGIN in 0.0 seconds
[0m15:49:59.806886 [debug] [ThreadPool]: Using postgres connection "list_postgres_public__airbyte_quarantine"
[0m15:49:59.807113 [debug] [ThreadPool]: Using postgres connection "list_postgres_public"
[0m15:49:59.807351 [debug] [ThreadPool]: On list_postgres_public__airbyte_quarantine: /* {"app": "dbt", "dbt_version": "1.8.1", "profile_name": "pgmigrate", "target_name": "dev", "connection_name": "list_postgres_public__airbyte_quarantine"} */
select
      'postgres' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public__airbyte_quarantine'
    union all
    select
      'postgres' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public__airbyte_quarantine'
    union all
    select
      'postgres' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public__airbyte_quarantine'
  
[0m15:49:59.807604 [debug] [ThreadPool]: On list_postgres_public: /* {"app": "dbt", "dbt_version": "1.8.1", "profile_name": "pgmigrate", "target_name": "dev", "connection_name": "list_postgres_public"} */
select
      'postgres' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'postgres' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
    union all
    select
      'postgres' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public'
  
[0m15:49:59.810895 [debug] [ThreadPool]: SQL status: SELECT 4 in 0.0 seconds
[0m15:49:59.811525 [debug] [ThreadPool]: SQL status: SELECT 1 in 0.0 seconds
[0m15:49:59.813394 [debug] [ThreadPool]: On list_postgres_public: ROLLBACK
[0m15:49:59.814291 [debug] [ThreadPool]: On list_postgres_public__airbyte_quarantine: ROLLBACK
[0m15:49:59.814711 [debug] [ThreadPool]: On list_postgres_public: Close
[0m15:49:59.815217 [debug] [ThreadPool]: On list_postgres_public__airbyte_quarantine: Close
[0m15:49:59.819481 [debug] [MainThread]: Using postgres connection "master"
[0m15:49:59.819766 [debug] [MainThread]: On master: BEGIN
[0m15:49:59.819978 [debug] [MainThread]: Opening a new connection, currently in state init
[0m15:49:59.823893 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m15:49:59.824492 [debug] [MainThread]: Using postgres connection "master"
[0m15:49:59.824808 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.8.1", "profile_name": "pgmigrate", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m15:49:59.835998 [debug] [MainThread]: SQL status: SELECT 1 in 0.0 seconds
[0m15:49:59.838110 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '8e636635-f00b-489f-9623-085f42979781', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1070fd640>]}
[0m15:49:59.838789 [debug] [MainThread]: On master: ROLLBACK
[0m15:49:59.839420 [debug] [MainThread]: Using postgres connection "master"
[0m15:49:59.839950 [debug] [MainThread]: On master: BEGIN
[0m15:49:59.840599 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m15:49:59.841101 [debug] [MainThread]: On master: COMMIT
[0m15:49:59.841578 [debug] [MainThread]: Using postgres connection "master"
[0m15:49:59.842044 [debug] [MainThread]: On master: COMMIT
[0m15:49:59.842604 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m15:49:59.842919 [debug] [MainThread]: On master: Close
[0m15:49:59.843264 [info ] [MainThread]: Concurrency: 2 threads (target='dev')
[0m15:49:59.843506 [info ] [MainThread]: 
[0m15:49:59.845323 [debug] [Thread-1  ]: Began running node model.pgmigrate.my_first_dbt_model
[0m15:49:59.845981 [debug] [Thread-2  ]: Began running node model.pgmigrate.users_dbt_model
[0m15:49:59.846819 [info ] [Thread-1  ]: 1 of 7 START sql table model public.my_first_dbt_model ......................... [RUN]
[0m15:49:59.847609 [info ] [Thread-2  ]: 2 of 7 START sql view model public__airbyte_quarantine.users_scalar ............ [RUN]
[0m15:49:59.848310 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly list_postgres_public__airbyte_quarantine, now model.pgmigrate.my_first_dbt_model)
[0m15:49:59.848792 [debug] [Thread-2  ]: Re-using an available connection from the pool (formerly list_postgres_public, now model.pgmigrate.users_dbt_model)
[0m15:49:59.849241 [debug] [Thread-1  ]: Began compiling node model.pgmigrate.my_first_dbt_model
[0m15:49:59.849902 [debug] [Thread-2  ]: Began compiling node model.pgmigrate.users_dbt_model
[0m15:49:59.884468 [debug] [Thread-1  ]: Writing injected SQL for node "model.pgmigrate.my_first_dbt_model"
[0m15:49:59.886660 [debug] [Thread-2  ]: Writing injected SQL for node "model.pgmigrate.users_dbt_model"
[0m15:49:59.887776 [debug] [Thread-1  ]: Began executing node model.pgmigrate.my_first_dbt_model
[0m15:49:59.912333 [debug] [Thread-1  ]: Writing runtime sql for node "model.pgmigrate.my_first_dbt_model"
[0m15:49:59.912684 [debug] [Thread-2  ]: Began executing node model.pgmigrate.users_dbt_model
[0m15:49:59.929488 [debug] [Thread-2  ]: Writing runtime sql for node "model.pgmigrate.users_dbt_model"
[0m15:49:59.930237 [debug] [Thread-1  ]: Using postgres connection "model.pgmigrate.my_first_dbt_model"
[0m15:49:59.931027 [debug] [Thread-1  ]: On model.pgmigrate.my_first_dbt_model: BEGIN
[0m15:49:59.931648 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m15:49:59.932387 [debug] [Thread-2  ]: Using postgres connection "model.pgmigrate.users_dbt_model"
[0m15:49:59.932972 [debug] [Thread-2  ]: On model.pgmigrate.users_dbt_model: BEGIN
[0m15:49:59.933372 [debug] [Thread-2  ]: Opening a new connection, currently in state closed
[0m15:49:59.936463 [debug] [Thread-1  ]: SQL status: BEGIN in 0.0 seconds
[0m15:49:59.937242 [debug] [Thread-1  ]: Using postgres connection "model.pgmigrate.my_first_dbt_model"
[0m15:49:59.937839 [debug] [Thread-2  ]: SQL status: BEGIN in 0.0 seconds
[0m15:49:59.938481 [debug] [Thread-1  ]: On model.pgmigrate.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.8.1", "profile_name": "pgmigrate", "target_name": "dev", "node_id": "model.pgmigrate.my_first_dbt_model"} */

  
    

  create  table "postgres"."public"."my_first_dbt_model__dbt_tmp"
  
  
    as
  
  (
    /*
    Welcome to your first dbt model!
    Did you know that you can also configure models directly within SQL files?
    This will override configurations stated in dbt_project.yml

    Try changing "table" to "view" below
*/



with source_data as (

    select 1 as id
    union all
    select null as id

)

select *
from source_data

/*
    Uncomment the line below to remove records with null `id` values
*/

-- where id is not null
  );
  
[0m15:49:59.939117 [debug] [Thread-2  ]: Using postgres connection "model.pgmigrate.users_dbt_model"
[0m15:49:59.939816 [debug] [Thread-2  ]: On model.pgmigrate.users_dbt_model: /* {"app": "dbt", "dbt_version": "1.8.1", "profile_name": "pgmigrate", "target_name": "dev", "node_id": "model.pgmigrate.users_dbt_model"} */

  create view "postgres"."public__airbyte_quarantine"."users_scalar__dbt_tmp"
    
    
  as (
    
-- SQL model to parse JSON blob stored in a single column and extract into separated field columns as described by the JSON Schema

select
    _airbyte_data['_id'] as legacy_id,
    _airbyte_data['createdAt']  as start_date,
    _airbyte_data ['updatedAt']  as update_date,
    _airbyte_data ['name']  as name,
    _airbyte_data ['email']  as email,
    _airbyte_data ['status']  as status,
    _airbyte_data ['lastName']  as last_name,
    _airbyte_data ['firstName']  as first_name,
    _airbyte_data ['remoteCreatedAt']  as remote_created_at,
    _airbyte_data ['employmentStatus']  as employment_status,
    _airbyte_data ['organization']  as organization,
    _airbyte_data ['onboardingStep']  as onboarding_step,
    _airbyte_emitted_at
from public._airbyte_raw_users
  );
[0m15:49:59.941260 [debug] [Thread-1  ]: SQL status: SELECT 2 in 0.0 seconds
[0m15:49:59.945990 [debug] [Thread-1  ]: Using postgres connection "model.pgmigrate.my_first_dbt_model"
[0m15:49:59.946295 [debug] [Thread-2  ]: SQL status: CREATE VIEW in 0.0 seconds
[0m15:49:59.946681 [debug] [Thread-1  ]: On model.pgmigrate.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.8.1", "profile_name": "pgmigrate", "target_name": "dev", "node_id": "model.pgmigrate.my_first_dbt_model"} */
alter table "postgres"."public"."my_first_dbt_model" rename to "my_first_dbt_model__dbt_backup"
[0m15:49:59.951980 [debug] [Thread-2  ]: Using postgres connection "model.pgmigrate.users_dbt_model"
[0m15:49:59.952521 [debug] [Thread-2  ]: On model.pgmigrate.users_dbt_model: /* {"app": "dbt", "dbt_version": "1.8.1", "profile_name": "pgmigrate", "target_name": "dev", "node_id": "model.pgmigrate.users_dbt_model"} */
alter table "postgres"."public__airbyte_quarantine"."users_scalar" rename to "users_scalar__dbt_backup"
[0m15:49:59.952816 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.0 seconds
[0m15:49:59.957452 [debug] [Thread-1  ]: Using postgres connection "model.pgmigrate.my_first_dbt_model"
[0m15:49:59.958126 [debug] [Thread-2  ]: SQL status: ALTER TABLE in 0.0 seconds
[0m15:49:59.958738 [debug] [Thread-1  ]: On model.pgmigrate.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.8.1", "profile_name": "pgmigrate", "target_name": "dev", "node_id": "model.pgmigrate.my_first_dbt_model"} */
alter table "postgres"."public"."my_first_dbt_model__dbt_tmp" rename to "my_first_dbt_model"
[0m15:49:59.961476 [debug] [Thread-2  ]: Using postgres connection "model.pgmigrate.users_dbt_model"
[0m15:49:59.961978 [debug] [Thread-2  ]: On model.pgmigrate.users_dbt_model: /* {"app": "dbt", "dbt_version": "1.8.1", "profile_name": "pgmigrate", "target_name": "dev", "node_id": "model.pgmigrate.users_dbt_model"} */
alter table "postgres"."public__airbyte_quarantine"."users_scalar__dbt_tmp" rename to "users_scalar"
[0m15:49:59.962351 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.0 seconds
[0m15:49:59.968557 [debug] [Thread-2  ]: SQL status: ALTER TABLE in 0.0 seconds
[0m15:49:59.986056 [debug] [Thread-1  ]: On model.pgmigrate.my_first_dbt_model: COMMIT
[0m15:49:59.988399 [debug] [Thread-2  ]: On model.pgmigrate.users_dbt_model: COMMIT
[0m15:49:59.988714 [debug] [Thread-1  ]: Using postgres connection "model.pgmigrate.my_first_dbt_model"
[0m15:49:59.988969 [debug] [Thread-2  ]: Using postgres connection "model.pgmigrate.users_dbt_model"
[0m15:49:59.989210 [debug] [Thread-1  ]: On model.pgmigrate.my_first_dbt_model: COMMIT
[0m15:49:59.989446 [debug] [Thread-2  ]: On model.pgmigrate.users_dbt_model: COMMIT
[0m15:49:59.990248 [debug] [Thread-1  ]: SQL status: COMMIT in 0.0 seconds
[0m15:49:59.990868 [debug] [Thread-2  ]: SQL status: COMMIT in 0.0 seconds
[0m15:49:59.998488 [debug] [Thread-1  ]: Applying DROP to: "postgres"."public"."my_first_dbt_model__dbt_backup"
[0m15:50:00.000974 [debug] [Thread-2  ]: Applying DROP to: "postgres"."public__airbyte_quarantine"."users_scalar__dbt_backup"
[0m15:50:00.006036 [debug] [Thread-1  ]: Using postgres connection "model.pgmigrate.my_first_dbt_model"
[0m15:50:00.007629 [debug] [Thread-2  ]: Using postgres connection "model.pgmigrate.users_dbt_model"
[0m15:50:00.008184 [debug] [Thread-2  ]: On model.pgmigrate.users_dbt_model: /* {"app": "dbt", "dbt_version": "1.8.1", "profile_name": "pgmigrate", "target_name": "dev", "node_id": "model.pgmigrate.users_dbt_model"} */
drop view if exists "postgres"."public__airbyte_quarantine"."users_scalar__dbt_backup" cascade
[0m15:50:00.007916 [debug] [Thread-1  ]: On model.pgmigrate.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.8.1", "profile_name": "pgmigrate", "target_name": "dev", "node_id": "model.pgmigrate.my_first_dbt_model"} */
drop table if exists "postgres"."public"."my_first_dbt_model__dbt_backup" cascade
[0m15:50:00.012139 [debug] [Thread-2  ]: SQL status: DROP VIEW in 0.0 seconds
[0m15:50:00.012840 [debug] [Thread-1  ]: SQL status: DROP TABLE in 0.0 seconds
[0m15:50:00.016110 [debug] [Thread-2  ]: On model.pgmigrate.users_dbt_model: Close
[0m15:50:00.017247 [debug] [Thread-1  ]: On model.pgmigrate.my_first_dbt_model: Close
[0m15:50:00.018180 [debug] [Thread-2  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '8e636635-f00b-489f-9623-085f42979781', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1121d1a00>]}
[0m15:50:00.018517 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '8e636635-f00b-489f-9623-085f42979781', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1121d1f10>]}
[0m15:50:00.018924 [info ] [Thread-2  ]: 2 of 7 OK created sql view model public__airbyte_quarantine.users_scalar ....... [[32mCREATE VIEW[0m in 0.17s]
[0m15:50:00.019328 [info ] [Thread-1  ]: 1 of 7 OK created sql table model public.my_first_dbt_model .................... [[32mSELECT 2[0m in 0.17s]
[0m15:50:00.019700 [debug] [Thread-2  ]: Finished running node model.pgmigrate.users_dbt_model
[0m15:50:00.020050 [debug] [Thread-1  ]: Finished running node model.pgmigrate.my_first_dbt_model
[0m15:50:00.020858 [debug] [Thread-2  ]: Began running node test.pgmigrate.not_null_users_dbt_model_id.57531ba63f
[0m15:50:00.021883 [debug] [Thread-1  ]: Began running node test.pgmigrate.unique_users_dbt_model_id.6fb832f098
[0m15:50:00.022837 [info ] [Thread-2  ]: 3 of 7 START test not_null_users_dbt_model_id .................................. [RUN]
[0m15:50:00.023634 [info ] [Thread-1  ]: 4 of 7 START test unique_users_dbt_model_id .................................... [RUN]
[0m15:50:00.024448 [debug] [Thread-2  ]: Re-using an available connection from the pool (formerly model.pgmigrate.users_dbt_model, now test.pgmigrate.not_null_users_dbt_model_id.57531ba63f)
[0m15:50:00.025132 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.pgmigrate.my_first_dbt_model, now test.pgmigrate.unique_users_dbt_model_id.6fb832f098)
[0m15:50:00.025889 [debug] [Thread-2  ]: Began compiling node test.pgmigrate.not_null_users_dbt_model_id.57531ba63f
[0m15:50:00.026164 [debug] [Thread-1  ]: Began compiling node test.pgmigrate.unique_users_dbt_model_id.6fb832f098
[0m15:50:00.037380 [debug] [Thread-2  ]: Writing injected SQL for node "test.pgmigrate.not_null_users_dbt_model_id.57531ba63f"
[0m15:50:00.041661 [debug] [Thread-1  ]: Writing injected SQL for node "test.pgmigrate.unique_users_dbt_model_id.6fb832f098"
[0m15:50:00.042528 [debug] [Thread-1  ]: Began executing node test.pgmigrate.unique_users_dbt_model_id.6fb832f098
[0m15:50:00.043172 [debug] [Thread-2  ]: Began executing node test.pgmigrate.not_null_users_dbt_model_id.57531ba63f
[0m15:50:00.055995 [debug] [Thread-1  ]: Writing runtime sql for node "test.pgmigrate.unique_users_dbt_model_id.6fb832f098"
[0m15:50:00.057916 [debug] [Thread-2  ]: Writing runtime sql for node "test.pgmigrate.not_null_users_dbt_model_id.57531ba63f"
[0m15:50:00.058473 [debug] [Thread-1  ]: Using postgres connection "test.pgmigrate.unique_users_dbt_model_id.6fb832f098"
[0m15:50:00.058915 [debug] [Thread-1  ]: On test.pgmigrate.unique_users_dbt_model_id.6fb832f098: BEGIN
[0m15:50:00.059642 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m15:50:00.060020 [debug] [Thread-2  ]: Using postgres connection "test.pgmigrate.not_null_users_dbt_model_id.57531ba63f"
[0m15:50:00.060576 [debug] [Thread-2  ]: On test.pgmigrate.not_null_users_dbt_model_id.57531ba63f: BEGIN
[0m15:50:00.061191 [debug] [Thread-2  ]: Opening a new connection, currently in state closed
[0m15:50:00.064312 [debug] [Thread-1  ]: SQL status: BEGIN in 0.0 seconds
[0m15:50:00.065067 [debug] [Thread-1  ]: Using postgres connection "test.pgmigrate.unique_users_dbt_model_id.6fb832f098"
[0m15:50:00.065651 [debug] [Thread-2  ]: SQL status: BEGIN in 0.0 seconds
[0m15:50:00.066358 [debug] [Thread-1  ]: On test.pgmigrate.unique_users_dbt_model_id.6fb832f098: /* {"app": "dbt", "dbt_version": "1.8.1", "profile_name": "pgmigrate", "target_name": "dev", "node_id": "test.pgmigrate.unique_users_dbt_model_id.6fb832f098"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

select
    id as unique_field,
    count(*) as n_records

from "postgres"."public__airbyte_quarantine"."users_scalar"
where id is not null
group by id
having count(*) > 1



      
    ) dbt_internal_test
[0m15:50:00.066964 [debug] [Thread-2  ]: Using postgres connection "test.pgmigrate.not_null_users_dbt_model_id.57531ba63f"
[0m15:50:00.067606 [debug] [Thread-2  ]: On test.pgmigrate.not_null_users_dbt_model_id.57531ba63f: /* {"app": "dbt", "dbt_version": "1.8.1", "profile_name": "pgmigrate", "target_name": "dev", "node_id": "test.pgmigrate.not_null_users_dbt_model_id.57531ba63f"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select id
from "postgres"."public__airbyte_quarantine"."users_scalar"
where id is null



      
    ) dbt_internal_test
[0m15:50:00.068200 [debug] [Thread-1  ]: Postgres adapter: Postgres error: column "id" does not exist
LINE 12:     id as unique_field,
             ^

[0m15:50:00.068880 [debug] [Thread-1  ]: On test.pgmigrate.unique_users_dbt_model_id.6fb832f098: ROLLBACK
[0m15:50:00.069472 [debug] [Thread-2  ]: Postgres adapter: Postgres error: column "id" does not exist
LINE 13: select id
                ^

[0m15:50:00.069738 [debug] [Thread-2  ]: On test.pgmigrate.not_null_users_dbt_model_id.57531ba63f: ROLLBACK
[0m15:50:00.070427 [debug] [Thread-1  ]: On test.pgmigrate.unique_users_dbt_model_id.6fb832f098: Close
[0m15:50:00.070908 [debug] [Thread-2  ]: On test.pgmigrate.not_null_users_dbt_model_id.57531ba63f: Close
[0m15:50:00.076423 [debug] [Thread-2  ]: Database Error in test not_null_users_dbt_model_id (models/example/schema.yml)
  column "id" does not exist
  LINE 13: select id
                  ^
  compiled Code at target/run/pgmigrate/models/example/schema.yml/not_null_users_dbt_model_id.sql
[0m15:50:00.076918 [debug] [Thread-1  ]: Database Error in test unique_users_dbt_model_id (models/example/schema.yml)
  column "id" does not exist
  LINE 12:     id as unique_field,
               ^
  compiled Code at target/run/pgmigrate/models/example/schema.yml/unique_users_dbt_model_id.sql
[0m15:50:00.077265 [error] [Thread-2  ]: 3 of 7 ERROR not_null_users_dbt_model_id ....................................... [[31mERROR[0m in 0.05s]
[0m15:50:00.078044 [error] [Thread-1  ]: 4 of 7 ERROR unique_users_dbt_model_id ......................................... [[31mERROR[0m in 0.05s]
[0m15:50:00.078946 [debug] [Thread-2  ]: Finished running node test.pgmigrate.not_null_users_dbt_model_id.57531ba63f
[0m15:50:00.079329 [debug] [Thread-1  ]: Finished running node test.pgmigrate.unique_users_dbt_model_id.6fb832f098
[0m15:50:00.079623 [debug] [Thread-2  ]: Began running node test.pgmigrate.not_null_my_first_dbt_model_id.5fb22c2710
[0m15:50:00.080170 [debug] [Thread-1  ]: Began running node test.pgmigrate.unique_my_first_dbt_model_id.16e066b321
[0m15:50:00.080927 [info ] [Thread-2  ]: 5 of 7 START test not_null_my_first_dbt_model_id ............................... [RUN]
[0m15:50:00.081599 [info ] [Thread-1  ]: 6 of 7 START test unique_my_first_dbt_model_id ................................. [RUN]
[0m15:50:00.082312 [debug] [Thread-2  ]: Re-using an available connection from the pool (formerly test.pgmigrate.not_null_users_dbt_model_id.57531ba63f, now test.pgmigrate.not_null_my_first_dbt_model_id.5fb22c2710)
[0m15:50:00.082928 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly test.pgmigrate.unique_users_dbt_model_id.6fb832f098, now test.pgmigrate.unique_my_first_dbt_model_id.16e066b321)
[0m15:50:00.083701 [debug] [Thread-2  ]: Began compiling node test.pgmigrate.not_null_my_first_dbt_model_id.5fb22c2710
[0m15:50:00.084279 [debug] [Thread-1  ]: Began compiling node test.pgmigrate.unique_my_first_dbt_model_id.16e066b321
[0m15:50:00.087599 [debug] [Thread-2  ]: Writing injected SQL for node "test.pgmigrate.not_null_my_first_dbt_model_id.5fb22c2710"
[0m15:50:00.091471 [debug] [Thread-1  ]: Writing injected SQL for node "test.pgmigrate.unique_my_first_dbt_model_id.16e066b321"
[0m15:50:00.092156 [debug] [Thread-2  ]: Began executing node test.pgmigrate.not_null_my_first_dbt_model_id.5fb22c2710
[0m15:50:00.092584 [debug] [Thread-1  ]: Began executing node test.pgmigrate.unique_my_first_dbt_model_id.16e066b321
[0m15:50:00.097041 [debug] [Thread-2  ]: Writing runtime sql for node "test.pgmigrate.not_null_my_first_dbt_model_id.5fb22c2710"
[0m15:50:00.101152 [debug] [Thread-1  ]: Writing runtime sql for node "test.pgmigrate.unique_my_first_dbt_model_id.16e066b321"
[0m15:50:00.102205 [debug] [Thread-1  ]: Using postgres connection "test.pgmigrate.unique_my_first_dbt_model_id.16e066b321"
[0m15:50:00.102637 [debug] [Thread-2  ]: Using postgres connection "test.pgmigrate.not_null_my_first_dbt_model_id.5fb22c2710"
[0m15:50:00.102877 [debug] [Thread-1  ]: On test.pgmigrate.unique_my_first_dbt_model_id.16e066b321: BEGIN
[0m15:50:00.105208 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m15:50:00.103647 [debug] [Thread-2  ]: On test.pgmigrate.not_null_my_first_dbt_model_id.5fb22c2710: BEGIN
[0m15:50:00.106207 [debug] [Thread-2  ]: Opening a new connection, currently in state closed
[0m15:50:00.112049 [debug] [Thread-1  ]: SQL status: BEGIN in 0.0 seconds
[0m15:50:00.112850 [debug] [Thread-1  ]: Using postgres connection "test.pgmigrate.unique_my_first_dbt_model_id.16e066b321"
[0m15:50:00.113539 [debug] [Thread-1  ]: On test.pgmigrate.unique_my_first_dbt_model_id.16e066b321: /* {"app": "dbt", "dbt_version": "1.8.1", "profile_name": "pgmigrate", "target_name": "dev", "node_id": "test.pgmigrate.unique_my_first_dbt_model_id.16e066b321"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

select
    id as unique_field,
    count(*) as n_records

from "postgres"."public"."my_first_dbt_model"
where id is not null
group by id
having count(*) > 1



      
    ) dbt_internal_test
[0m15:50:00.114182 [debug] [Thread-2  ]: SQL status: BEGIN in 0.0 seconds
[0m15:50:00.114900 [debug] [Thread-2  ]: Using postgres connection "test.pgmigrate.not_null_my_first_dbt_model_id.5fb22c2710"
[0m15:50:00.115537 [debug] [Thread-2  ]: On test.pgmigrate.not_null_my_first_dbt_model_id.5fb22c2710: /* {"app": "dbt", "dbt_version": "1.8.1", "profile_name": "pgmigrate", "target_name": "dev", "node_id": "test.pgmigrate.not_null_my_first_dbt_model_id.5fb22c2710"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select id
from "postgres"."public"."my_first_dbt_model"
where id is null



      
    ) dbt_internal_test
[0m15:50:00.116219 [debug] [Thread-1  ]: SQL status: SELECT 1 in 0.0 seconds
[0m15:50:00.118670 [debug] [Thread-1  ]: On test.pgmigrate.unique_my_first_dbt_model_id.16e066b321: ROLLBACK
[0m15:50:00.118991 [debug] [Thread-2  ]: SQL status: SELECT 1 in 0.0 seconds
[0m15:50:00.119845 [debug] [Thread-2  ]: On test.pgmigrate.not_null_my_first_dbt_model_id.5fb22c2710: ROLLBACK
[0m15:50:00.120307 [debug] [Thread-1  ]: On test.pgmigrate.unique_my_first_dbt_model_id.16e066b321: Close
[0m15:50:00.120938 [info ] [Thread-1  ]: 6 of 7 PASS unique_my_first_dbt_model_id ....................................... [[32mPASS[0m in 0.04s]
[0m15:50:00.121327 [debug] [Thread-1  ]: Finished running node test.pgmigrate.unique_my_first_dbt_model_id.16e066b321
[0m15:50:00.121862 [debug] [Thread-2  ]: On test.pgmigrate.not_null_my_first_dbt_model_id.5fb22c2710: Close
[0m15:50:00.123085 [error] [Thread-2  ]: 5 of 7 FAIL 1 not_null_my_first_dbt_model_id ................................... [[31mFAIL 1[0m in 0.04s]
[0m15:50:00.124034 [debug] [Thread-2  ]: Finished running node test.pgmigrate.not_null_my_first_dbt_model_id.5fb22c2710
[0m15:50:00.125151 [debug] [Thread-1  ]: Began running node model.pgmigrate.my_second_dbt_model
[0m15:50:00.125800 [info ] [Thread-1  ]: 7 of 7 SKIP relation public.my_second_dbt_model ................................ [[33mSKIP[0m]
[0m15:50:00.126496 [debug] [Thread-1  ]: Finished running node model.pgmigrate.my_second_dbt_model
[0m15:50:00.127583 [debug] [MainThread]: Using postgres connection "master"
[0m15:50:00.127829 [debug] [MainThread]: On master: BEGIN
[0m15:50:00.128033 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m15:50:00.133076 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m15:50:00.133586 [debug] [MainThread]: On master: COMMIT
[0m15:50:00.133830 [debug] [MainThread]: Using postgres connection "master"
[0m15:50:00.134048 [debug] [MainThread]: On master: COMMIT
[0m15:50:00.134422 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m15:50:00.135094 [debug] [MainThread]: On master: Close
[0m15:50:00.135799 [debug] [MainThread]: Connection 'master' was properly closed.
[0m15:50:00.136311 [debug] [MainThread]: Connection 'test.pgmigrate.unique_my_first_dbt_model_id.16e066b321' was properly closed.
[0m15:50:00.136703 [debug] [MainThread]: Connection 'test.pgmigrate.not_null_my_first_dbt_model_id.5fb22c2710' was properly closed.
[0m15:50:00.136982 [info ] [MainThread]: 
[0m15:50:00.137218 [info ] [MainThread]: Finished running 2 view models, 1 table model, 4 data tests in 0 hours 0 minutes and 0.42 seconds (0.42s).
[0m15:50:00.137990 [debug] [MainThread]: Command end result
[0m15:50:00.161591 [info ] [MainThread]: 
[0m15:50:00.161946 [info ] [MainThread]: [31mCompleted with 3 errors and 0 warnings:[0m
[0m15:50:00.162182 [info ] [MainThread]: 
[0m15:50:00.162448 [error] [MainThread]:   Database Error in test not_null_users_dbt_model_id (models/example/schema.yml)
  column "id" does not exist
  LINE 13: select id
                  ^
  compiled Code at target/run/pgmigrate/models/example/schema.yml/not_null_users_dbt_model_id.sql
[0m15:50:00.162670 [info ] [MainThread]: 
[0m15:50:00.162917 [error] [MainThread]:   Database Error in test unique_users_dbt_model_id (models/example/schema.yml)
  column "id" does not exist
  LINE 12:     id as unique_field,
               ^
  compiled Code at target/run/pgmigrate/models/example/schema.yml/unique_users_dbt_model_id.sql
[0m15:50:00.163131 [info ] [MainThread]: 
[0m15:50:00.163376 [error] [MainThread]: [31mFailure in test not_null_my_first_dbt_model_id (models/example/schema.yml)[0m
[0m15:50:00.163617 [error] [MainThread]:   Got 1 result, configured to fail if != 0
[0m15:50:00.163819 [info ] [MainThread]: 
[0m15:50:00.164053 [info ] [MainThread]:   compiled code at target/compiled/pgmigrate/models/example/schema.yml/not_null_my_first_dbt_model_id.sql
[0m15:50:00.164265 [info ] [MainThread]: 
[0m15:50:00.164487 [info ] [MainThread]: Done. PASS=3 WARN=0 ERROR=3 SKIP=1 TOTAL=7
[0m15:50:00.166334 [debug] [MainThread]: Resource report: {"command_name": "build", "command_wall_clock_time": 1.1210228, "process_user_time": 1.542103, "process_kernel_time": 0.186052, "process_mem_max_rss": "125239296", "command_success": false, "process_in_blocks": "0", "process_out_blocks": "0"}
[0m15:50:00.166887 [debug] [MainThread]: Command `dbt build` failed at 15:50:00.166815 after 1.12 seconds
[0m15:50:00.167184 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104d17a90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107d70250>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1121f6cd0>]}
[0m15:50:00.167458 [debug] [MainThread]: Flushing usage events
[0m15:50:14.879177 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1049d3a90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x111808eb0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x111808730>]}


============================== 15:50:14.881849 | f63c03bc-8c01-4c8f-b716-a1aca86eed15 ==============================
[0m15:50:14.881849 [info ] [MainThread]: Running with dbt=1.8.1
[0m15:50:14.882267 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/Users/shrikanth/Shrikanth/dbt-helloworld', 'version_check': 'True', 'warn_error': 'None', 'log_path': '/Users/shrikanth/Shrikanth/dbt-helloworld/logs', 'fail_fast': 'False', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'static_parser': 'True', 'invocation_command': 'dbt build', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m15:50:15.015137 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'f63c03bc-8c01-4c8f-b716-a1aca86eed15', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x111c5c790>]}
[0m15:50:15.046611 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'f63c03bc-8c01-4c8f-b716-a1aca86eed15', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x111b65fa0>]}
[0m15:50:15.047259 [info ] [MainThread]: Registered adapter: postgres=1.8.1
[0m15:50:15.061455 [debug] [MainThread]: checksum: ebc509fb14e151ea268e89b60fd5abf912ed99129f87516462718fa2f14f4838, vars: {}, profile: , target: , version: 1.8.1
[0m15:50:15.164170 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m15:50:15.164687 [debug] [MainThread]: Partial parsing: updated file: pgmigrate://models/example/schema.yml
[0m15:50:15.384750 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'f63c03bc-8c01-4c8f-b716-a1aca86eed15', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x112802df0>]}
[0m15:50:15.460168 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'f63c03bc-8c01-4c8f-b716-a1aca86eed15', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x112836fd0>]}
[0m15:50:15.460559 [info ] [MainThread]: Found 3 models, 4 data tests, 527 macros
[0m15:50:15.461599 [info ] [MainThread]: 
[0m15:50:15.461970 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m15:50:15.464283 [debug] [ThreadPool]: Acquiring new postgres connection 'list_postgres'
[0m15:50:15.464693 [debug] [ThreadPool]: Acquiring new postgres connection 'list_postgres'
[0m15:50:15.494058 [debug] [ThreadPool]: Using postgres connection "list_postgres"
[0m15:50:15.494342 [debug] [ThreadPool]: Using postgres connection "list_postgres"
[0m15:50:15.494587 [debug] [ThreadPool]: On list_postgres: /* {"app": "dbt", "dbt_version": "1.8.1", "profile_name": "pgmigrate", "target_name": "dev", "connection_name": "list_postgres"} */

    select distinct nspname from pg_namespace
  
[0m15:50:15.494840 [debug] [ThreadPool]: On list_postgres: /* {"app": "dbt", "dbt_version": "1.8.1", "profile_name": "pgmigrate", "target_name": "dev", "connection_name": "list_postgres"} */

    select distinct nspname from pg_namespace
  
[0m15:50:15.495084 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m15:50:15.495300 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m15:50:15.510186 [debug] [ThreadPool]: SQL status: SELECT 18 in 0.0 seconds
[0m15:50:15.510440 [debug] [ThreadPool]: SQL status: SELECT 18 in 0.0 seconds
[0m15:50:15.511246 [debug] [ThreadPool]: On list_postgres: Close
[0m15:50:15.511953 [debug] [ThreadPool]: On list_postgres: Close
[0m15:50:15.512836 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_postgres, now list_postgres_public)
[0m15:50:15.513170 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_postgres, now list_postgres_public__airbyte_quarantine)
[0m15:50:15.516979 [debug] [ThreadPool]: Using postgres connection "list_postgres_public"
[0m15:50:15.518502 [debug] [ThreadPool]: Using postgres connection "list_postgres_public__airbyte_quarantine"
[0m15:50:15.518740 [debug] [ThreadPool]: On list_postgres_public: BEGIN
[0m15:50:15.518962 [debug] [ThreadPool]: On list_postgres_public__airbyte_quarantine: BEGIN
[0m15:50:15.519174 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m15:50:15.519383 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m15:50:15.522535 [debug] [ThreadPool]: SQL status: BEGIN in 0.0 seconds
[0m15:50:15.522793 [debug] [ThreadPool]: Using postgres connection "list_postgres_public"
[0m15:50:15.523034 [debug] [ThreadPool]: On list_postgres_public: /* {"app": "dbt", "dbt_version": "1.8.1", "profile_name": "pgmigrate", "target_name": "dev", "connection_name": "list_postgres_public"} */
select
      'postgres' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'postgres' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
    union all
    select
      'postgres' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public'
  
[0m15:50:15.524791 [debug] [ThreadPool]: SQL status: SELECT 4 in 0.0 seconds
[0m15:50:15.525588 [debug] [ThreadPool]: On list_postgres_public: ROLLBACK
[0m15:50:15.525924 [debug] [ThreadPool]: On list_postgres_public: Close
[0m15:50:15.527414 [debug] [ThreadPool]: SQL status: BEGIN in 0.0 seconds
[0m15:50:15.527643 [debug] [ThreadPool]: Using postgres connection "list_postgres_public__airbyte_quarantine"
[0m15:50:15.527879 [debug] [ThreadPool]: On list_postgres_public__airbyte_quarantine: /* {"app": "dbt", "dbt_version": "1.8.1", "profile_name": "pgmigrate", "target_name": "dev", "connection_name": "list_postgres_public__airbyte_quarantine"} */
select
      'postgres' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public__airbyte_quarantine'
    union all
    select
      'postgres' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public__airbyte_quarantine'
    union all
    select
      'postgres' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public__airbyte_quarantine'
  
[0m15:50:15.529481 [debug] [ThreadPool]: SQL status: SELECT 1 in 0.0 seconds
[0m15:50:15.530228 [debug] [ThreadPool]: On list_postgres_public__airbyte_quarantine: ROLLBACK
[0m15:50:15.530546 [debug] [ThreadPool]: On list_postgres_public__airbyte_quarantine: Close
[0m15:50:15.533558 [debug] [MainThread]: Using postgres connection "master"
[0m15:50:15.533825 [debug] [MainThread]: On master: BEGIN
[0m15:50:15.534034 [debug] [MainThread]: Opening a new connection, currently in state init
[0m15:50:15.536640 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m15:50:15.536899 [debug] [MainThread]: Using postgres connection "master"
[0m15:50:15.537270 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.8.1", "profile_name": "pgmigrate", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m15:50:15.542497 [debug] [MainThread]: SQL status: SELECT 1 in 0.0 seconds
[0m15:50:15.543377 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'f63c03bc-8c01-4c8f-b716-a1aca86eed15', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x112b6b3a0>]}
[0m15:50:15.543722 [debug] [MainThread]: On master: ROLLBACK
[0m15:50:15.544077 [debug] [MainThread]: Using postgres connection "master"
[0m15:50:15.544304 [debug] [MainThread]: On master: BEGIN
[0m15:50:15.544774 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m15:50:15.544978 [debug] [MainThread]: On master: COMMIT
[0m15:50:15.545203 [debug] [MainThread]: Using postgres connection "master"
[0m15:50:15.545458 [debug] [MainThread]: On master: COMMIT
[0m15:50:15.545812 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m15:50:15.546061 [debug] [MainThread]: On master: Close
[0m15:50:15.546391 [info ] [MainThread]: Concurrency: 2 threads (target='dev')
[0m15:50:15.546654 [info ] [MainThread]: 
[0m15:50:15.547968 [debug] [Thread-1  ]: Began running node model.pgmigrate.my_first_dbt_model
[0m15:50:15.548235 [debug] [Thread-2  ]: Began running node model.pgmigrate.users_dbt_model
[0m15:50:15.548564 [info ] [Thread-1  ]: 1 of 7 START sql table model public.my_first_dbt_model ......................... [RUN]
[0m15:50:15.548966 [info ] [Thread-2  ]: 2 of 7 START sql view model public__airbyte_quarantine.users_scalar ............ [RUN]
[0m15:50:15.549331 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly list_postgres_public, now model.pgmigrate.my_first_dbt_model)
[0m15:50:15.549649 [debug] [Thread-2  ]: Re-using an available connection from the pool (formerly list_postgres_public__airbyte_quarantine, now model.pgmigrate.users_dbt_model)
[0m15:50:15.549967 [debug] [Thread-1  ]: Began compiling node model.pgmigrate.my_first_dbt_model
[0m15:50:15.550255 [debug] [Thread-2  ]: Began compiling node model.pgmigrate.users_dbt_model
[0m15:50:15.583860 [debug] [Thread-1  ]: Writing injected SQL for node "model.pgmigrate.my_first_dbt_model"
[0m15:50:15.585977 [debug] [Thread-2  ]: Writing injected SQL for node "model.pgmigrate.users_dbt_model"
[0m15:50:15.586519 [debug] [Thread-1  ]: Began executing node model.pgmigrate.my_first_dbt_model
[0m15:50:15.606386 [debug] [Thread-2  ]: Began executing node model.pgmigrate.users_dbt_model
[0m15:50:15.611522 [debug] [Thread-1  ]: Writing runtime sql for node "model.pgmigrate.my_first_dbt_model"
[0m15:50:15.622981 [debug] [Thread-2  ]: Writing runtime sql for node "model.pgmigrate.users_dbt_model"
[0m15:50:15.623573 [debug] [Thread-2  ]: Using postgres connection "model.pgmigrate.users_dbt_model"
[0m15:50:15.623880 [debug] [Thread-1  ]: Using postgres connection "model.pgmigrate.my_first_dbt_model"
[0m15:50:15.624136 [debug] [Thread-2  ]: On model.pgmigrate.users_dbt_model: BEGIN
[0m15:50:15.624441 [debug] [Thread-1  ]: On model.pgmigrate.my_first_dbt_model: BEGIN
[0m15:50:15.624719 [debug] [Thread-2  ]: Opening a new connection, currently in state closed
[0m15:50:15.624986 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m15:50:15.638958 [debug] [Thread-1  ]: SQL status: BEGIN in 0.0 seconds
[0m15:50:15.639226 [debug] [Thread-2  ]: SQL status: BEGIN in 0.0 seconds
[0m15:50:15.639497 [debug] [Thread-1  ]: Using postgres connection "model.pgmigrate.my_first_dbt_model"
[0m15:50:15.639734 [debug] [Thread-2  ]: Using postgres connection "model.pgmigrate.users_dbt_model"
[0m15:50:15.639997 [debug] [Thread-1  ]: On model.pgmigrate.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.8.1", "profile_name": "pgmigrate", "target_name": "dev", "node_id": "model.pgmigrate.my_first_dbt_model"} */

  
    

  create  table "postgres"."public"."my_first_dbt_model__dbt_tmp"
  
  
    as
  
  (
    /*
    Welcome to your first dbt model!
    Did you know that you can also configure models directly within SQL files?
    This will override configurations stated in dbt_project.yml

    Try changing "table" to "view" below
*/



with source_data as (

    select 1 as id
    union all
    select null as id

)

select *
from source_data

/*
    Uncomment the line below to remove records with null `id` values
*/

-- where id is not null
  );
  
[0m15:50:15.640315 [debug] [Thread-2  ]: On model.pgmigrate.users_dbt_model: /* {"app": "dbt", "dbt_version": "1.8.1", "profile_name": "pgmigrate", "target_name": "dev", "node_id": "model.pgmigrate.users_dbt_model"} */

  create view "postgres"."public__airbyte_quarantine"."users_scalar__dbt_tmp"
    
    
  as (
    
-- SQL model to parse JSON blob stored in a single column and extract into separated field columns as described by the JSON Schema

select
    _airbyte_data['_id'] as legacy_id,
    _airbyte_data['createdAt']  as start_date,
    _airbyte_data ['updatedAt']  as update_date,
    _airbyte_data ['name']  as name,
    _airbyte_data ['email']  as email,
    _airbyte_data ['status']  as status,
    _airbyte_data ['lastName']  as last_name,
    _airbyte_data ['firstName']  as first_name,
    _airbyte_data ['remoteCreatedAt']  as remote_created_at,
    _airbyte_data ['employmentStatus']  as employment_status,
    _airbyte_data ['organization']  as organization,
    _airbyte_data ['onboardingStep']  as onboarding_step,
    _airbyte_emitted_at
from public._airbyte_raw_users
  );
[0m15:50:15.642386 [debug] [Thread-1  ]: SQL status: SELECT 2 in 0.0 seconds
[0m15:50:15.642661 [debug] [Thread-2  ]: SQL status: CREATE VIEW in 0.0 seconds
[0m15:50:15.647125 [debug] [Thread-1  ]: Using postgres connection "model.pgmigrate.my_first_dbt_model"
[0m15:50:15.649157 [debug] [Thread-2  ]: Using postgres connection "model.pgmigrate.users_dbt_model"
[0m15:50:15.649425 [debug] [Thread-1  ]: On model.pgmigrate.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.8.1", "profile_name": "pgmigrate", "target_name": "dev", "node_id": "model.pgmigrate.my_first_dbt_model"} */
alter table "postgres"."public"."my_first_dbt_model" rename to "my_first_dbt_model__dbt_backup"
[0m15:50:15.649755 [debug] [Thread-2  ]: On model.pgmigrate.users_dbt_model: /* {"app": "dbt", "dbt_version": "1.8.1", "profile_name": "pgmigrate", "target_name": "dev", "node_id": "model.pgmigrate.users_dbt_model"} */
alter table "postgres"."public__airbyte_quarantine"."users_scalar" rename to "users_scalar__dbt_backup"
[0m15:50:15.651001 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.0 seconds
[0m15:50:15.651230 [debug] [Thread-2  ]: SQL status: ALTER TABLE in 0.0 seconds
[0m15:50:15.653430 [debug] [Thread-1  ]: Using postgres connection "model.pgmigrate.my_first_dbt_model"
[0m15:50:15.655331 [debug] [Thread-2  ]: Using postgres connection "model.pgmigrate.users_dbt_model"
[0m15:50:15.655592 [debug] [Thread-1  ]: On model.pgmigrate.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.8.1", "profile_name": "pgmigrate", "target_name": "dev", "node_id": "model.pgmigrate.my_first_dbt_model"} */
alter table "postgres"."public"."my_first_dbt_model__dbt_tmp" rename to "my_first_dbt_model"
[0m15:50:15.655854 [debug] [Thread-2  ]: On model.pgmigrate.users_dbt_model: /* {"app": "dbt", "dbt_version": "1.8.1", "profile_name": "pgmigrate", "target_name": "dev", "node_id": "model.pgmigrate.users_dbt_model"} */
alter table "postgres"."public__airbyte_quarantine"."users_scalar__dbt_tmp" rename to "users_scalar"
[0m15:50:15.656257 [debug] [Thread-2  ]: SQL status: ALTER TABLE in 0.0 seconds
[0m15:50:15.656493 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.0 seconds
[0m15:50:15.665782 [debug] [Thread-2  ]: On model.pgmigrate.users_dbt_model: COMMIT
[0m15:50:15.668737 [debug] [Thread-1  ]: On model.pgmigrate.my_first_dbt_model: COMMIT
[0m15:50:15.669042 [debug] [Thread-2  ]: Using postgres connection "model.pgmigrate.users_dbt_model"
[0m15:50:15.669286 [debug] [Thread-1  ]: Using postgres connection "model.pgmigrate.my_first_dbt_model"
[0m15:50:15.669581 [debug] [Thread-2  ]: On model.pgmigrate.users_dbt_model: COMMIT
[0m15:50:15.669849 [debug] [Thread-1  ]: On model.pgmigrate.my_first_dbt_model: COMMIT
[0m15:50:15.672145 [debug] [Thread-2  ]: SQL status: COMMIT in 0.0 seconds
[0m15:50:15.675932 [debug] [Thread-2  ]: Applying DROP to: "postgres"."public__airbyte_quarantine"."users_scalar__dbt_backup"
[0m15:50:15.676196 [debug] [Thread-1  ]: SQL status: COMMIT in 0.0 seconds
[0m15:50:15.678873 [debug] [Thread-2  ]: Using postgres connection "model.pgmigrate.users_dbt_model"
[0m15:50:15.680600 [debug] [Thread-1  ]: Applying DROP to: "postgres"."public"."my_first_dbt_model__dbt_backup"
[0m15:50:15.680888 [debug] [Thread-2  ]: On model.pgmigrate.users_dbt_model: /* {"app": "dbt", "dbt_version": "1.8.1", "profile_name": "pgmigrate", "target_name": "dev", "node_id": "model.pgmigrate.users_dbt_model"} */
drop view if exists "postgres"."public__airbyte_quarantine"."users_scalar__dbt_backup" cascade
[0m15:50:15.683099 [debug] [Thread-1  ]: Using postgres connection "model.pgmigrate.my_first_dbt_model"
[0m15:50:15.683435 [debug] [Thread-1  ]: On model.pgmigrate.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.8.1", "profile_name": "pgmigrate", "target_name": "dev", "node_id": "model.pgmigrate.my_first_dbt_model"} */
drop table if exists "postgres"."public"."my_first_dbt_model__dbt_backup" cascade
[0m15:50:15.684220 [debug] [Thread-2  ]: SQL status: DROP VIEW in 0.0 seconds
[0m15:50:15.685719 [debug] [Thread-2  ]: On model.pgmigrate.users_dbt_model: Close
[0m15:50:15.686001 [debug] [Thread-1  ]: SQL status: DROP TABLE in 0.0 seconds
[0m15:50:15.686773 [debug] [Thread-1  ]: On model.pgmigrate.my_first_dbt_model: Close
[0m15:50:15.687691 [debug] [Thread-2  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'f63c03bc-8c01-4c8f-b716-a1aca86eed15', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x112fcea00>]}
[0m15:50:15.688036 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'f63c03bc-8c01-4c8f-b716-a1aca86eed15', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x112fcef10>]}
[0m15:50:15.688492 [info ] [Thread-2  ]: 2 of 7 OK created sql view model public__airbyte_quarantine.users_scalar ....... [[32mCREATE VIEW[0m in 0.14s]
[0m15:50:15.688825 [info ] [Thread-1  ]: 1 of 7 OK created sql table model public.my_first_dbt_model .................... [[32mSELECT 2[0m in 0.14s]
[0m15:50:15.689356 [debug] [Thread-2  ]: Finished running node model.pgmigrate.users_dbt_model
[0m15:50:15.689720 [debug] [Thread-1  ]: Finished running node model.pgmigrate.my_first_dbt_model
[0m15:50:15.690241 [debug] [Thread-2  ]: Began running node test.pgmigrate.not_null_users_dbt_model_legacy_id.fe99fe88c9
[0m15:50:15.690521 [debug] [Thread-1  ]: Began running node test.pgmigrate.unique_users_dbt_model_legacy_id.dfd0e08a43
[0m15:50:15.690830 [info ] [Thread-2  ]: 3 of 7 START test not_null_users_dbt_model_legacy_id ........................... [RUN]
[0m15:50:15.691150 [info ] [Thread-1  ]: 4 of 7 START test unique_users_dbt_model_legacy_id ............................. [RUN]
[0m15:50:15.691487 [debug] [Thread-2  ]: Re-using an available connection from the pool (formerly model.pgmigrate.users_dbt_model, now test.pgmigrate.not_null_users_dbt_model_legacy_id.fe99fe88c9)
[0m15:50:15.691780 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.pgmigrate.my_first_dbt_model, now test.pgmigrate.unique_users_dbt_model_legacy_id.dfd0e08a43)
[0m15:50:15.692043 [debug] [Thread-2  ]: Began compiling node test.pgmigrate.not_null_users_dbt_model_legacy_id.fe99fe88c9
[0m15:50:15.692311 [debug] [Thread-1  ]: Began compiling node test.pgmigrate.unique_users_dbt_model_legacy_id.dfd0e08a43
[0m15:50:15.699813 [debug] [Thread-2  ]: Writing injected SQL for node "test.pgmigrate.not_null_users_dbt_model_legacy_id.fe99fe88c9"
[0m15:50:15.703762 [debug] [Thread-1  ]: Writing injected SQL for node "test.pgmigrate.unique_users_dbt_model_legacy_id.dfd0e08a43"
[0m15:50:15.704314 [debug] [Thread-2  ]: Began executing node test.pgmigrate.not_null_users_dbt_model_legacy_id.fe99fe88c9
[0m15:50:15.710943 [debug] [Thread-1  ]: Began executing node test.pgmigrate.unique_users_dbt_model_legacy_id.dfd0e08a43
[0m15:50:15.713330 [debug] [Thread-2  ]: Writing runtime sql for node "test.pgmigrate.not_null_users_dbt_model_legacy_id.fe99fe88c9"
[0m15:50:15.715084 [debug] [Thread-1  ]: Writing runtime sql for node "test.pgmigrate.unique_users_dbt_model_legacy_id.dfd0e08a43"
[0m15:50:15.715552 [debug] [Thread-2  ]: Using postgres connection "test.pgmigrate.not_null_users_dbt_model_legacy_id.fe99fe88c9"
[0m15:50:15.715849 [debug] [Thread-2  ]: On test.pgmigrate.not_null_users_dbt_model_legacy_id.fe99fe88c9: BEGIN
[0m15:50:15.716124 [debug] [Thread-2  ]: Opening a new connection, currently in state closed
[0m15:50:15.716478 [debug] [Thread-1  ]: Using postgres connection "test.pgmigrate.unique_users_dbt_model_legacy_id.dfd0e08a43"
[0m15:50:15.716747 [debug] [Thread-1  ]: On test.pgmigrate.unique_users_dbt_model_legacy_id.dfd0e08a43: BEGIN
[0m15:50:15.716984 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m15:50:15.719479 [debug] [Thread-2  ]: SQL status: BEGIN in 0.0 seconds
[0m15:50:15.719738 [debug] [Thread-1  ]: SQL status: BEGIN in 0.0 seconds
[0m15:50:15.720002 [debug] [Thread-2  ]: Using postgres connection "test.pgmigrate.not_null_users_dbt_model_legacy_id.fe99fe88c9"
[0m15:50:15.720254 [debug] [Thread-1  ]: Using postgres connection "test.pgmigrate.unique_users_dbt_model_legacy_id.dfd0e08a43"
[0m15:50:15.720533 [debug] [Thread-2  ]: On test.pgmigrate.not_null_users_dbt_model_legacy_id.fe99fe88c9: /* {"app": "dbt", "dbt_version": "1.8.1", "profile_name": "pgmigrate", "target_name": "dev", "node_id": "test.pgmigrate.not_null_users_dbt_model_legacy_id.fe99fe88c9"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select legacy_id
from "postgres"."public__airbyte_quarantine"."users_scalar"
where legacy_id is null



      
    ) dbt_internal_test
[0m15:50:15.720814 [debug] [Thread-1  ]: On test.pgmigrate.unique_users_dbt_model_legacy_id.dfd0e08a43: /* {"app": "dbt", "dbt_version": "1.8.1", "profile_name": "pgmigrate", "target_name": "dev", "node_id": "test.pgmigrate.unique_users_dbt_model_legacy_id.dfd0e08a43"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

select
    legacy_id as unique_field,
    count(*) as n_records

from "postgres"."public__airbyte_quarantine"."users_scalar"
where legacy_id is not null
group by legacy_id
having count(*) > 1



      
    ) dbt_internal_test
[0m15:50:23.945824 [debug] [Thread-2  ]: SQL status: SELECT 1 in 8.0 seconds
[0m15:50:23.954484 [debug] [Thread-2  ]: On test.pgmigrate.not_null_users_dbt_model_legacy_id.fe99fe88c9: ROLLBACK
[0m15:50:23.955842 [debug] [Thread-2  ]: On test.pgmigrate.not_null_users_dbt_model_legacy_id.fe99fe88c9: Close
[0m15:50:23.957082 [info ] [Thread-2  ]: 3 of 7 PASS not_null_users_dbt_model_legacy_id ................................. [[32mPASS[0m in 8.27s]
[0m15:50:23.958133 [debug] [Thread-2  ]: Finished running node test.pgmigrate.not_null_users_dbt_model_legacy_id.fe99fe88c9
[0m15:50:23.958895 [debug] [Thread-2  ]: Began running node test.pgmigrate.not_null_my_first_dbt_model_id.5fb22c2710
[0m15:50:23.959696 [info ] [Thread-2  ]: 5 of 7 START test not_null_my_first_dbt_model_id ............................... [RUN]
[0m15:50:23.960184 [debug] [Thread-2  ]: Re-using an available connection from the pool (formerly test.pgmigrate.not_null_users_dbt_model_legacy_id.fe99fe88c9, now test.pgmigrate.not_null_my_first_dbt_model_id.5fb22c2710)
[0m15:50:23.960494 [debug] [Thread-2  ]: Began compiling node test.pgmigrate.not_null_my_first_dbt_model_id.5fb22c2710
[0m15:50:23.963911 [debug] [Thread-2  ]: Writing injected SQL for node "test.pgmigrate.not_null_my_first_dbt_model_id.5fb22c2710"
[0m15:50:23.964408 [debug] [Thread-2  ]: Began executing node test.pgmigrate.not_null_my_first_dbt_model_id.5fb22c2710
[0m15:50:23.967333 [debug] [Thread-2  ]: Writing runtime sql for node "test.pgmigrate.not_null_my_first_dbt_model_id.5fb22c2710"
[0m15:50:23.967858 [debug] [Thread-2  ]: Using postgres connection "test.pgmigrate.not_null_my_first_dbt_model_id.5fb22c2710"
[0m15:50:23.968129 [debug] [Thread-2  ]: On test.pgmigrate.not_null_my_first_dbt_model_id.5fb22c2710: BEGIN
[0m15:50:23.968368 [debug] [Thread-2  ]: Opening a new connection, currently in state closed
[0m15:50:23.983756 [debug] [Thread-2  ]: SQL status: BEGIN in 0.0 seconds
[0m15:50:23.984138 [debug] [Thread-2  ]: Using postgres connection "test.pgmigrate.not_null_my_first_dbt_model_id.5fb22c2710"
[0m15:50:23.984405 [debug] [Thread-2  ]: On test.pgmigrate.not_null_my_first_dbt_model_id.5fb22c2710: /* {"app": "dbt", "dbt_version": "1.8.1", "profile_name": "pgmigrate", "target_name": "dev", "node_id": "test.pgmigrate.not_null_my_first_dbt_model_id.5fb22c2710"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select id
from "postgres"."public"."my_first_dbt_model"
where id is null



      
    ) dbt_internal_test
[0m15:50:23.987755 [debug] [Thread-2  ]: SQL status: SELECT 1 in 0.0 seconds
[0m15:50:23.988781 [debug] [Thread-2  ]: On test.pgmigrate.not_null_my_first_dbt_model_id.5fb22c2710: ROLLBACK
[0m15:50:23.989157 [debug] [Thread-2  ]: On test.pgmigrate.not_null_my_first_dbt_model_id.5fb22c2710: Close
[0m15:50:23.989618 [error] [Thread-2  ]: 5 of 7 FAIL 1 not_null_my_first_dbt_model_id ................................... [[31mFAIL 1[0m in 0.03s]
[0m15:50:23.990061 [debug] [Thread-2  ]: Finished running node test.pgmigrate.not_null_my_first_dbt_model_id.5fb22c2710
[0m15:50:23.990379 [debug] [Thread-2  ]: Began running node test.pgmigrate.unique_my_first_dbt_model_id.16e066b321
[0m15:50:23.990792 [info ] [Thread-2  ]: 6 of 7 START test unique_my_first_dbt_model_id ................................. [RUN]
[0m15:50:23.991119 [debug] [Thread-2  ]: Re-using an available connection from the pool (formerly test.pgmigrate.not_null_my_first_dbt_model_id.5fb22c2710, now test.pgmigrate.unique_my_first_dbt_model_id.16e066b321)
[0m15:50:23.991367 [debug] [Thread-2  ]: Began compiling node test.pgmigrate.unique_my_first_dbt_model_id.16e066b321
[0m15:50:23.994499 [debug] [Thread-2  ]: Writing injected SQL for node "test.pgmigrate.unique_my_first_dbt_model_id.16e066b321"
[0m15:50:23.994993 [debug] [Thread-2  ]: Began executing node test.pgmigrate.unique_my_first_dbt_model_id.16e066b321
[0m15:50:23.996819 [debug] [Thread-2  ]: Writing runtime sql for node "test.pgmigrate.unique_my_first_dbt_model_id.16e066b321"
[0m15:50:23.997264 [debug] [Thread-2  ]: Using postgres connection "test.pgmigrate.unique_my_first_dbt_model_id.16e066b321"
[0m15:50:23.997515 [debug] [Thread-2  ]: On test.pgmigrate.unique_my_first_dbt_model_id.16e066b321: BEGIN
[0m15:50:23.997745 [debug] [Thread-2  ]: Opening a new connection, currently in state closed
[0m15:50:24.012204 [debug] [Thread-2  ]: SQL status: BEGIN in 0.0 seconds
[0m15:50:24.012614 [debug] [Thread-2  ]: Using postgres connection "test.pgmigrate.unique_my_first_dbt_model_id.16e066b321"
[0m15:50:24.012885 [debug] [Thread-2  ]: On test.pgmigrate.unique_my_first_dbt_model_id.16e066b321: /* {"app": "dbt", "dbt_version": "1.8.1", "profile_name": "pgmigrate", "target_name": "dev", "node_id": "test.pgmigrate.unique_my_first_dbt_model_id.16e066b321"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

select
    id as unique_field,
    count(*) as n_records

from "postgres"."public"."my_first_dbt_model"
where id is not null
group by id
having count(*) > 1



      
    ) dbt_internal_test
[0m15:50:24.014481 [debug] [Thread-2  ]: SQL status: SELECT 1 in 0.0 seconds
[0m15:50:24.015497 [debug] [Thread-2  ]: On test.pgmigrate.unique_my_first_dbt_model_id.16e066b321: ROLLBACK
[0m15:50:24.015872 [debug] [Thread-2  ]: On test.pgmigrate.unique_my_first_dbt_model_id.16e066b321: Close
[0m15:50:24.016301 [info ] [Thread-2  ]: 6 of 7 PASS unique_my_first_dbt_model_id ....................................... [[32mPASS[0m in 0.03s]
[0m15:50:24.016728 [debug] [Thread-2  ]: Finished running node test.pgmigrate.unique_my_first_dbt_model_id.16e066b321
[0m15:50:24.017171 [debug] [Thread-2  ]: Began running node model.pgmigrate.my_second_dbt_model
[0m15:50:24.017484 [info ] [Thread-2  ]: 7 of 7 SKIP relation public.my_second_dbt_model ................................ [[33mSKIP[0m]
[0m15:50:24.017778 [debug] [Thread-2  ]: Finished running node model.pgmigrate.my_second_dbt_model
[0m15:50:24.438556 [debug] [Thread-1  ]: SQL status: SELECT 1 in 9.0 seconds
[0m15:50:24.442755 [debug] [Thread-1  ]: On test.pgmigrate.unique_users_dbt_model_legacy_id.dfd0e08a43: ROLLBACK
[0m15:50:24.443853 [debug] [Thread-1  ]: On test.pgmigrate.unique_users_dbt_model_legacy_id.dfd0e08a43: Close
[0m15:50:24.445165 [error] [Thread-1  ]: 4 of 7 FAIL 92573 unique_users_dbt_model_legacy_id ............................. [[31mFAIL 92573[0m in 8.75s]
[0m15:50:24.446468 [debug] [Thread-1  ]: Finished running node test.pgmigrate.unique_users_dbt_model_legacy_id.dfd0e08a43
[0m15:50:24.448479 [debug] [MainThread]: Using postgres connection "master"
[0m15:50:24.449236 [debug] [MainThread]: On master: BEGIN
[0m15:50:24.449869 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m15:50:24.453962 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m15:50:24.454333 [debug] [MainThread]: On master: COMMIT
[0m15:50:24.454567 [debug] [MainThread]: Using postgres connection "master"
[0m15:50:24.454784 [debug] [MainThread]: On master: COMMIT
[0m15:50:24.455185 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m15:50:24.455466 [debug] [MainThread]: On master: Close
[0m15:50:24.455837 [debug] [MainThread]: Connection 'master' was properly closed.
[0m15:50:24.456082 [debug] [MainThread]: Connection 'test.pgmigrate.unique_users_dbt_model_legacy_id.dfd0e08a43' was properly closed.
[0m15:50:24.456295 [debug] [MainThread]: Connection 'test.pgmigrate.unique_my_first_dbt_model_id.16e066b321' was properly closed.
[0m15:50:24.456604 [info ] [MainThread]: 
[0m15:50:24.456874 [info ] [MainThread]: Finished running 2 view models, 1 table model, 4 data tests in 0 hours 0 minutes and 8.99 seconds (8.99s).
[0m15:50:24.457734 [debug] [MainThread]: Command end result
[0m15:50:24.480721 [info ] [MainThread]: 
[0m15:50:24.481117 [info ] [MainThread]: [31mCompleted with 2 errors and 0 warnings:[0m
[0m15:50:24.481477 [info ] [MainThread]: 
[0m15:50:24.481906 [error] [MainThread]: [31mFailure in test not_null_my_first_dbt_model_id (models/example/schema.yml)[0m
[0m15:50:24.482185 [error] [MainThread]:   Got 1 result, configured to fail if != 0
[0m15:50:24.482392 [info ] [MainThread]: 
[0m15:50:24.482628 [info ] [MainThread]:   compiled code at target/compiled/pgmigrate/models/example/schema.yml/not_null_my_first_dbt_model_id.sql
[0m15:50:24.482838 [info ] [MainThread]: 
[0m15:50:24.483079 [error] [MainThread]: [31mFailure in test unique_users_dbt_model_legacy_id (models/example/schema.yml)[0m
[0m15:50:24.483315 [error] [MainThread]:   Got 92573 results, configured to fail if != 0
[0m15:50:24.483515 [info ] [MainThread]: 
[0m15:50:24.483745 [info ] [MainThread]:   compiled code at target/compiled/pgmigrate/models/example/schema.yml/unique_users_dbt_model_legacy_id.sql
[0m15:50:24.483958 [info ] [MainThread]: 
[0m15:50:24.484175 [info ] [MainThread]: Done. PASS=4 WARN=0 ERROR=2 SKIP=1 TOTAL=7
[0m15:50:24.485406 [debug] [MainThread]: Resource report: {"command_name": "build", "command_wall_clock_time": 9.64486, "process_user_time": 1.384217, "process_kernel_time": 0.147542, "process_mem_max_rss": "121815040", "command_success": false, "process_in_blocks": "0", "process_out_blocks": "0"}
[0m15:50:24.485876 [debug] [MainThread]: Command `dbt build` failed at 15:50:24.485811 after 9.65 seconds
[0m15:50:24.486174 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1049d3a90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1126e4130>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x112436760>]}
[0m15:50:24.486423 [debug] [MainThread]: Flushing usage events
[0m15:50:40.626900 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1023ea9a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1043fcdf0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1043fc670>]}


============================== 15:50:40.629609 | bf7fb063-73a1-4781-88f7-10a884d6ad6f ==============================
[0m15:50:40.629609 [info ] [MainThread]: Running with dbt=1.8.1
[0m15:50:40.629979 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'debug': 'False', 'log_path': '/Users/shrikanth/Shrikanth/dbt-helloworld/logs', 'version_check': 'True', 'profiles_dir': '/Users/shrikanth/Shrikanth/dbt-helloworld', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'invocation_command': 'dbt build', 'introspect': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m15:50:40.808235 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'bf7fb063-73a1-4781-88f7-10a884d6ad6f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1048470a0>]}
[0m15:50:40.842698 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'bf7fb063-73a1-4781-88f7-10a884d6ad6f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10382c970>]}
[0m15:50:40.843558 [info ] [MainThread]: Registered adapter: postgres=1.8.1
[0m15:50:40.860099 [debug] [MainThread]: checksum: ebc509fb14e151ea268e89b60fd5abf912ed99129f87516462718fa2f14f4838, vars: {}, profile: , target: , version: 1.8.1
[0m15:50:40.963707 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m15:50:40.964249 [debug] [MainThread]: Partial parsing: updated file: pgmigrate://models/example/schema.yml
[0m15:50:41.111805 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'bf7fb063-73a1-4781-88f7-10a884d6ad6f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1050e0130>]}
[0m15:50:41.189244 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'bf7fb063-73a1-4781-88f7-10a884d6ad6f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104ef68b0>]}
[0m15:50:41.189635 [info ] [MainThread]: Found 3 models, 2 data tests, 527 macros
[0m15:50:41.190630 [info ] [MainThread]: 
[0m15:50:41.191014 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m15:50:41.193302 [debug] [ThreadPool]: Acquiring new postgres connection 'list_postgres'
[0m15:50:41.193646 [debug] [ThreadPool]: Acquiring new postgres connection 'list_postgres'
[0m15:50:41.226500 [debug] [ThreadPool]: Using postgres connection "list_postgres"
[0m15:50:41.226812 [debug] [ThreadPool]: Using postgres connection "list_postgres"
[0m15:50:41.227081 [debug] [ThreadPool]: On list_postgres: /* {"app": "dbt", "dbt_version": "1.8.1", "profile_name": "pgmigrate", "target_name": "dev", "connection_name": "list_postgres"} */

    select distinct nspname from pg_namespace
  
[0m15:50:41.227336 [debug] [ThreadPool]: On list_postgres: /* {"app": "dbt", "dbt_version": "1.8.1", "profile_name": "pgmigrate", "target_name": "dev", "connection_name": "list_postgres"} */

    select distinct nspname from pg_namespace
  
[0m15:50:41.227589 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m15:50:41.227811 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m15:50:41.244145 [debug] [ThreadPool]: SQL status: SELECT 18 in 0.0 seconds
[0m15:50:41.245004 [debug] [ThreadPool]: On list_postgres: Close
[0m15:50:41.248898 [debug] [ThreadPool]: SQL status: SELECT 18 in 0.0 seconds
[0m15:50:41.249670 [debug] [ThreadPool]: On list_postgres: Close
[0m15:50:41.250435 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_postgres, now list_postgres_public)
[0m15:50:41.250796 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_postgres, now list_postgres_public__airbyte_quarantine)
[0m15:50:41.254626 [debug] [ThreadPool]: Using postgres connection "list_postgres_public"
[0m15:50:41.256169 [debug] [ThreadPool]: Using postgres connection "list_postgres_public__airbyte_quarantine"
[0m15:50:41.256418 [debug] [ThreadPool]: On list_postgres_public: BEGIN
[0m15:50:41.256631 [debug] [ThreadPool]: On list_postgres_public__airbyte_quarantine: BEGIN
[0m15:50:41.256848 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m15:50:41.257054 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m15:50:41.270687 [debug] [ThreadPool]: SQL status: BEGIN in 0.0 seconds
[0m15:50:41.271046 [debug] [ThreadPool]: Using postgres connection "list_postgres_public"
[0m15:50:41.271334 [debug] [ThreadPool]: On list_postgres_public: /* {"app": "dbt", "dbt_version": "1.8.1", "profile_name": "pgmigrate", "target_name": "dev", "connection_name": "list_postgres_public"} */
select
      'postgres' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'postgres' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
    union all
    select
      'postgres' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public'
  
[0m15:50:41.281696 [debug] [ThreadPool]: SQL status: BEGIN in 0.0 seconds
[0m15:50:41.282004 [debug] [ThreadPool]: Using postgres connection "list_postgres_public__airbyte_quarantine"
[0m15:50:41.282280 [debug] [ThreadPool]: On list_postgres_public__airbyte_quarantine: /* {"app": "dbt", "dbt_version": "1.8.1", "profile_name": "pgmigrate", "target_name": "dev", "connection_name": "list_postgres_public__airbyte_quarantine"} */
select
      'postgres' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public__airbyte_quarantine'
    union all
    select
      'postgres' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public__airbyte_quarantine'
    union all
    select
      'postgres' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public__airbyte_quarantine'
  
[0m15:50:41.284352 [debug] [ThreadPool]: SQL status: SELECT 4 in 0.0 seconds
[0m15:50:41.284641 [debug] [ThreadPool]: SQL status: SELECT 1 in 0.0 seconds
[0m15:50:41.285692 [debug] [ThreadPool]: On list_postgres_public: ROLLBACK
[0m15:50:41.286520 [debug] [ThreadPool]: On list_postgres_public__airbyte_quarantine: ROLLBACK
[0m15:50:41.286871 [debug] [ThreadPool]: On list_postgres_public: Close
[0m15:50:41.287123 [debug] [ThreadPool]: On list_postgres_public__airbyte_quarantine: Close
[0m15:50:41.291879 [debug] [MainThread]: Using postgres connection "master"
[0m15:50:41.292117 [debug] [MainThread]: On master: BEGIN
[0m15:50:41.292337 [debug] [MainThread]: Opening a new connection, currently in state init
[0m15:50:41.295399 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m15:50:41.295651 [debug] [MainThread]: Using postgres connection "master"
[0m15:50:41.295936 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.8.1", "profile_name": "pgmigrate", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m15:50:41.302568 [debug] [MainThread]: SQL status: SELECT 1 in 0.0 seconds
[0m15:50:41.303519 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'bf7fb063-73a1-4781-88f7-10a884d6ad6f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1022527c0>]}
[0m15:50:41.303816 [debug] [MainThread]: On master: ROLLBACK
[0m15:50:41.304124 [debug] [MainThread]: Using postgres connection "master"
[0m15:50:41.304328 [debug] [MainThread]: On master: BEGIN
[0m15:50:41.304683 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m15:50:41.304941 [debug] [MainThread]: On master: COMMIT
[0m15:50:41.305168 [debug] [MainThread]: Using postgres connection "master"
[0m15:50:41.305374 [debug] [MainThread]: On master: COMMIT
[0m15:50:41.305664 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m15:50:41.305892 [debug] [MainThread]: On master: Close
[0m15:50:41.306213 [info ] [MainThread]: Concurrency: 2 threads (target='dev')
[0m15:50:41.306449 [info ] [MainThread]: 
[0m15:50:41.307743 [debug] [Thread-1  ]: Began running node model.pgmigrate.my_first_dbt_model
[0m15:50:41.308023 [debug] [Thread-2  ]: Began running node model.pgmigrate.users_dbt_model
[0m15:50:41.308360 [info ] [Thread-1  ]: 1 of 5 START sql table model public.my_first_dbt_model ......................... [RUN]
[0m15:50:41.308730 [info ] [Thread-2  ]: 2 of 5 START sql view model public__airbyte_quarantine.users_scalar ............ [RUN]
[0m15:50:41.309073 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly list_postgres_public, now model.pgmigrate.my_first_dbt_model)
[0m15:50:41.309378 [debug] [Thread-2  ]: Re-using an available connection from the pool (formerly list_postgres_public__airbyte_quarantine, now model.pgmigrate.users_dbt_model)
[0m15:50:41.309655 [debug] [Thread-1  ]: Began compiling node model.pgmigrate.my_first_dbt_model
[0m15:50:41.309928 [debug] [Thread-2  ]: Began compiling node model.pgmigrate.users_dbt_model
[0m15:50:41.314918 [debug] [Thread-1  ]: Writing injected SQL for node "model.pgmigrate.my_first_dbt_model"
[0m15:50:41.316848 [debug] [Thread-2  ]: Writing injected SQL for node "model.pgmigrate.users_dbt_model"
[0m15:50:41.317354 [debug] [Thread-1  ]: Began executing node model.pgmigrate.my_first_dbt_model
[0m15:50:41.317618 [debug] [Thread-2  ]: Began executing node model.pgmigrate.users_dbt_model
[0m15:50:41.348661 [debug] [Thread-1  ]: Writing runtime sql for node "model.pgmigrate.my_first_dbt_model"
[0m15:50:41.356898 [debug] [Thread-2  ]: Writing runtime sql for node "model.pgmigrate.users_dbt_model"
[0m15:50:41.357604 [debug] [Thread-1  ]: Using postgres connection "model.pgmigrate.my_first_dbt_model"
[0m15:50:41.357920 [debug] [Thread-2  ]: Using postgres connection "model.pgmigrate.users_dbt_model"
[0m15:50:41.358244 [debug] [Thread-1  ]: On model.pgmigrate.my_first_dbt_model: BEGIN
[0m15:50:41.358537 [debug] [Thread-2  ]: On model.pgmigrate.users_dbt_model: BEGIN
[0m15:50:41.358843 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m15:50:41.359135 [debug] [Thread-2  ]: Opening a new connection, currently in state closed
[0m15:50:41.362986 [debug] [Thread-2  ]: SQL status: BEGIN in 0.0 seconds
[0m15:50:41.363255 [debug] [Thread-1  ]: SQL status: BEGIN in 0.0 seconds
[0m15:50:41.363526 [debug] [Thread-2  ]: Using postgres connection "model.pgmigrate.users_dbt_model"
[0m15:50:41.363802 [debug] [Thread-1  ]: Using postgres connection "model.pgmigrate.my_first_dbt_model"
[0m15:50:41.364124 [debug] [Thread-2  ]: On model.pgmigrate.users_dbt_model: /* {"app": "dbt", "dbt_version": "1.8.1", "profile_name": "pgmigrate", "target_name": "dev", "node_id": "model.pgmigrate.users_dbt_model"} */

  create view "postgres"."public__airbyte_quarantine"."users_scalar__dbt_tmp"
    
    
  as (
    
-- SQL model to parse JSON blob stored in a single column and extract into separated field columns as described by the JSON Schema

select
    _airbyte_data['_id'] as legacy_id,
    _airbyte_data['createdAt']  as start_date,
    _airbyte_data ['updatedAt']  as update_date,
    _airbyte_data ['name']  as name,
    _airbyte_data ['email']  as email,
    _airbyte_data ['status']  as status,
    _airbyte_data ['lastName']  as last_name,
    _airbyte_data ['firstName']  as first_name,
    _airbyte_data ['remoteCreatedAt']  as remote_created_at,
    _airbyte_data ['employmentStatus']  as employment_status,
    _airbyte_data ['organization']  as organization,
    _airbyte_data ['onboardingStep']  as onboarding_step,
    _airbyte_emitted_at
from public._airbyte_raw_users
  );
[0m15:50:41.364471 [debug] [Thread-1  ]: On model.pgmigrate.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.8.1", "profile_name": "pgmigrate", "target_name": "dev", "node_id": "model.pgmigrate.my_first_dbt_model"} */

  
    

  create  table "postgres"."public"."my_first_dbt_model__dbt_tmp"
  
  
    as
  
  (
    /*
    Welcome to your first dbt model!
    Did you know that you can also configure models directly within SQL files?
    This will override configurations stated in dbt_project.yml

    Try changing "table" to "view" below
*/



with source_data as (

    select 1 as id
    union all
    select null as id

)

select *
from source_data

/*
    Uncomment the line below to remove records with null `id` values
*/

-- where id is not null
  );
  
[0m15:50:41.365761 [debug] [Thread-1  ]: SQL status: SELECT 2 in 0.0 seconds
[0m15:50:41.399167 [debug] [Thread-2  ]: SQL status: CREATE VIEW in 0.0 seconds
[0m15:50:41.402651 [debug] [Thread-1  ]: Using postgres connection "model.pgmigrate.my_first_dbt_model"
[0m15:50:41.405114 [debug] [Thread-2  ]: Using postgres connection "model.pgmigrate.users_dbt_model"
[0m15:50:41.405441 [debug] [Thread-1  ]: On model.pgmigrate.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.8.1", "profile_name": "pgmigrate", "target_name": "dev", "node_id": "model.pgmigrate.my_first_dbt_model"} */
alter table "postgres"."public"."my_first_dbt_model" rename to "my_first_dbt_model__dbt_backup"
[0m15:50:41.405746 [debug] [Thread-2  ]: On model.pgmigrate.users_dbt_model: /* {"app": "dbt", "dbt_version": "1.8.1", "profile_name": "pgmigrate", "target_name": "dev", "node_id": "model.pgmigrate.users_dbt_model"} */
alter table "postgres"."public__airbyte_quarantine"."users_scalar" rename to "users_scalar__dbt_backup"
[0m15:50:41.406308 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.0 seconds
[0m15:50:41.408688 [debug] [Thread-1  ]: Using postgres connection "model.pgmigrate.my_first_dbt_model"
[0m15:50:41.409004 [debug] [Thread-1  ]: On model.pgmigrate.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.8.1", "profile_name": "pgmigrate", "target_name": "dev", "node_id": "model.pgmigrate.my_first_dbt_model"} */
alter table "postgres"."public"."my_first_dbt_model__dbt_tmp" rename to "my_first_dbt_model"
[0m15:50:41.409902 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.0 seconds
[0m15:50:41.421577 [debug] [Thread-2  ]: SQL status: ALTER TABLE in 0.0 seconds
[0m15:50:41.423702 [debug] [Thread-1  ]: On model.pgmigrate.my_first_dbt_model: COMMIT
[0m15:50:41.425674 [debug] [Thread-2  ]: Using postgres connection "model.pgmigrate.users_dbt_model"
[0m15:50:41.425953 [debug] [Thread-1  ]: Using postgres connection "model.pgmigrate.my_first_dbt_model"
[0m15:50:41.426291 [debug] [Thread-2  ]: On model.pgmigrate.users_dbt_model: /* {"app": "dbt", "dbt_version": "1.8.1", "profile_name": "pgmigrate", "target_name": "dev", "node_id": "model.pgmigrate.users_dbt_model"} */
alter table "postgres"."public__airbyte_quarantine"."users_scalar__dbt_tmp" rename to "users_scalar"
[0m15:50:41.426550 [debug] [Thread-1  ]: On model.pgmigrate.my_first_dbt_model: COMMIT
[0m15:50:41.427068 [debug] [Thread-2  ]: SQL status: ALTER TABLE in 0.0 seconds
[0m15:50:41.428149 [debug] [Thread-2  ]: On model.pgmigrate.users_dbt_model: COMMIT
[0m15:50:41.428440 [debug] [Thread-1  ]: SQL status: COMMIT in 0.0 seconds
[0m15:50:41.428706 [debug] [Thread-2  ]: Using postgres connection "model.pgmigrate.users_dbt_model"
[0m15:50:41.432455 [debug] [Thread-1  ]: Applying DROP to: "postgres"."public"."my_first_dbt_model__dbt_backup"
[0m15:50:41.432730 [debug] [Thread-2  ]: On model.pgmigrate.users_dbt_model: COMMIT
[0m15:50:41.435291 [debug] [Thread-1  ]: Using postgres connection "model.pgmigrate.my_first_dbt_model"
[0m15:50:41.435604 [debug] [Thread-1  ]: On model.pgmigrate.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.8.1", "profile_name": "pgmigrate", "target_name": "dev", "node_id": "model.pgmigrate.my_first_dbt_model"} */
drop table if exists "postgres"."public"."my_first_dbt_model__dbt_backup" cascade
[0m15:50:41.435876 [debug] [Thread-2  ]: SQL status: COMMIT in 0.0 seconds
[0m15:50:41.438489 [debug] [Thread-2  ]: Applying DROP to: "postgres"."public__airbyte_quarantine"."users_scalar__dbt_backup"
[0m15:50:41.440230 [debug] [Thread-2  ]: Using postgres connection "model.pgmigrate.users_dbt_model"
[0m15:50:41.440488 [debug] [Thread-1  ]: SQL status: DROP TABLE in 0.0 seconds
[0m15:50:41.440730 [debug] [Thread-2  ]: On model.pgmigrate.users_dbt_model: /* {"app": "dbt", "dbt_version": "1.8.1", "profile_name": "pgmigrate", "target_name": "dev", "node_id": "model.pgmigrate.users_dbt_model"} */
drop view if exists "postgres"."public__airbyte_quarantine"."users_scalar__dbt_backup" cascade
[0m15:50:41.442190 [debug] [Thread-1  ]: On model.pgmigrate.my_first_dbt_model: Close
[0m15:50:41.443163 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'bf7fb063-73a1-4781-88f7-10a884d6ad6f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x102610c40>]}
[0m15:50:41.443607 [info ] [Thread-1  ]: 1 of 5 OK created sql table model public.my_first_dbt_model .................... [[32mSELECT 2[0m in 0.13s]
[0m15:50:41.444004 [debug] [Thread-1  ]: Finished running node model.pgmigrate.my_first_dbt_model
[0m15:50:41.444405 [debug] [Thread-1  ]: Began running node model.pgmigrate.my_second_dbt_model
[0m15:50:41.444717 [info ] [Thread-1  ]: 3 of 5 START sql view model public.my_second_dbt_model ......................... [RUN]
[0m15:50:41.445002 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.pgmigrate.my_first_dbt_model, now model.pgmigrate.my_second_dbt_model)
[0m15:50:41.445242 [debug] [Thread-1  ]: Began compiling node model.pgmigrate.my_second_dbt_model
[0m15:50:41.447024 [debug] [Thread-1  ]: Writing injected SQL for node "model.pgmigrate.my_second_dbt_model"
[0m15:50:41.447616 [debug] [Thread-1  ]: Began executing node model.pgmigrate.my_second_dbt_model
[0m15:50:41.450717 [debug] [Thread-1  ]: Writing runtime sql for node "model.pgmigrate.my_second_dbt_model"
[0m15:50:41.451154 [debug] [Thread-1  ]: Using postgres connection "model.pgmigrate.my_second_dbt_model"
[0m15:50:41.451405 [debug] [Thread-1  ]: On model.pgmigrate.my_second_dbt_model: BEGIN
[0m15:50:41.451640 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m15:50:41.455030 [debug] [Thread-1  ]: SQL status: BEGIN in 0.0 seconds
[0m15:50:41.455316 [debug] [Thread-1  ]: Using postgres connection "model.pgmigrate.my_second_dbt_model"
[0m15:50:41.455571 [debug] [Thread-1  ]: On model.pgmigrate.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "1.8.1", "profile_name": "pgmigrate", "target_name": "dev", "node_id": "model.pgmigrate.my_second_dbt_model"} */

  create view "postgres"."public"."my_second_dbt_model__dbt_tmp"
    
    
  as (
    -- Use the `ref` function to select from other models

select *
from "postgres"."public"."my_first_dbt_model"
where id = 1
  );
[0m15:50:41.457024 [debug] [Thread-1  ]: SQL status: CREATE VIEW in 0.0 seconds
[0m15:50:41.459155 [debug] [Thread-1  ]: Using postgres connection "model.pgmigrate.my_second_dbt_model"
[0m15:50:41.459403 [debug] [Thread-1  ]: On model.pgmigrate.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "1.8.1", "profile_name": "pgmigrate", "target_name": "dev", "node_id": "model.pgmigrate.my_second_dbt_model"} */
alter table "postgres"."public"."my_second_dbt_model__dbt_tmp" rename to "my_second_dbt_model"
[0m15:50:41.459832 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.0 seconds
[0m15:50:41.460885 [debug] [Thread-1  ]: On model.pgmigrate.my_second_dbt_model: COMMIT
[0m15:50:41.461156 [debug] [Thread-1  ]: Using postgres connection "model.pgmigrate.my_second_dbt_model"
[0m15:50:41.461389 [debug] [Thread-1  ]: On model.pgmigrate.my_second_dbt_model: COMMIT
[0m15:50:41.461793 [debug] [Thread-1  ]: SQL status: COMMIT in 0.0 seconds
[0m15:50:41.463511 [debug] [Thread-1  ]: Applying DROP to: "postgres"."public"."my_second_dbt_model__dbt_backup"
[0m15:50:41.464050 [debug] [Thread-1  ]: Using postgres connection "model.pgmigrate.my_second_dbt_model"
[0m15:50:41.464288 [debug] [Thread-1  ]: On model.pgmigrate.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "1.8.1", "profile_name": "pgmigrate", "target_name": "dev", "node_id": "model.pgmigrate.my_second_dbt_model"} */
drop view if exists "postgres"."public"."my_second_dbt_model__dbt_backup" cascade
[0m15:50:41.464646 [debug] [Thread-1  ]: SQL status: DROP VIEW in 0.0 seconds
[0m15:50:41.465433 [debug] [Thread-1  ]: On model.pgmigrate.my_second_dbt_model: Close
[0m15:50:41.465716 [debug] [Thread-2  ]: SQL status: DROP VIEW in 0.0 seconds
[0m15:50:41.466458 [debug] [Thread-2  ]: On model.pgmigrate.users_dbt_model: Close
[0m15:50:41.466769 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'bf7fb063-73a1-4781-88f7-10a884d6ad6f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10486dfa0>]}
[0m15:50:41.467078 [debug] [Thread-2  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'bf7fb063-73a1-4781-88f7-10a884d6ad6f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1056326a0>]}
[0m15:50:41.467467 [info ] [Thread-1  ]: 3 of 5 OK created sql view model public.my_second_dbt_model .................... [[32mCREATE VIEW[0m in 0.02s]
[0m15:50:41.467889 [info ] [Thread-2  ]: 2 of 5 OK created sql view model public__airbyte_quarantine.users_scalar ....... [[32mCREATE VIEW[0m in 0.16s]
[0m15:50:41.468304 [debug] [Thread-1  ]: Finished running node model.pgmigrate.my_second_dbt_model
[0m15:50:41.468652 [debug] [Thread-2  ]: Finished running node model.pgmigrate.users_dbt_model
[0m15:50:41.469214 [debug] [Thread-1  ]: Began running node test.pgmigrate.not_null_users_dbt_model_legacy_id.fe99fe88c9
[0m15:50:41.469506 [info ] [Thread-1  ]: 4 of 5 START test not_null_users_dbt_model_legacy_id ........................... [RUN]
[0m15:50:41.469786 [debug] [Thread-2  ]: Began running node test.pgmigrate.unique_users_dbt_model_legacy_id.dfd0e08a43
[0m15:50:41.470069 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.pgmigrate.my_second_dbt_model, now test.pgmigrate.not_null_users_dbt_model_legacy_id.fe99fe88c9)
[0m15:50:41.470348 [info ] [Thread-2  ]: 5 of 5 START test unique_users_dbt_model_legacy_id ............................. [RUN]
[0m15:50:41.470635 [debug] [Thread-1  ]: Began compiling node test.pgmigrate.not_null_users_dbt_model_legacy_id.fe99fe88c9
[0m15:50:41.470920 [debug] [Thread-2  ]: Re-using an available connection from the pool (formerly model.pgmigrate.users_dbt_model, now test.pgmigrate.unique_users_dbt_model_legacy_id.dfd0e08a43)
[0m15:50:41.478075 [debug] [Thread-1  ]: Writing injected SQL for node "test.pgmigrate.not_null_users_dbt_model_legacy_id.fe99fe88c9"
[0m15:50:41.478390 [debug] [Thread-2  ]: Began compiling node test.pgmigrate.unique_users_dbt_model_legacy_id.dfd0e08a43
[0m15:50:41.483454 [debug] [Thread-2  ]: Writing injected SQL for node "test.pgmigrate.unique_users_dbt_model_legacy_id.dfd0e08a43"
[0m15:50:41.483859 [debug] [Thread-1  ]: Began executing node test.pgmigrate.not_null_users_dbt_model_legacy_id.fe99fe88c9
[0m15:50:41.490848 [debug] [Thread-2  ]: Began executing node test.pgmigrate.unique_users_dbt_model_legacy_id.dfd0e08a43
[0m15:50:41.493328 [debug] [Thread-1  ]: Writing runtime sql for node "test.pgmigrate.not_null_users_dbt_model_legacy_id.fe99fe88c9"
[0m15:50:41.495073 [debug] [Thread-2  ]: Writing runtime sql for node "test.pgmigrate.unique_users_dbt_model_legacy_id.dfd0e08a43"
[0m15:50:41.495588 [debug] [Thread-1  ]: Using postgres connection "test.pgmigrate.not_null_users_dbt_model_legacy_id.fe99fe88c9"
[0m15:50:41.495880 [debug] [Thread-2  ]: Using postgres connection "test.pgmigrate.unique_users_dbt_model_legacy_id.dfd0e08a43"
[0m15:50:41.496132 [debug] [Thread-1  ]: On test.pgmigrate.not_null_users_dbt_model_legacy_id.fe99fe88c9: BEGIN
[0m15:50:41.496381 [debug] [Thread-2  ]: On test.pgmigrate.unique_users_dbt_model_legacy_id.dfd0e08a43: BEGIN
[0m15:50:41.496625 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m15:50:41.496860 [debug] [Thread-2  ]: Opening a new connection, currently in state closed
[0m15:50:41.500010 [debug] [Thread-1  ]: SQL status: BEGIN in 0.0 seconds
[0m15:50:41.500258 [debug] [Thread-2  ]: SQL status: BEGIN in 0.0 seconds
[0m15:50:41.500520 [debug] [Thread-1  ]: Using postgres connection "test.pgmigrate.not_null_users_dbt_model_legacy_id.fe99fe88c9"
[0m15:50:41.500765 [debug] [Thread-2  ]: Using postgres connection "test.pgmigrate.unique_users_dbt_model_legacy_id.dfd0e08a43"
[0m15:50:41.501026 [debug] [Thread-1  ]: On test.pgmigrate.not_null_users_dbt_model_legacy_id.fe99fe88c9: /* {"app": "dbt", "dbt_version": "1.8.1", "profile_name": "pgmigrate", "target_name": "dev", "node_id": "test.pgmigrate.not_null_users_dbt_model_legacy_id.fe99fe88c9"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select legacy_id
from "postgres"."public__airbyte_quarantine"."users_scalar"
where legacy_id is null



      
    ) dbt_internal_test
[0m15:50:41.501310 [debug] [Thread-2  ]: On test.pgmigrate.unique_users_dbt_model_legacy_id.dfd0e08a43: /* {"app": "dbt", "dbt_version": "1.8.1", "profile_name": "pgmigrate", "target_name": "dev", "node_id": "test.pgmigrate.unique_users_dbt_model_legacy_id.dfd0e08a43"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

select
    legacy_id as unique_field,
    count(*) as n_records

from "postgres"."public__airbyte_quarantine"."users_scalar"
where legacy_id is not null
group by legacy_id
having count(*) > 1



      
    ) dbt_internal_test
[0m15:50:48.277154 [debug] [Thread-1  ]: SQL status: SELECT 1 in 7.0 seconds
[0m15:50:48.286161 [debug] [Thread-1  ]: On test.pgmigrate.not_null_users_dbt_model_legacy_id.fe99fe88c9: ROLLBACK
[0m15:50:48.287356 [debug] [Thread-1  ]: On test.pgmigrate.not_null_users_dbt_model_legacy_id.fe99fe88c9: Close
[0m15:50:48.288657 [info ] [Thread-1  ]: 4 of 5 PASS not_null_users_dbt_model_legacy_id ................................. [[32mPASS[0m in 6.82s]
[0m15:50:48.289602 [debug] [Thread-1  ]: Finished running node test.pgmigrate.not_null_users_dbt_model_legacy_id.fe99fe88c9
[0m15:50:48.752751 [debug] [Thread-2  ]: SQL status: SELECT 1 in 7.0 seconds
[0m15:50:48.756572 [debug] [Thread-2  ]: On test.pgmigrate.unique_users_dbt_model_legacy_id.dfd0e08a43: ROLLBACK
[0m15:50:48.757610 [debug] [Thread-2  ]: On test.pgmigrate.unique_users_dbt_model_legacy_id.dfd0e08a43: Close
[0m15:50:48.758852 [error] [Thread-2  ]: 5 of 5 FAIL 92573 unique_users_dbt_model_legacy_id ............................. [[31mFAIL 92573[0m in 7.29s]
[0m15:50:48.760118 [debug] [Thread-2  ]: Finished running node test.pgmigrate.unique_users_dbt_model_legacy_id.dfd0e08a43
[0m15:50:48.762226 [debug] [MainThread]: Using postgres connection "master"
[0m15:50:48.762868 [debug] [MainThread]: On master: BEGIN
[0m15:50:48.763395 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m15:50:48.768033 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m15:50:48.768336 [debug] [MainThread]: On master: COMMIT
[0m15:50:48.768556 [debug] [MainThread]: Using postgres connection "master"
[0m15:50:48.768760 [debug] [MainThread]: On master: COMMIT
[0m15:50:48.769055 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m15:50:48.769278 [debug] [MainThread]: On master: Close
[0m15:50:48.769583 [debug] [MainThread]: Connection 'master' was properly closed.
[0m15:50:48.769801 [debug] [MainThread]: Connection 'test.pgmigrate.not_null_users_dbt_model_legacy_id.fe99fe88c9' was properly closed.
[0m15:50:48.770001 [debug] [MainThread]: Connection 'test.pgmigrate.unique_users_dbt_model_legacy_id.dfd0e08a43' was properly closed.
[0m15:50:48.770291 [info ] [MainThread]: 
[0m15:50:48.770533 [info ] [MainThread]: Finished running 1 table model, 2 view models, 2 data tests in 0 hours 0 minutes and 7.58 seconds (7.58s).
[0m15:50:48.771351 [debug] [MainThread]: Command end result
[0m15:50:48.793419 [info ] [MainThread]: 
[0m15:50:48.793825 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m15:50:48.794066 [info ] [MainThread]: 
[0m15:50:48.794349 [error] [MainThread]: [31mFailure in test unique_users_dbt_model_legacy_id (models/example/schema.yml)[0m
[0m15:50:48.794599 [error] [MainThread]:   Got 92573 results, configured to fail if != 0
[0m15:50:48.794804 [info ] [MainThread]: 
[0m15:50:48.795044 [info ] [MainThread]:   compiled code at target/compiled/pgmigrate/models/example/schema.yml/unique_users_dbt_model_legacy_id.sql
[0m15:50:48.795259 [info ] [MainThread]: 
[0m15:50:48.795481 [info ] [MainThread]: Done. PASS=4 WARN=0 ERROR=1 SKIP=0 TOTAL=5
[0m15:50:48.796968 [debug] [MainThread]: Resource report: {"command_name": "build", "command_wall_clock_time": 8.215649, "process_user_time": 1.310823, "process_kernel_time": 0.155766, "process_mem_max_rss": "115212288", "command_success": false, "process_in_blocks": "0", "process_out_blocks": "0"}
[0m15:50:48.797369 [debug] [MainThread]: Command `dbt build` failed at 15:50:48.797320 after 8.22 seconds
[0m15:50:48.797669 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1023ea9a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10488db50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1051f9bb0>]}
[0m15:50:48.797940 [debug] [MainThread]: Flushing usage events
[0m15:51:42.531551 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104ac7a00>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106f28e20>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106f286a0>]}


============================== 15:51:42.534406 | 1039bd6e-2b1a-4457-90d6-218cb6648844 ==============================
[0m15:51:42.534406 [info ] [MainThread]: Running with dbt=1.8.1
[0m15:51:42.534823 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/Users/shrikanth/Shrikanth/dbt-helloworld', 'debug': 'False', 'version_check': 'True', 'log_path': '/Users/shrikanth/Shrikanth/dbt-helloworld/logs', 'warn_error': 'None', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'introspect': 'True', 'invocation_command': 'dbt build', 'static_parser': 'True', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m15:51:42.709430 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '1039bd6e-2b1a-4457-90d6-218cb6648844', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1071f9670>]}
[0m15:51:42.746182 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '1039bd6e-2b1a-4457-90d6-218cb6648844', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1073c9580>]}
[0m15:51:42.746968 [info ] [MainThread]: Registered adapter: postgres=1.8.1
[0m15:51:42.762557 [debug] [MainThread]: checksum: ebc509fb14e151ea268e89b60fd5abf912ed99129f87516462718fa2f14f4838, vars: {}, profile: , target: , version: 1.8.1
[0m15:51:42.862387 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m15:51:42.862729 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m15:51:42.887909 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '1039bd6e-2b1a-4457-90d6-218cb6648844', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107bf0eb0>]}
[0m15:51:42.959917 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '1039bd6e-2b1a-4457-90d6-218cb6648844', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107bfb5e0>]}
[0m15:51:42.960323 [info ] [MainThread]: Found 3 models, 2 data tests, 527 macros
[0m15:51:42.961444 [info ] [MainThread]: 
[0m15:51:42.961839 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m15:51:42.964167 [debug] [ThreadPool]: Acquiring new postgres connection 'list_postgres'
[0m15:51:42.964776 [debug] [ThreadPool]: Acquiring new postgres connection 'list_postgres'
[0m15:51:42.999908 [debug] [ThreadPool]: Using postgres connection "list_postgres"
[0m15:51:43.000267 [debug] [ThreadPool]: Using postgres connection "list_postgres"
[0m15:51:43.000494 [debug] [ThreadPool]: On list_postgres: /* {"app": "dbt", "dbt_version": "1.8.1", "profile_name": "pgmigrate", "target_name": "dev", "connection_name": "list_postgres"} */

    select distinct nspname from pg_namespace
  
[0m15:51:43.000723 [debug] [ThreadPool]: On list_postgres: /* {"app": "dbt", "dbt_version": "1.8.1", "profile_name": "pgmigrate", "target_name": "dev", "connection_name": "list_postgres"} */

    select distinct nspname from pg_namespace
  
[0m15:51:43.000941 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m15:51:43.001145 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m15:51:43.026647 [debug] [ThreadPool]: SQL status: SELECT 18 in 0.0 seconds
[0m15:51:43.027326 [debug] [ThreadPool]: SQL status: SELECT 18 in 0.0 seconds
[0m15:51:43.028528 [debug] [ThreadPool]: On list_postgres: Close
[0m15:51:43.030226 [debug] [ThreadPool]: On list_postgres: Close
[0m15:51:43.032604 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_postgres, now list_postgres_public__airbyte_quarantine)
[0m15:51:43.033408 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_postgres, now list_postgres_public)
[0m15:51:43.040239 [debug] [ThreadPool]: Using postgres connection "list_postgres_public__airbyte_quarantine"
[0m15:51:43.041801 [debug] [ThreadPool]: Using postgres connection "list_postgres_public"
[0m15:51:43.042047 [debug] [ThreadPool]: On list_postgres_public__airbyte_quarantine: BEGIN
[0m15:51:43.042269 [debug] [ThreadPool]: On list_postgres_public: BEGIN
[0m15:51:43.042480 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m15:51:43.042684 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m15:51:43.047321 [debug] [ThreadPool]: SQL status: BEGIN in 0.0 seconds
[0m15:51:43.047917 [debug] [ThreadPool]: SQL status: BEGIN in 0.0 seconds
[0m15:51:43.048489 [debug] [ThreadPool]: Using postgres connection "list_postgres_public"
[0m15:51:43.049014 [debug] [ThreadPool]: Using postgres connection "list_postgres_public__airbyte_quarantine"
[0m15:51:43.049530 [debug] [ThreadPool]: On list_postgres_public: /* {"app": "dbt", "dbt_version": "1.8.1", "profile_name": "pgmigrate", "target_name": "dev", "connection_name": "list_postgres_public"} */
select
      'postgres' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'postgres' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
    union all
    select
      'postgres' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public'
  
[0m15:51:43.049811 [debug] [ThreadPool]: On list_postgres_public__airbyte_quarantine: /* {"app": "dbt", "dbt_version": "1.8.1", "profile_name": "pgmigrate", "target_name": "dev", "connection_name": "list_postgres_public__airbyte_quarantine"} */
select
      'postgres' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public__airbyte_quarantine'
    union all
    select
      'postgres' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public__airbyte_quarantine'
    union all
    select
      'postgres' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public__airbyte_quarantine'
  
[0m15:51:43.053452 [debug] [ThreadPool]: SQL status: SELECT 0 in 0.0 seconds
[0m15:51:43.054037 [debug] [ThreadPool]: SQL status: SELECT 5 in 0.0 seconds
[0m15:51:43.055754 [debug] [ThreadPool]: On list_postgres_public__airbyte_quarantine: ROLLBACK
[0m15:51:43.057757 [debug] [ThreadPool]: On list_postgres_public: ROLLBACK
[0m15:51:43.058450 [debug] [ThreadPool]: On list_postgres_public__airbyte_quarantine: Close
[0m15:51:43.058777 [debug] [ThreadPool]: On list_postgres_public: Close
[0m15:51:43.066590 [debug] [MainThread]: Using postgres connection "master"
[0m15:51:43.067216 [debug] [MainThread]: On master: BEGIN
[0m15:51:43.067733 [debug] [MainThread]: Opening a new connection, currently in state init
[0m15:51:43.071861 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m15:51:43.072509 [debug] [MainThread]: Using postgres connection "master"
[0m15:51:43.073253 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.8.1", "profile_name": "pgmigrate", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m15:51:43.086414 [debug] [MainThread]: SQL status: SELECT 1 in 0.0 seconds
[0m15:51:43.088604 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '1039bd6e-2b1a-4457-90d6-218cb6648844', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107cdcb80>]}
[0m15:51:43.089591 [debug] [MainThread]: On master: ROLLBACK
[0m15:51:43.090502 [debug] [MainThread]: Using postgres connection "master"
[0m15:51:43.091048 [debug] [MainThread]: On master: BEGIN
[0m15:51:43.091742 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m15:51:43.092272 [debug] [MainThread]: On master: COMMIT
[0m15:51:43.092760 [debug] [MainThread]: Using postgres connection "master"
[0m15:51:43.093234 [debug] [MainThread]: On master: COMMIT
[0m15:51:43.093781 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m15:51:43.094282 [debug] [MainThread]: On master: Close
[0m15:51:43.095027 [info ] [MainThread]: Concurrency: 2 threads (target='dev')
[0m15:51:43.095607 [info ] [MainThread]: 
[0m15:51:43.098426 [debug] [Thread-1  ]: Began running node model.pgmigrate.my_first_dbt_model
[0m15:51:43.099165 [debug] [Thread-2  ]: Began running node model.pgmigrate.users_dbt_model
[0m15:51:43.100158 [info ] [Thread-1  ]: 1 of 5 START sql table model public.my_first_dbt_model ......................... [RUN]
[0m15:51:43.101224 [info ] [Thread-2  ]: 2 of 5 START sql view model public__airbyte_quarantine.users_scalar ............ [RUN]
[0m15:51:43.101688 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly list_postgres_public__airbyte_quarantine, now model.pgmigrate.my_first_dbt_model)
[0m15:51:43.101984 [debug] [Thread-2  ]: Re-using an available connection from the pool (formerly list_postgres_public, now model.pgmigrate.users_dbt_model)
[0m15:51:43.102264 [debug] [Thread-1  ]: Began compiling node model.pgmigrate.my_first_dbt_model
[0m15:51:43.102518 [debug] [Thread-2  ]: Began compiling node model.pgmigrate.users_dbt_model
[0m15:51:43.108030 [debug] [Thread-1  ]: Writing injected SQL for node "model.pgmigrate.my_first_dbt_model"
[0m15:51:43.113838 [debug] [Thread-2  ]: Writing injected SQL for node "model.pgmigrate.users_dbt_model"
[0m15:51:43.114979 [debug] [Thread-1  ]: Began executing node model.pgmigrate.my_first_dbt_model
[0m15:51:43.143896 [debug] [Thread-1  ]: Writing runtime sql for node "model.pgmigrate.my_first_dbt_model"
[0m15:51:43.144349 [debug] [Thread-2  ]: Began executing node model.pgmigrate.users_dbt_model
[0m15:51:43.162138 [debug] [Thread-2  ]: Writing runtime sql for node "model.pgmigrate.users_dbt_model"
[0m15:51:43.162684 [debug] [Thread-1  ]: Using postgres connection "model.pgmigrate.my_first_dbt_model"
[0m15:51:43.162957 [debug] [Thread-1  ]: On model.pgmigrate.my_first_dbt_model: BEGIN
[0m15:51:43.163404 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m15:51:43.164370 [debug] [Thread-2  ]: Using postgres connection "model.pgmigrate.users_dbt_model"
[0m15:51:43.165067 [debug] [Thread-2  ]: On model.pgmigrate.users_dbt_model: BEGIN
[0m15:51:43.165345 [debug] [Thread-2  ]: Opening a new connection, currently in state closed
[0m15:51:43.168579 [debug] [Thread-1  ]: SQL status: BEGIN in 0.0 seconds
[0m15:51:43.169326 [debug] [Thread-1  ]: Using postgres connection "model.pgmigrate.my_first_dbt_model"
[0m15:51:43.169911 [debug] [Thread-2  ]: SQL status: BEGIN in 0.0 seconds
[0m15:51:43.170553 [debug] [Thread-1  ]: On model.pgmigrate.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.8.1", "profile_name": "pgmigrate", "target_name": "dev", "node_id": "model.pgmigrate.my_first_dbt_model"} */

  
    

  create  table "postgres"."public"."my_first_dbt_model__dbt_tmp"
  
  
    as
  
  (
    /*
    Welcome to your first dbt model!
    Did you know that you can also configure models directly within SQL files?
    This will override configurations stated in dbt_project.yml

    Try changing "table" to "view" below
*/



with source_data as (

    select 1 as id
    union all
    select null as id

)

select *
from source_data

/*
    Uncomment the line below to remove records with null `id` values
*/

-- where id is not null
  );
  
[0m15:51:43.170956 [debug] [Thread-2  ]: Using postgres connection "model.pgmigrate.users_dbt_model"
[0m15:51:43.171310 [debug] [Thread-2  ]: On model.pgmigrate.users_dbt_model: /* {"app": "dbt", "dbt_version": "1.8.1", "profile_name": "pgmigrate", "target_name": "dev", "node_id": "model.pgmigrate.users_dbt_model"} */

  create view "postgres"."public__airbyte_quarantine"."users_scalar__dbt_tmp"
    
    
  as (
    
-- SQL model to parse JSON blob stored in a single column and extract into separated field columns as described by the JSON Schema

select
    _airbyte_data['_id'] as legacy_id,
    _airbyte_data['createdAt']  as start_date,
    _airbyte_data ['updatedAt']  as update_date,
    _airbyte_data ['name']  as name,
    _airbyte_data ['email']  as email,
    _airbyte_data ['status']  as status,
    _airbyte_data ['lastName']  as last_name,
    _airbyte_data ['firstName']  as first_name,
    _airbyte_data ['remoteCreatedAt']  as remote_created_at,
    _airbyte_data ['employmentStatus']  as employment_status,
    _airbyte_data ['organization']  as organization,
    _airbyte_data ['onboardingStep']  as onboarding_step,
    _airbyte_emitted_at
from public._airbyte_raw_users
  );
[0m15:51:43.176990 [debug] [Thread-1  ]: SQL status: SELECT 2 in 0.0 seconds
[0m15:51:43.177708 [debug] [Thread-2  ]: SQL status: CREATE VIEW in 0.0 seconds
[0m15:51:43.187591 [debug] [Thread-1  ]: Using postgres connection "model.pgmigrate.my_first_dbt_model"
[0m15:51:43.189747 [debug] [Thread-2  ]: Using postgres connection "model.pgmigrate.users_dbt_model"
[0m15:51:43.190034 [debug] [Thread-1  ]: On model.pgmigrate.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.8.1", "profile_name": "pgmigrate", "target_name": "dev", "node_id": "model.pgmigrate.my_first_dbt_model"} */
alter table "postgres"."public"."my_first_dbt_model" rename to "my_first_dbt_model__dbt_backup"
[0m15:51:43.190296 [debug] [Thread-2  ]: On model.pgmigrate.users_dbt_model: /* {"app": "dbt", "dbt_version": "1.8.1", "profile_name": "pgmigrate", "target_name": "dev", "node_id": "model.pgmigrate.users_dbt_model"} */
alter table "postgres"."public__airbyte_quarantine"."users_scalar__dbt_tmp" rename to "users_scalar"
[0m15:51:43.191237 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.0 seconds
[0m15:51:43.191917 [debug] [Thread-2  ]: SQL status: ALTER TABLE in 0.0 seconds
[0m15:51:43.194194 [debug] [Thread-1  ]: Using postgres connection "model.pgmigrate.my_first_dbt_model"
[0m15:51:43.204087 [debug] [Thread-2  ]: On model.pgmigrate.users_dbt_model: COMMIT
[0m15:51:43.207113 [debug] [Thread-1  ]: On model.pgmigrate.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.8.1", "profile_name": "pgmigrate", "target_name": "dev", "node_id": "model.pgmigrate.my_first_dbt_model"} */
alter table "postgres"."public"."my_first_dbt_model__dbt_tmp" rename to "my_first_dbt_model"
[0m15:51:43.207439 [debug] [Thread-2  ]: Using postgres connection "model.pgmigrate.users_dbt_model"
[0m15:51:43.207974 [debug] [Thread-2  ]: On model.pgmigrate.users_dbt_model: COMMIT
[0m15:51:43.208392 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.0 seconds
[0m15:51:43.212792 [debug] [Thread-1  ]: On model.pgmigrate.my_first_dbt_model: COMMIT
[0m15:51:43.213232 [debug] [Thread-2  ]: SQL status: COMMIT in 0.0 seconds
[0m15:51:43.213925 [debug] [Thread-1  ]: Using postgres connection "model.pgmigrate.my_first_dbt_model"
[0m15:51:43.219919 [debug] [Thread-2  ]: Applying DROP to: "postgres"."public__airbyte_quarantine"."users_scalar__dbt_backup"
[0m15:51:43.220723 [debug] [Thread-1  ]: On model.pgmigrate.my_first_dbt_model: COMMIT
[0m15:51:43.225075 [debug] [Thread-2  ]: Using postgres connection "model.pgmigrate.users_dbt_model"
[0m15:51:43.225650 [debug] [Thread-2  ]: On model.pgmigrate.users_dbt_model: /* {"app": "dbt", "dbt_version": "1.8.1", "profile_name": "pgmigrate", "target_name": "dev", "node_id": "model.pgmigrate.users_dbt_model"} */
drop view if exists "postgres"."public__airbyte_quarantine"."users_scalar__dbt_backup" cascade
[0m15:51:43.226040 [debug] [Thread-1  ]: SQL status: COMMIT in 0.0 seconds
[0m15:51:43.228108 [debug] [Thread-1  ]: Applying DROP to: "postgres"."public"."my_first_dbt_model__dbt_backup"
[0m15:51:43.228372 [debug] [Thread-2  ]: SQL status: DROP VIEW in 0.0 seconds
[0m15:51:43.230016 [debug] [Thread-1  ]: Using postgres connection "model.pgmigrate.my_first_dbt_model"
[0m15:51:43.231438 [debug] [Thread-2  ]: On model.pgmigrate.users_dbt_model: Close
[0m15:51:43.231714 [debug] [Thread-1  ]: On model.pgmigrate.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.8.1", "profile_name": "pgmigrate", "target_name": "dev", "node_id": "model.pgmigrate.my_first_dbt_model"} */
drop table if exists "postgres"."public"."my_first_dbt_model__dbt_backup" cascade
[0m15:51:43.232587 [debug] [Thread-2  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '1039bd6e-2b1a-4457-90d6-218cb6648844', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107e551c0>]}
[0m15:51:43.233540 [info ] [Thread-2  ]: 2 of 5 OK created sql view model public__airbyte_quarantine.users_scalar ....... [[32mCREATE VIEW[0m in 0.13s]
[0m15:51:43.234263 [debug] [Thread-2  ]: Finished running node model.pgmigrate.users_dbt_model
[0m15:51:43.234625 [debug] [Thread-1  ]: SQL status: DROP TABLE in 0.0 seconds
[0m15:51:43.235398 [debug] [Thread-1  ]: On model.pgmigrate.my_first_dbt_model: Close
[0m15:51:43.236007 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '1039bd6e-2b1a-4457-90d6-218cb6648844', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107cdcb80>]}
[0m15:51:43.236678 [debug] [Thread-2  ]: Began running node test.pgmigrate.not_null_users_dbt_model_legacy_id.fe99fe88c9
[0m15:51:43.237591 [info ] [Thread-1  ]: 1 of 5 OK created sql table model public.my_first_dbt_model .................... [[32mSELECT 2[0m in 0.13s]
[0m15:51:43.237926 [info ] [Thread-2  ]: 3 of 5 START test not_null_users_dbt_model_legacy_id ........................... [RUN]
[0m15:51:43.238663 [debug] [Thread-1  ]: Finished running node model.pgmigrate.my_first_dbt_model
[0m15:51:43.239433 [debug] [Thread-2  ]: Re-using an available connection from the pool (formerly model.pgmigrate.users_dbt_model, now test.pgmigrate.not_null_users_dbt_model_legacy_id.fe99fe88c9)
[0m15:51:43.239931 [debug] [Thread-1  ]: Began running node test.pgmigrate.unique_users_dbt_model_legacy_id.dfd0e08a43
[0m15:51:43.240652 [debug] [Thread-2  ]: Began compiling node test.pgmigrate.not_null_users_dbt_model_legacy_id.fe99fe88c9
[0m15:51:43.241648 [info ] [Thread-1  ]: 4 of 5 START test unique_users_dbt_model_legacy_id ............................. [RUN]
[0m15:51:43.250035 [debug] [Thread-2  ]: Writing injected SQL for node "test.pgmigrate.not_null_users_dbt_model_legacy_id.fe99fe88c9"
[0m15:51:43.250790 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.pgmigrate.my_first_dbt_model, now test.pgmigrate.unique_users_dbt_model_legacy_id.dfd0e08a43)
[0m15:51:43.251630 [debug] [Thread-1  ]: Began compiling node test.pgmigrate.unique_users_dbt_model_legacy_id.dfd0e08a43
[0m15:51:43.257882 [debug] [Thread-1  ]: Writing injected SQL for node "test.pgmigrate.unique_users_dbt_model_legacy_id.dfd0e08a43"
[0m15:51:43.258481 [debug] [Thread-2  ]: Began executing node test.pgmigrate.not_null_users_dbt_model_legacy_id.fe99fe88c9
[0m15:51:43.269008 [debug] [Thread-2  ]: Writing runtime sql for node "test.pgmigrate.not_null_users_dbt_model_legacy_id.fe99fe88c9"
[0m15:51:43.269674 [debug] [Thread-1  ]: Began executing node test.pgmigrate.unique_users_dbt_model_legacy_id.dfd0e08a43
[0m15:51:43.272553 [debug] [Thread-1  ]: Writing runtime sql for node "test.pgmigrate.unique_users_dbt_model_legacy_id.dfd0e08a43"
[0m15:51:43.273078 [debug] [Thread-1  ]: Using postgres connection "test.pgmigrate.unique_users_dbt_model_legacy_id.dfd0e08a43"
[0m15:51:43.273330 [debug] [Thread-1  ]: On test.pgmigrate.unique_users_dbt_model_legacy_id.dfd0e08a43: BEGIN
[0m15:51:43.273568 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m15:51:43.274150 [debug] [Thread-2  ]: Using postgres connection "test.pgmigrate.not_null_users_dbt_model_legacy_id.fe99fe88c9"
[0m15:51:43.274394 [debug] [Thread-2  ]: On test.pgmigrate.not_null_users_dbt_model_legacy_id.fe99fe88c9: BEGIN
[0m15:51:43.274859 [debug] [Thread-2  ]: Opening a new connection, currently in state closed
[0m15:51:43.278311 [debug] [Thread-1  ]: SQL status: BEGIN in 0.0 seconds
[0m15:51:43.279076 [debug] [Thread-1  ]: Using postgres connection "test.pgmigrate.unique_users_dbt_model_legacy_id.dfd0e08a43"
[0m15:51:43.279450 [debug] [Thread-2  ]: SQL status: BEGIN in 0.0 seconds
[0m15:51:43.279849 [debug] [Thread-1  ]: On test.pgmigrate.unique_users_dbt_model_legacy_id.dfd0e08a43: /* {"app": "dbt", "dbt_version": "1.8.1", "profile_name": "pgmigrate", "target_name": "dev", "node_id": "test.pgmigrate.unique_users_dbt_model_legacy_id.dfd0e08a43"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

select
    legacy_id as unique_field,
    count(*) as n_records

from "postgres"."public__airbyte_quarantine"."users_scalar"
where legacy_id is not null
group by legacy_id
having count(*) > 1



      
    ) dbt_internal_test
[0m15:51:43.280911 [debug] [Thread-2  ]: Using postgres connection "test.pgmigrate.not_null_users_dbt_model_legacy_id.fe99fe88c9"
[0m15:51:43.281298 [debug] [Thread-2  ]: On test.pgmigrate.not_null_users_dbt_model_legacy_id.fe99fe88c9: /* {"app": "dbt", "dbt_version": "1.8.1", "profile_name": "pgmigrate", "target_name": "dev", "node_id": "test.pgmigrate.not_null_users_dbt_model_legacy_id.fe99fe88c9"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select legacy_id
from "postgres"."public__airbyte_quarantine"."users_scalar"
where legacy_id is null



      
    ) dbt_internal_test
[0m15:51:43.284216 [debug] [Thread-1  ]: SQL status: SELECT 1 in 0.0 seconds
[0m15:51:43.284882 [debug] [Thread-2  ]: SQL status: SELECT 1 in 0.0 seconds
[0m15:51:43.288670 [debug] [Thread-1  ]: On test.pgmigrate.unique_users_dbt_model_legacy_id.dfd0e08a43: ROLLBACK
[0m15:51:43.290279 [debug] [Thread-2  ]: On test.pgmigrate.not_null_users_dbt_model_legacy_id.fe99fe88c9: ROLLBACK
[0m15:51:43.291743 [debug] [Thread-1  ]: On test.pgmigrate.unique_users_dbt_model_legacy_id.dfd0e08a43: Close
[0m15:51:43.292466 [debug] [Thread-2  ]: On test.pgmigrate.not_null_users_dbt_model_legacy_id.fe99fe88c9: Close
[0m15:51:43.292893 [info ] [Thread-1  ]: 4 of 5 PASS unique_users_dbt_model_legacy_id ................................... [[32mPASS[0m in 0.04s]
[0m15:51:43.293279 [info ] [Thread-2  ]: 3 of 5 PASS not_null_users_dbt_model_legacy_id ................................. [[32mPASS[0m in 0.05s]
[0m15:51:43.293651 [debug] [Thread-1  ]: Finished running node test.pgmigrate.unique_users_dbt_model_legacy_id.dfd0e08a43
[0m15:51:43.293986 [debug] [Thread-2  ]: Finished running node test.pgmigrate.not_null_users_dbt_model_legacy_id.fe99fe88c9
[0m15:51:43.294273 [debug] [Thread-1  ]: Began running node model.pgmigrate.my_second_dbt_model
[0m15:51:43.294686 [info ] [Thread-1  ]: 5 of 5 START sql view model public.my_second_dbt_model ......................... [RUN]
[0m15:51:43.294975 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly test.pgmigrate.unique_users_dbt_model_legacy_id.dfd0e08a43, now model.pgmigrate.my_second_dbt_model)
[0m15:51:43.295218 [debug] [Thread-1  ]: Began compiling node model.pgmigrate.my_second_dbt_model
[0m15:51:43.297211 [debug] [Thread-1  ]: Writing injected SQL for node "model.pgmigrate.my_second_dbt_model"
[0m15:51:43.297648 [debug] [Thread-1  ]: Began executing node model.pgmigrate.my_second_dbt_model
[0m15:51:43.300418 [debug] [Thread-1  ]: Writing runtime sql for node "model.pgmigrate.my_second_dbt_model"
[0m15:51:43.300880 [debug] [Thread-1  ]: Using postgres connection "model.pgmigrate.my_second_dbt_model"
[0m15:51:43.301132 [debug] [Thread-1  ]: On model.pgmigrate.my_second_dbt_model: BEGIN
[0m15:51:43.301363 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m15:51:43.305256 [debug] [Thread-1  ]: SQL status: BEGIN in 0.0 seconds
[0m15:51:43.307238 [debug] [Thread-1  ]: Using postgres connection "model.pgmigrate.my_second_dbt_model"
[0m15:51:43.307547 [debug] [Thread-1  ]: On model.pgmigrate.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "1.8.1", "profile_name": "pgmigrate", "target_name": "dev", "node_id": "model.pgmigrate.my_second_dbt_model"} */

  create view "postgres"."public"."my_second_dbt_model__dbt_tmp"
    
    
  as (
    -- Use the `ref` function to select from other models

select *
from "postgres"."public"."my_first_dbt_model"
where id = 1
  );
[0m15:51:43.309776 [debug] [Thread-1  ]: SQL status: CREATE VIEW in 0.0 seconds
[0m15:51:43.311944 [debug] [Thread-1  ]: Using postgres connection "model.pgmigrate.my_second_dbt_model"
[0m15:51:43.312207 [debug] [Thread-1  ]: On model.pgmigrate.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "1.8.1", "profile_name": "pgmigrate", "target_name": "dev", "node_id": "model.pgmigrate.my_second_dbt_model"} */
alter table "postgres"."public"."my_second_dbt_model__dbt_tmp" rename to "my_second_dbt_model"
[0m15:51:43.313158 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.0 seconds
[0m15:51:43.314132 [debug] [Thread-1  ]: On model.pgmigrate.my_second_dbt_model: COMMIT
[0m15:51:43.314384 [debug] [Thread-1  ]: Using postgres connection "model.pgmigrate.my_second_dbt_model"
[0m15:51:43.314616 [debug] [Thread-1  ]: On model.pgmigrate.my_second_dbt_model: COMMIT
[0m15:51:43.315477 [debug] [Thread-1  ]: SQL status: COMMIT in 0.0 seconds
[0m15:51:43.317167 [debug] [Thread-1  ]: Applying DROP to: "postgres"."public"."my_second_dbt_model__dbt_backup"
[0m15:51:43.317730 [debug] [Thread-1  ]: Using postgres connection "model.pgmigrate.my_second_dbt_model"
[0m15:51:43.317976 [debug] [Thread-1  ]: On model.pgmigrate.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "1.8.1", "profile_name": "pgmigrate", "target_name": "dev", "node_id": "model.pgmigrate.my_second_dbt_model"} */
drop view if exists "postgres"."public"."my_second_dbt_model__dbt_backup" cascade
[0m15:51:43.318522 [debug] [Thread-1  ]: SQL status: DROP VIEW in 0.0 seconds
[0m15:51:43.320611 [debug] [Thread-1  ]: On model.pgmigrate.my_second_dbt_model: Close
[0m15:51:43.321606 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '1039bd6e-2b1a-4457-90d6-218cb6648844', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10831be80>]}
[0m15:51:43.322764 [info ] [Thread-1  ]: 5 of 5 OK created sql view model public.my_second_dbt_model .................... [[32mCREATE VIEW[0m in 0.03s]
[0m15:51:43.323205 [debug] [Thread-1  ]: Finished running node model.pgmigrate.my_second_dbt_model
[0m15:51:43.324669 [debug] [MainThread]: Using postgres connection "master"
[0m15:51:43.324913 [debug] [MainThread]: On master: BEGIN
[0m15:51:43.325122 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m15:51:43.329319 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m15:51:43.329742 [debug] [MainThread]: On master: COMMIT
[0m15:51:43.329959 [debug] [MainThread]: Using postgres connection "master"
[0m15:51:43.330163 [debug] [MainThread]: On master: COMMIT
[0m15:51:43.330750 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m15:51:43.331143 [debug] [MainThread]: On master: Close
[0m15:51:43.331587 [debug] [MainThread]: Connection 'master' was properly closed.
[0m15:51:43.332214 [debug] [MainThread]: Connection 'model.pgmigrate.my_second_dbt_model' was properly closed.
[0m15:51:43.332757 [debug] [MainThread]: Connection 'test.pgmigrate.not_null_users_dbt_model_legacy_id.fe99fe88c9' was properly closed.
[0m15:51:43.333438 [info ] [MainThread]: 
[0m15:51:43.334091 [info ] [MainThread]: Finished running 2 view models, 1 table model, 2 data tests in 0 hours 0 minutes and 0.37 seconds (0.37s).
[0m15:51:43.335605 [debug] [MainThread]: Command end result
[0m15:51:43.404832 [info ] [MainThread]: 
[0m15:51:43.405350 [info ] [MainThread]: [32mCompleted successfully[0m
[0m15:51:43.405647 [info ] [MainThread]: 
[0m15:51:43.405945 [info ] [MainThread]: Done. PASS=5 WARN=0 ERROR=0 SKIP=0 TOTAL=5
[0m15:51:43.408064 [debug] [MainThread]: Resource report: {"command_name": "build", "command_success": true, "command_wall_clock_time": 0.9210176, "process_user_time": 1.322115, "process_kernel_time": 0.186751, "process_mem_max_rss": "118538240", "process_in_blocks": "0", "process_out_blocks": "0"}
[0m15:51:43.408487 [debug] [MainThread]: Command `dbt build` succeeded at 15:51:43.408431 after 0.92 seconds
[0m15:51:43.408778 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104ac7a00>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107c089a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107c08970>]}
[0m15:51:43.409066 [debug] [MainThread]: Flushing usage events
